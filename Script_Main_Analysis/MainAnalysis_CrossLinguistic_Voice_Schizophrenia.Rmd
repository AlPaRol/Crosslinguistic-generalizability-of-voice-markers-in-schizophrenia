---
title: "Voice_Patterns_in_schizophrenia_CrossLinguistic_Replication"
author: "Parola Alberto and Riccardo Fusaroli"
date: "03/03/2022"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}

require("knitr")

knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE)

rm(list=ls())

set.seed(2020)
placeholder=0

```

## Load data

```{r, include= FALSE}




# load packages


pacman::p_load(tidyverse,
               readxl,
               brms,
               metafor,
               miceadds,
               knitr,
               broom, 
               ggridges, 
               posterior, 
               ggpubr,
               formattable,
               here,
               patchwork,
               bayesplot,
               ggplot2)



## Dataset for diagnosis analysis

d_trial <- ReadPreProcess("TrialSummary_FINAL_VUV_0.csv")
d_segment <- ReadPreProcess("SegmentSummary_FINAL_VUV_0.csv")
d_segment  <-subset(d_segment, Duration_Cova >= 6.0)



## Dataset for symptom and medication analysis

d_trial_SZ <- subset(d_trial, Diagnosis == "SCZ")
d_trial_DUI <- d_trial_SZ %>% subset(Ill_Dur != 1000)
d_trial_FES <- d_trial %>% subset(FES != "NR")



```

## Meta-analysis

```{r, include= FALSE, eval = TRUE}


# Load meta-analysis data
d_meta <- as.data.frame(
  read_excel(here("data", "meta", "Matrix_MetaAnalysis_Diagnosis.xlsx"))) %>% 
    subset(DIAGNOSIS == "SZ")

#  Run 
  
Name <- c(
    "Pitch_mean",
    "Pitch_variability",
    #"Mean_intensity",
    #"Intensity_variability",
    "Proportion_of_spoken_time",
    "Speech_duration",
    "Speech_rate",
    "Pause_duration",
    "Number_of_pauses"
  )

FeatureSz <- c(
    "PITCH_F0_SZ_M",
    "PITCH_F0SD_SZ_M",
    #"INT_MEAN_SZ_M",
    #"INT_VAR_SZ_M",
    "SP_PER_SZ_M",
    "SP_DUR_SZ_M",
    "SP_RAT_SZ_M",
    "PA_DUR_SZ_M",
    "PA_NUM_SZ_M"
  )

FeatureCtrl <- c(
    "PITCH_F0_HC_M",
    "PITCH_F0SD_HC_M",
   # "INT_MEAN_HC_M",
    #"INT_VAR_HC_M",
    "SP_PER_HC_M",
    "SP_DUR_HC_M",
    "SP_RAT_HC_M",
    "PA_DUR_HC_M",
    "PA_NUM_HC_M"
  )

FeatureSDSz <- c(
    "PITCH_F0_SZ_SD",
    "PITCH_F0SD_SZ_SD",
    #"INT_MEAN_SZ_SD",
    #"INT_VAR_SZ_SD",
    "SP_PER_SZ_SD",
    "SP_DUR_SZ_SD",
    "SP_RAT_SZ_SD",
    "PA_DUR_SZ_SD",
    "PA_NUM_SZ_SD"
  )

FeatureSDCtrl <- c(
    "PITCH_F0_HC_SD",
    "PITCH_F0SD_HC_SD",
    #"INT_MEAN_HC_SD",
    #"INT_VAR_HC_SD",
    "SP_PER_HC_SD",
    "SP_DUR_HC_SD",
    "SP_RAT_HC_SD",
    "PA_DUR__HC_SD",
    "PA_NUM_HC_SD"
  )



dfm <-
  data.frame(Name, FeatureSz, FeatureCtrl, FeatureSDSz, FeatureSDCtrl) %>% mutate(
    Name = as.character(Name),
    FeatureSz = as.character(FeatureSz),
    FeatureCtrl = as.character(FeatureCtrl),
    FeatureSDSz = as.character(FeatureSDSz),
    FeatureSDCtrl = as.character(FeatureSDCtrl)
  )




for (i in seq(nrow(dfm))){
  t<-dfm[i,]
  print(t$Name)
  meta=MetaAnalysisES(d=d_meta,
                      Name=t$Name,
                      FeatureSz=t$FeatureSz,
                      FeatureCtrl=t$FeatureCtrl,
                      FeatureSDSz=t$FeatureSDSz,
                      FeatureSDCtrl=t$FeatureSDCtrl)
}


# The models are saved in the environment now and will be called on a case by case to define the relevant informed priors

```

## Model definitions

```{r, echo= FALSE}



# Defining models
Model_Language_f <- bf(Outcome ~ 0 + Language + Language:Diagnosis + 
                         (1 | gr(NewID, by=group)))


Model_Gender_f <- bf(Outcome ~ 0 + Language:Gender + Language:Gender:Diagnosis + (1 | gr(NewID, by=group2)))


# Model_Gender_f2 <- bf(Outcome ~ 0 + Language:Diagnosis + Language:Diagnosis:Gender + (1 | gr(NewID, by=group2)))


Model_Age_f <- bf(Outcome ~ 0 + Language + Language:Diagnosis + Language:Age + Language:Diagnosis:Age + (1 | gr(NewID, by=group2))) 


Model_IQ_f <- bf(Outcome ~ 0 + Language + Language:Diagnosis + Language:VerbIQ + Language:Diagnosis:VerbIQ + (1 | gr(NewID, by=group2))) 


SkepticPrior <- c(
  prior(normal(0, .5), class=b),
  prior(normal(0, .7), class=sd),
  prior(normal(0.3, 0.1), class = sigma)
)


SkepticPriorStudent <- c(
  prior(normal(0, .5), class=b),
  prior(normal(0, .7), class=sd),
  prior(gamma(4, 1), class = nu),
  prior(normal(0.3, 0.1), class = sigma)
)




# Informed priors are defined within the model fitting function

```



## Pitch_Median

```{r, eval = TRUE, echo= FALSE}


#Pitch_mean_Prior = "0.253 (-0.724 1.304)"

PitchMedianDf <- ModelsByDiagnosis(Name = "PitchMedian",
                              data = d_trial, 
                              Variable = d_trial$Pitch_Median,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Pitch_mean_BayesianPrior, 
                              Informed = TRUE, 
                              level="Trial")





Pitch_MedianDf_Segment <- ModelsByDiagnosis(Name = "Pitch_Median2",
                             data = d_segment2,
                             Variable = d_segment2$Pitch_Median,
                             SkepticPrior = SkepticPrior,
                             MA_model = Pitch_mean_BayesianPrior,
                             Informed = TRUE,
                             level="Segment")




```



#Pitch IQR

```{r,eval = TRUE, echo= FALSE}




Pitch_Cova_IQR_Trial <- ModelsByDiagnosis(Name = "Pitch_IQR_Cova",
                              data = d_trial, 
                              Variable = d_trial$Pitch_IQR,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Pitch_variability_BayesianPrior, 
                              Informed = TRUE, 
                              level="Trial")






Pitch_Cova_IQR_Segment <- ModelsByDiagnosis(Name = "Pitch_IQR_Cova2",
                             data = d_segment2,
                             Variable = d_segment2$Pitch_IQR,
                             SkepticPrior = SkepticPrior,
                             MA_model = Pitch_variability_BayesianPrior,
                             Informed = TRUE,
                             level="Segment")


```

## Speech Rate

```{r,eval = TRUE, echo= FALSE}





SpeechRateDf <- ModelsByDiagnosis(Name = "SpeechRate",
                              data = d_trial, 
                              Variable = d_trial$Speech_Rate_Praat,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Speech_rate_BayesianPrior, 
                              Informed = TRUE, 
                              level="Trial")




SpeechRateDf_Segment <- ModelsByDiagnosis(Name = "SpeechRate2",
                             data = d_segment2,
                             Variable = d_segment2$Speech_Rate_Praat,
                             SkepticPrior = SkepticPrior,
                             MA_model = Speech_rate_BayesianPrior,
                             Informed = TRUE,
                             level="Segment")




```

## Speech Percentage

```{r,eval = TRUE, echo= FALSE}




SpeechPercentagePraatDf <- ModelsByDiagnosis(Name = "SpeechPercentage",
                              data = d_trial, 
                              Variable = d_trial$PercentSpoke_Praat,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Proportion_of_spoken_time_BayesianPrior,
                              Informed = TRUE, 
                              level="Trial")



SpeechPercentageDf_Segment <- ModelsByDiagnosis(Name = "SpeechPercentage",
                             data = d_segment,
                             Variable = d_segment$PercentSpoke_Praat,
                             SkepticPrior = SkepticPrior,
                             MA_model = Proportion_of_spoken_time_BayesianPrior,
                             Informed = TRUE,
                             level="Segment")






```

# Pause Duration

```{r,eval = TRUE, echo= FALSE}






PauseDurationPraatDf <- ModelsByDiagnosis(Name = "MeanPauseuDurationPraat",
                              data = d_trial, 
                              Variable = d_trial$MeanPauseDur_Praat,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Pause_duration_BayesianPrior, 
                              Informed = TRUE, 
                              level="Trial")






PauseDurationDf_Segment2 <- ModelsByDiagnosis(Name = "MeanPauseuDurationPraa2",
                             data = d_segment,
                             Variable = d_segment$MeanPauseDur_Praat,
                             SkepticPrior = SkepticPrior,
                             MA_model = Pause_duration_BayesianPrior,
                             Informed = TRUE,
                             level="Segment")

ht

```

# Number of pauses

```{r,eval = TRUE, echo= FALSE}







PauseNumberPraatDf <- ModelsByDiagnosis(Name = "PauseNumberMinPraat",
                              data = d_trial, 
                              Variable = d_trial$PauseNumMin_Praat,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Number_of_pauses_BayesianPrior, 
                              Informed = TRUE, 
                              level="Trial")







PauseNumberDf_Segment2 <- ModelsByDiagnosis(Name = "PauseNumberMinPraat",
                             data = d_segment,
                             Variable = d_segment$PauseNumMin_Praat,
                             SkepticPrior = SkepticPrior,
                             MA_model = Number_of_pauses_BayesianPrior,
                             Informed = TRUE,
                             level="Segment")



```


# Utterance Duration

```{r,eval = TRUE, echo= FALSE}






TurnDurationPraatDf <- ModelsByDiagnosis(Name = "MeanTurnDurationPraat",
                              data = d_trial, 
                              Variable = d_trial$MeanTurnDur_Praat,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Speech_duration_BayesianPrior, 
                              Informed = TRUE, 
                              level="Trial")






TurnDurationPraatSegment2Df <- ModelsByDiagnosis(Name = "MeanTurnDurationPraat",
                              data = d_segmen2,
                              Variable = d_segment$MeanTurnDur_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Speech_duration_BayesianPrior,
                              Informed = TRUE,
                              level="Segment")





```

# Number of Turn


```{r}





TurnNumMin_PraatDf <- ModelsByDiagnosis(Name = "TurnNumMin_PraatPraat",
                              data = d_trial,
                              Variable = d_trial$TurnNumMin_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Number_of_pauses_BayesianPrior,
                              Informed = FALSE,
                              level="Trial")





TurnNumMin_PraatDf_Segment2 <- ModelsByDiagnosis(Name = "TurnNumMin_Praat",
                             data = d_segment,
                             Variable = d_segment$TurnNumMin_Praat,
                             SkepticPrior = SkepticPrior,
                             MA_model = Number_of_pauses_BayesianPrior,
                             Informed = FALSE,
                             level="Segment")


```



## Total duration

```{r, eval = TRUE, echo= FALSE}





TotalDurationPraatDf <- ModelsByDiagnosis(Name = "TotalDurationPraat",
                              data = d_trial, 
                              Variable = d_trial$Duration_Praat,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Pause_duration_BayesianPrior, 
                              Informed = FALSE, 
                              level="Trial")





TotalDurationPraatSegment2Df <- ModelsByDiagnosis(Name = "TotalDurationPraat",
                              data = d_segment2,
                              Variable = d_segment$Duration_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pause_duration_BayesianPrior,
                              Informed = FALSE,
                              level="Segment")

ht


```



# F1_Median and IQR

```{r, eval = TRUE, echo= FALSE}

F1_MeanDf <- ModelsByDiagnosis(Name = "F1_Median",
                              data = d_trial, 
                              Variable = d_trial$F1_Median,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Intensity_variability_Prior, 
                              Informed = FALSE, 
                              level="Trial")



ht



F1_IQRDf <- ModelsByDiagnosis(Name = "F1_IQR",
                             data = d_trial, 
                             Variable = d_trial$F1_IQR,
                             SkepticPrior = SkepticPrior, 
                             MA_model = Intensity_variability_Prior, 
                             Informed = FALSE, 
                             level="Trial")

ht


F1_MedianDf_Segment <- ModelsByDiagnosis(Name = "F1_Median",
                             data = d_segment,
                             Variable = d_segment$F1_Median,
                             SkepticPrior = SkepticPrior,
                             MA_model = Intensity_variability_Prior,
                             Informed = FALSE,
                             level="Segment")





F1_IQRDf_Segment <- ModelsByDiagnosis(Name = "F1_IQR",
                              data = d_segment,
                              Variable = d_segment$F1_IQR,
                              SkepticPrior = SkepticPrior,
                              MA_model = Intensity_variability_Prior,
                              Informed = FALSE,
                              level="Segment")








```

# F2_Median and IQR

```{r,eval  = TRUE, echo= FALSE}




F2_MedianDf <- ModelsByDiagnosis(Name = "F2_Median",
                               data = d_trial, 
                               Variable = d_trial$F2_Median,
                               SkepticPrior = SkepticPrior, 
                               MA_model = Intensity_variability_Prior, 
                               Informed = FALSE, 
                               level="Trial")

ht

F2_IQRDf <- ModelsByDiagnosis(Name = "F2_IQR",
                             data = d_trial, 
                             Variable = d_trial$F2_IQR,
                             SkepticPrior = SkepticPrior, 
                             MA_model = Intensity_variability_Prior, 
                             Informed = FALSE, 
                             level="Trial")



 ht


F2_MedianDf_Segment2 <- ModelsByDiagnosis(Name = "F2_Median2",
                               data = d_segment2,
                               Variable = d_segment2$F2_Median,
                               SkepticPrior = SkepticPrior,
                               MA_model = Intensity_variability_Prior,
                               Informed = FALSE,
                               level="Segment")

ht

F2_IQRDf_Segment2 <- ModelsByDiagnosis(Name = "F2_IQR2",
                             data = d_segment2,
                             Variable = d_segment2$F2_IQR,
                             SkepticPrior = SkepticPrior,
                             MA_model = Intensity_variability_Prior,
                             Informed = FALSE,
                             level="Segment")



 ht


```


# F3_Median and IQR

```{r, eval = TRUE, echo= FALSE}

F3_MeanDf <- ModelsByDiagnosis(Name = "F3_Median",
                              data = d_trial, 
                              Variable = d_trial$F3_Median,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Intensity_variability_Prior, 
                              Informed = FALSE, 
                              level="Trial")



ht



F3_IQRDf <- ModelsByDiagnosis(Name = "F3_IQR",
                             data = d_trial, 
                             Variable = d_trial$F3_IQR,
                             SkepticPrior = SkepticPrior, 
                             MA_model = Intensity_variability_Prior, 
                             Informed = FALSE, 
                             level="Trial")

ht


F3_MedianDf_Segment <- ModelsByDiagnosis(Name = "F3_Median2",
                             data = d_segment2,
                             Variable = d_segment2$F3_Median,
                             SkepticPrior = SkepticPrior,
                             MA_model = Intensity_variability_Prior,
                             Informed = FALSE,
                             level="Segment")


ht


F3_IQRDf_Segment <- ModelsByDiagnosis(Name = "F3_IQR2",
                              data = d_segment2,
                              Variable = d_segment2$F3_IQR,
                              SkepticPrior = SkepticPrior,
                              MA_model = Intensity_variability_Prior,
                              Informed = FALSE,
                              level="Segment")



ht




```



# F4_Median and IQR

```{r, eval = FALSE, echo= FALSE}

F4_MeanDf <- ModelsByDiagnosis(Name = "F4_Median",
                              data = d_trial, 
                              Variable = d_trial$F4_Median,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Intensity_variability_Prior, 
                              Informed = FALSE, 
                              level="Trial")



ht



F4_IQRDf <- ModelsByDiagnosis(Name = "F4_IQR",
                             data = d_trial, 
                             Variable = d_trial$F4_IQR,
                             SkepticPrior = SkepticPrior, 
                             MA_model = Intensity_variability_Prior, 
                             Informed = FALSE, 
                             level="Trial")

ht


F1_MedianDf_Segment2 <- ModelsByDiagnosis(Name = "F4_Median2",
                             data = d_segment2,
                             Variable = d_segment2$F4_Median,
                             SkepticPrior = SkepticPrior,
                             MA_model = Intensity_variability_Prior,
                             Informed = FALSE,
                             level="Segment")


ht


F1_IQRDf_Segment2 <- ModelsByDiagnosis(Name = "F4_IQR2",
                              data = d_segment2,
                              Variable = d_segment2$F4_IQR,
                              SkepticPrior = SkepticPrior,
                              MA_model = Intensity_variability_Prior,
                              Informed = FALSE,
                              level="Segment")



ht




```



# F5_Median and IQR

```{r, eval = FALSE, echo= FALSE}

F5_MeanDf <- ModelsByDiagnosis(Name = "F5_Median",
                              data = d_trial, 
                              Variable = d_trial$F5_Median,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Intensity_variability_Prior, 
                              Informed = FALSE, 
                              level="Trial")



ht



F5_IQRDf <- ModelsByDiagnosis(Name = "F5_IQR",
                             data = d_trial, 
                             Variable = d_trial$F5_IQR,
                             SkepticPrior = SkepticPrior, 
                             MA_model = Intensity_variability_Prior, 
                             Informed = FALSE, 
                             level="Trial")

ht


F5_MedianDf_Segment <- ModelsByDiagnosis(Name = "F5_Median2",
                             data = d_segment2,
                             Variable = d_segment2$F5_Median,
                             SkepticPrior = SkepticPrior,
                             MA_model = Intensity_variability_Prior,
                             Informed = FALSE,
                             level="Segment")


ht


F5_IQRDf_Segment <- ModelsByDiagnosis(Name = "F5_IQR2",
                              data = d_segment2,
                              Variable = d_segment2$F5_IQR,
                              SkepticPrior = SkepticPrior,
                              MA_model = Intensity_variability_Prior,
                              Informed = FALSE,
                              level="Segment")



ht




```

# H1H2_Median and IQR

```{r,eval = FALSE, echo= FALSE}


H1H2_MedianDf <- ModelsByDiagnosis(Name = "H1H2_Median",
                                 data = d_trial, 
                                 Variable = d_trial$H1H2_Median,
                                 SkepticPrior = SkepticPrior, 
                                 MA_model = Intensity_variability_Prior, 
                                 Informed = FALSE, 
                                 level="Trial")

ht

H1H2_IQRDf <- ModelsByDiagnosis(Name = "H1H2_IQR",
                                   data = d_trial, 
                                   Variable = d_trial$H1H2_IQR,
                                   SkepticPrior = SkepticPrior, 
                                   MA_model = Intensity_variability_Prior, 
                                   Informed = FALSE, 
                                   level="Trial")


ht



H1H2_MedianDf_Segment <- ModelsByDiagnosis(Name = "H1H2_Median2",
                                 data = d_segment2,
                                 Variable = d_segment2$H1H2_Median,
                                 SkepticPrior = SkepticPrior,
                                 MA_model = Intensity_variability_Prior,
                                 Informed = FALSE,
                                 level="Segment")

ht

H1H2_IQRDf_Segment <- ModelsByDiagnosis(Name = "H1H2_IQR2",
                                   data = d_segment2,
                                   Variable = d_segment2$H1H2_IQR,
                                   SkepticPrior = SkepticPrior,
                                   MA_model = Intensity_variability_Prior,
                                   Informed = FALSE,
                                   level="Segment")


ht

```


# QOQ_Median and IQR

```{r,eval = FALSE, echo= FALSE}



QOQ_MedianDf <- ModelsByDiagnosis(Name = "QOQ_Median",
                                data = d_trial, 
                                Variable = d_trial$QOQ_Median,
                                SkepticPrior = SkepticPrior, 
                                MA_model = Intensity_variability_Prior, 
                                Informed = FALSE, 
                                level="Trial")

ht



QOQ_IQRDf <- ModelsByDiagnosis(Name = "QOQ_IQR",
                                  data = d_trial, 
                                  Variable = d_trial$QOQ_IQR,
                                  SkepticPrior = SkepticPrior, 
                                  MA_model = Intensity_variability_Prior, 
                                  Informed = FALSE, 
                                  level="Trial")


ht


QOQ_MedianDf_Segment2 <- ModelsByDiagnosis(Name = "QOQ_Median2",
                                data = d_segment2,
                                Variable = d_segment2$QOQ_Median,
                                SkepticPrior = SkepticPrior,
                                MA_model = Intensity_variability_Prior,
                                Informed = FALSE,
                                level="Segment")

ht



QOQ_IQRDf_Segment2 <- ModelsByDiagnosis(Name = "QOQ_IQR2",
                                  data = d_segment2,
                                  Variable = d_segment2$QOQ_IQR,
                                  SkepticPrior = SkepticPrior,
                                  MA_model = Intensity_variability_Prior,
                                  Informed = FALSE,
                                  level="Segment")


ht



```

# NAQ Median and IQR

```{r, eval = FALSE, echo= FALSE}


NAQ_MedianDf <- ModelsByDiagnosis(Name = "NAQ_Median",
                                data = d_trial, 
                                Variable = d_trial$NAQ_Median,
                                SkepticPrior = SkepticPrior, 
                                MA_model = Intensity_variability_Prior, 
                                Informed = FALSE, 
                                level="Trial")

ht



NAQ_IQRDf <- ModelsByDiagnosis(Name = "NAQ_IQR",
                                  data = d_trial, 
                                  Variable = d_trial$NAQ_IQR,
                                  SkepticPrior = SkepticPrior, 
                                  MA_model = Intensity_variability_Prior, 
                                  Informed = FALSE, 
                                  level="Trial")


ht


NAQ_MedianDf_Segment2 <- ModelsByDiagnosis(Name = "NAQ_Median2",
                                data = d_segment2,
                                Variable = d_segment2$NAQ_Median,
                                SkepticPrior = SkepticPrior,
                                MA_model = Intensity_variability_Prior,
                                Informed = FALSE,
                                level="Segment")

ht



NAQ_IQRDf_Segment2 <- ModelsByDiagnosis(Name = "NAQ_IQR2",
                                  data = d_segment2,
                                  Variable = d_segment2$NAQ_IQR,
                                  SkepticPrior = SkepticPrior,
                                  MA_model = Intensity_variability_Prior,
                                  Informed = FALSE,
                                  level="Segment")


ht




```

# HNR Median and IQR



```{r, eval = FALSE}

HNR_MedianDf <- ModelsByDiagnosis(Name = "HNR_Median",
                                data = d_trial, 
                                Variable = d_trial$HNR_mean,
                                SkepticPrior = SkepticPrior, 
                                MA_model = Intensity_variability_Prior, 
                                Informed = FALSE, 
                                level="Trial")

ht



HNR_IQRDf <- ModelsByDiagnosis(Name = "HNR_IQR",
                                  data = d_trial, 
                                  Variable = d_trial$HNR_std,
                                  SkepticPrior = SkepticPrior, 
                                  MA_model = Intensity_variability_Prior, 
                                  Informed = FALSE, 
                                  level="Trial")


ht


HNR_MedianDf_Segment2 <- ModelsByDiagnosis(Name = "HNR_Median2",
                                data = d_segment2,
                                Variable = d_segment2$HNR_mean,
                                SkepticPrior = SkepticPrior,
                                MA_model = Intensity_variability_Prior,
                                Informed = FALSE,
                                level="Segment")

ht



HNR_IQRDf_Segment2 <- ModelsByDiagnosis(Name = "HNR_IQR2",
                                  data = d_segment2,
                                  Variable = d_segment2$HNR_std,
                                  SkepticPrior = SkepticPrior,
                                  MA_model = Intensity_variability_Prior,
                                  Informed = FALSE,
                                  level="Segment")


ht



```








# PSP Median anf IQR

```{r, eval = FALSE, echo= FALSE}

PSP_MedianDf <- ModelsByDiagnosis(Name = "PSP_Median",
                                data = d_trial, 
                                Variable = d_trial$PSP_Median,
                                SkepticPrior = SkepticPrior, 
                                MA_model = Intensity_variability_Prior, 
                                Informed = FALSE, 
                                level="Trial")

ht



PSP_IQRDf <- ModelsByDiagnosis(Name = "PSP_IQR",
                                  data = d_trial, 
                                  Variable = d_trial$PSP_IQR,
                                  SkepticPrior = SkepticPrior, 
                                  MA_model = Intensity_variability_Prior, 
                                  Informed = FALSE, 
                                  level="Trial")


ht


PSP_MedianDf_Segment2 <- ModelsByDiagnosis(Name = "PSP_Median2",
                                data = d_segment2,
                                Variable = d_segment2$PSP_Median,
                                SkepticPrior = SkepticPrior,
                                MA_model = Intensity_variability_Prior,
                                Informed = FALSE,
                                level="Segment")

ht



PSP_IQRDf_Segment2 <- ModelsByDiagnosis(Name = "PSP_IQR2",
                                  data = d_segment2,
                                  Variable = d_segment2$PSP_IQR,
                                  SkepticPrior = SkepticPrior,
                                  MA_model = Intensity_variability_Prior,
                                  Informed = FALSE,
                                  level="Segment")


ht



```


# MDQ Median and IQR

```{r, eval = FALSE, echo= FALSE}



MDQ_MedianDf <- ModelsByDiagnosis(Name = "MDQ_Median",
                                data = d_trial, 
                                Variable = d_trial$MDQ_Median,
                                SkepticPrior = SkepticPrior, 
                                MA_model = Intensity_variability_Prior, 
                                Informed = FALSE, 
                                level="Trial")

ht




MDQ_IQRDf <- ModelsByDiagnosis(Name = "MDQ_IQR",
                                  data = d_trial, 
                                  Variable = d_trial$MDQ_IQR,
                                  SkepticPrior = SkepticPrior, 
                                  MA_model = Intensity_variability_Prior, 
                                  Informed = FALSE, 
                                  level="Trial")


ht


MDQ_MedianDf_Segment2 <- ModelsByDiagnosis(Name = "MDQ_Median2",
                                data = d_segment2,
                                Variable = d_segment2$MDQ_Median,
                                SkepticPrior = SkepticPrior,
                                MA_model = Intensity_variability_Prior,
                                Informed = FALSE,
                                level="Segment")

ht



MDQ_IQRDf_Segment2 <- ModelsByDiagnosis(Name = "MDQ_IQR2",
                                  data = d_segment2,
                                  Variable = d_segment2$MDQ_IQR,
                                  SkepticPrior = SkepticPrior,
                                  MA_model = Intensity_variability_Prior,
                                  Informed = FALSE,
                                  level="Segment")


ht

```


# HRF Median and IQR

```{r, eval = FALSE, echo= FALSE}


HRF_MedianDf <- ModelsByDiagnosis(Name = "HRF_Median",
                                data = d_trial, 
                                Variable = d_trial$HRF_Median,
                                SkepticPrior = SkepticPrior, 
                                MA_model = Intensity_variability_Prior, 
                                Informed = FALSE, 
                                level="Trial")

ht



HRF_IQRDf <- ModelsByDiagnosis(Name = "HRF_IQR",
                                  data = d_trial, 
                                  Variable = d_trial$HRF_IQR,
                                  SkepticPrior = SkepticPrior, 
                                  MA_model = Intensity_variability_Prior, 
                                  Informed = FALSE, 
                                  level="Trial")


ht




```


## Analysis on associations between symptoms rating scales and acoustic features

# Meta-analysis correlation priors

```{r, include = FALSE, eval = TRUE}

d_metaCor <- as.data.frame(
  read_excel(here("data", "meta", "Matrix_MetaAnalysis_Correlation.xlsx")))



d_metaCor <- d_metaCor %>% mutate(
  ACOUST_ANA_DESCR = NULL,
  DESCRIPTION = NULL,
  COMMENTS = NULL,
  SAMPLE_SIZE_SZ = as.numeric(SAMPLE_SIZE_SZ),
  FEMALE_SZ = as.numeric(FEMALE_SZ),
  Task = TYPE_OF_TASK
)

# Exclude schizotypy for the main analysis
d_metaCor <- d_metaCor%>% subset(DIAGNOSIS == "SZ")


# Pitch Mean

#Negative symptoms and pitch mean

MetaAnalysisCorrelation(d_metaCor,
                        Name="negative symptoms and mean pitch",
                        FeatureCorrelation="NEG_F0_MEAN")

## Positive symptoms and pitch mean
MetaAnalysisCorrelation(d_metaCor,
                        Name="positive symptoms and mean pitch",
                        FeatureCorrelation="POS_F0_MEAN")


# Pitch variability


## Alogia and pitch variability
MetaAnalysisCorrelation(d_metaCor,
                        Name="alogia and pitch variability",
                        FeatureCorrelation="ALOGIA_F0_SD")

## Flat affect and pitch variability
MetaAnalysisCorrelation(d_metaCor,
                        Name="flat affect and pitch variability",
                        FeatureCorrelation="FLAT_F0_SD")

## Negative symptoms and pitch variability
MetaAnalysisCorrelation(d_metaCor,
                        Name="negative symptoms and pitch variability",
                        FeatureCorrelation="NEG_F0_SD")

## Positive symptoms and pitch variability
MetaAnalysisCorrelation(d_metaCor,
                        Name="positive symptoms and pitch variability",
                        FeatureCorrelation="POS_F0_SD")

## Total and pitch variability
MetaAnalysisCorrelation(d_metaCor,
                        Name="total psychopathology and pitch variability",
                        FeatureCorrelation="TOT_F0_SD")



# Intensity variability


## Flat affect and intensity variability
MetaAnalysisCorrelation(d_metaCor,
                        Name="flat affect and intensity variability",
                        FeatureCorrelation="FLAT_INTENSITY_SD")



# Proportion of spoken time

#Alogia and proportion of spoken time
MetaAnalysisCorrelation(d_metaCor,
                        Name="alogia and proportion of spoken time",
                        FeatureCorrelation="ALOGIA_SP_PERC")

## Flat affect and proportion of spoken time
MetaAnalysisCorrelation(d_metaCor,
                        Name="flat affect and proportion of spoken time",
                        FeatureCorrelation="FLAT_SP_PERC")

## Negative symptoms and proportion of spoken time
MetaAnalysisCorrelation(d_metaCor,
                        Name="negative symptoms and proportion of spoken time",
                        FeatureCorrelation="NEG_SP_PERC")

## Total and proportion of spoken time
MetaAnalysisCorrelation(d_metaCor,
                        Name="total psychopathology and proportion of spoken time",
                        FeatureCorrelation="TOT_SP_PERC")


# Pause duration

## Negative symptoms and pause duration
MetaAnalysisCorrelation(d_metaCor,
                        Name="negative symptoms and pause duration",
                        FeatureCorrelation="NEG_PAUSE_DUR")


```

# Model definitions

```{r, include = FALSE, eval = TRUE}

SymptomVoice_Language_f <-
  bf(Outcome ~ 0 + Language + Language : mo(Symptom) +
       (1 | gr(NewID, by = Language)))


# Panns dimension only available for CH corpus (for now), thus I am using this formula below

SymptomVoice_PannsSub_f <-
  bf(Outcome ~ 0 + Language + Language : mo(Symptom) +
       (1 | gr(NewID, by = Language)))

#get_prior(SymptomVoice_Language_f, data)

SymptomVoice_Gender_f <-
  bf(Outcome ~ 0 + Language:Gender + Language:Gender:mo(Symptom) + (1 | gr(NewID, by=group2)))

## Skeptic and informed priors are defined within the function

SkepticPrior <-  c(prior(normal(0.5, .3), class = b),
                      prior(normal(0, xm), class=b, coef = "moSymptom"),
                      prior(normal(0, .1), class = sd),
                      prior(normal(0.3, 0.1), class = sigma))

```


# Pitch_Median Sans/Saps

```{r, eval = TRUE, echo= FALSE}



# SANS


TotalPitch_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "Pitch_Median_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_Median,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")


 

TotalPitch_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "Pitch_Median_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_Median,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")


 

# SANS subscales

TotalPitch_Median_Flat_Df <- ModelsBySymptom(Name = "Pitch_Median_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_Median,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalPitch_Median_Alogia_Df <- ModelsBySymptom(Name = "Pitch_Median_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_Median,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


TotalPitch_Median_Flat_Df <- ModelsBySymptom(Name = "Pitch_Median_Sans_GloFlat",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_Median,
                                      Symptom = d_trial_SZ$GloFlat,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalPitch_Median_Alogia_Df <- ModelsBySymptom(Name = "Pitch_Median_Sans_GlogAlogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_Median,
                                      Symptom = d_trial_SZ$GloAlogia,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


```


# Pitch median Segment Sans/Saps 

```{r, eval = FALSE, echo= FALSE}





# SANS




TotalPitch_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "Pitch_Median_Sans_Tot_Segment",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_Median,
                                      Symptom = d_segment_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")


 

TotalPitch_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "Pitch_Median_Saps_Tot_Segment",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_Median,
                                      Symptom = d_segment_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")


 

# SANS subscales

TotalPitch_Median_Flat_Df <- ModelsBySymptom(Name = "Pitch_Median_Sans_FlatAff_Segment",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_Median,
                                      Symptom = d_segment_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")


 

TotalPitch_Median_Alogia_Df <- ModelsBySymptom(Name = "Pitch_Median_Sans_Alogia_Segment",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_Median,
                                      Symptom = d_segment_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")


 






```





# Pitch_Median_PANSS

```{r, eval = TRUE, echo= FALSE}



# PANSS SCALE



TotalPitch_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "Pitch_Median_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_Median,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalPitch_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "Pitch_Median_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_Median,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")


 

TotalPitch_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "Pitch_Median_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_Median,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")


 


# PANNS subscales





TotalPitch_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "Pitch_Median_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_Median,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalPitch_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "Pitch_Median_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_Median,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 




```

# Pitch_Median Segment PANSS 

```{r, eval =FALSE, echo= FALSE}




# PANSS SCALE



TotalPitch_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "Pitch_Median_Panss_Tot_Segment",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_Median,
                                      Symptom = d_segment_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")

 

TotalPitch_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "Pitch_Median_Panss_Ne_Segment",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_Median,
                                      Symptom = d_segment_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")


 

TotalPitch_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "Pitch_Median_Panss_Pos_Segment",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_Median,
                                      Symptom = d_segment_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")


 


# PANNS subscales




TotalPitch_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "Pitch_Median_PANNS_Blunt_Segment",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_Median,
                                      Symptom = d_segment_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")

 

TotalPitch_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "Pitch_Median_PANNS_Conv_Segment",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_Median,
                                      Symptom = d_segment_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")


 




```


# Pitch_IQR and Sans/Saps

```{r, eval = TRUE, echo= FALSE}




# SANS


TotalPitch_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "Pitch_IQR_Sans_Tot",
                                     data =  d_trial_SZ,
                                     Outcome = d_trial_SZ$Pitch_IQR,
                                     Symptom = d_trial_SZ$Sans_Tot,
                                     SkepticPrior = SkepticPrior,
                                     MA_model = `negative symptoms and pitch variability_BayesianPrior`,
                                     Informed = TRUE,
                                     level="Trial")

 

TotalPitch_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "Pitch_IQR_Saps_Tot",
                                     data =  d_trial_SZ,
                                     Outcome = d_trial_SZ$Pitch_IQR,
                                     Symptom = d_trial_SZ$Saps_Tot,
                                     SkepticPrior = SkepticPrior,
                                     MA_model = `positive symptoms and pitch variability_BayesianPrior`,
                                     Informed = TRUE,
                                     level="Trial")


 

# SANS subscales

TotalPitch_IQR_Flat_Df <- ModelsBySymptom(Name = "Pitch_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_IQR,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `flat affect and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")


 


TotalPitch_IQR_Alogia_Df <- ModelsBySymptom(Name = "Pitch_IQR_Sans_Alogia",
                                     data =  d_trial_SZ,
                                   Outcome = d_trial_SZ$Pitch_IQR,
                                    Symptom = d_trial_SZ$Alogia_Tot,
                                   SkepticPrior = SkepticPrior,
                                   MA_model = `alogia and pitch variability_BayesianPrior`,
                                  Informed = TRUE,
                                  level="Trial")

 

 

TotalPitch_IQR_Flat_Df <- ModelsBySymptom(Name = "Pitch_IQR_Sans_GloFlat",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_IQR,
                                      Symptom = d_trial_SZ$GloFlat,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `flat affect and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")


 


TotalPitch_IQR_Alogia_Df <- ModelsBySymptom(Name = "Pitch_IQR_Sans_GloAlogia",
                                     data =  d_trial_SZ,
                                   Outcome = d_trial_SZ$Pitch_IQR,
                                    Symptom = d_trial_SZ$GloAlogia,
                                   SkepticPrior = SkepticPrior,
                                   MA_model = `alogia and pitch variability_BayesianPrior`,
                                  Informed = TRUE,
                                  level="Trial")

 

 


```



# Pitch IQR Segment Sans/Saps 

```{r, eval =FALSE, echo= FALSE}





# SANS


TotalPitch_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "Pitch_IQR_Sans_Tot_Segment",
                                     data =  d_segment_SZ,
                                     Outcome = d_segment_SZ$Pitch_IQR,
                                     Symptom = d_segment_SZ$Sans_Tot,
                                     SkepticPrior = SkepticPrior,
                                     MA_model = `negative symptoms and pitch variability_BayesianPrior`,
                                     Informed = TRUE,
                                     level="Segment")

 

TotalPitch_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "Pitch_IQR_Saps_Tot_Segment",
                                     data =  d_segment_SZ,
                                     Outcome = d_segment_SZ$Pitch_IQR,
                                     Symptom = d_segment_SZ$Saps_Tot,
                                     SkepticPrior = SkepticPrior,
                                     MA_model = `positive symptoms and pitch variability_BayesianPrior`,
                                     Informed = TRUE,
                                     level="Segment")


 

# SANS subscales

TotalPitch_IQR_Flat_Df <- ModelsBySymptom(Name = "Pitch_IQR_Sans_FlatAff_Segment",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_IQR,
                                      Symptom = d_segment_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `flat affect and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")


 


TotalPitch_IQR_Alogia_Df <- ModelsBySymptom(Name = "Pitch_IQR_Sans_Alogia_Segment",
                                     data =  d_segment_SZ,
                                   Outcome = d_segment_SZ$Pitch_IQR,
                                    Symptom = d_segment_SZ$Alogia_Tot,
                                   SkepticPrior = SkepticPrior,
                                   MA_model = `alogia and pitch variability_BayesianPrior`,
                                 Informed = TRUE,
 
                                                               level="Segment")

 



```



# Pitch_IQR and PANSS

```{r, eval = TRUE, echo= FALSE}



# PANSS SCALE


TotalPitch_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "Pitch_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_IQR,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `total psychopathology and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")


 

TotalPitch_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "Pitch_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_IQR,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")

 

TotalPitch_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "Pitch_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_IQR,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")

 

# PANNS subscales


 

TotalPitch_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "Pitch_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_IQR,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `flat affect and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")


 

TotalPitch_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "Pitch_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_IQR,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `alogia and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")



 



```


# Pitch_IQR Segment and PANSS 


```{r, eval = FALSE, echo= FALSE}



# PANSS SCALE


TotalPitch_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "Pitch_IQR_Panss_Tot",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_IQR,
                                      Symptom = d_segment_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `total psychopathology and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")


 

TotalPitch_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "Pitch_IQR_Panss_Neg",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_IQR,
                                      Symptom = d_segment_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")

 

TotalPitch_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "Pitch_IQR_Panss_Pos",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_IQR,
                                      Symptom = d_segment_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")

 

# PANNS subscales





TotalPitch_IQR_Emo_With_PANNS_Df <- ModelsBySymptomPannsSub(Name = "Pitch_IQR_PANNS_Emo_With",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_IQR,
                                      Symptom = d_segment_SZ$Emo_With_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")

 

TotalPitch_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "Pitch_IQR_PANNS_Blunt",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_IQR,
                                      Symptom = d_segment_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `flat affect and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")


 

TotalPitch_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "Pitch_IQR_PANNS_Conv",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$Pitch_IQR,
                                      Symptom = d_segment_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `alogia and pitch variability_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")



 



```



# PercentSpoken and Sans/Saps

```{r, eval = TRUE, echo= FALSE}





# SANS




TotalPercentSpoke_Praat_Sans_Tot_Df <- ModelsBySymptom(Name = "PercentSpoke_Praat_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PercentSpoke_Praat,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and proportion of spoken time_BayesianPrior` ,
                                      Informed = TRUE,
                                      level="Trial")





TotalPercentSpoke_Praat_Saps_Tot_Df <- ModelsBySymptom(Name = "PercentSpoke_Praat_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PercentSpoke_Praat,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


TotalPercentSpoke_Praat_Flat_Df <- ModelsBySymptom(Name = "PercentSpoke_Praat_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PercentSpoke_Praat,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model =
`flat affect and proportion of spoken time_BayesianPrior` ,
                                      Informed = TRUE,
                                      level="Trial")

 



TotalPercentSpoke_Praat_Alogia_Df <- ModelsBySymptom(Name = "PercentSpoke_Praat_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PercentSpoke_Praat,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `alogia and proportion of spoken time_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")


 




TotalPercentSpoke_Praat_Flat_Df <- ModelsBySymptom(Name = "PercentSpoke_Praat_Sans_GloFlat",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PercentSpoke_Praat,
                                      Symptom = d_trial_SZ$GloFlat,
                                      SkepticPrior = SkepticPrior,
                                      MA_model =
`flat affect and proportion of spoken time_BayesianPrior` ,
                                      Informed = TRUE,
                                      level="Trial")

 


TotalPercentSpoke_Praat_Alogia_Df <- ModelsBySymptom(Name = "PercentSpoke_Praat_Sans_GloAlogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PercentSpoke_Praat,
                                      Symptom = d_trial_SZ$GloAlogia,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `alogia and proportion of spoken time_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")


 


```

# PercentSpoken Segment and Sans/Saps

```{r, eval = FALSE, echo= FALSE}


# Proportion of spoken time


# SANS


# PRAAT



TotalPercentSpoke_Praat_Sans_Tot_Df <- ModelsBySymptom(Name = "PercentSpoke_Praat_Sans_Tot",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$PercentSpoke_Praat,
                                      Symptom = d_segment_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and proportion of spoken time_BayesianPrior` ,
                                      Informed = TRUE,
                                      level="Segment")





TotalPercentSpoke_Praat_Saps_Tot_Df <- ModelsBySymptom(Name = "PercentSpoke_Praat_Saps_Tot",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$PercentSpoke_Praat,
                                      Symptom = d_segment_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")


 


TotalPercentSpoke_Praat_Flat_Df <- ModelsBySymptom(Name = "PercentSpoke_Praat_Sans_FlatAff",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$PercentSpoke_Praat,
                                      Symptom = d_segment_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model =
`flat affect and proportion of spoken time_BayesianPrior` ,
                                      Informed = TRUE,
                                      level="Segment")

 


TotalPercentSpoke_Praat_Alogia_Df <- ModelsBySymptom(Name = "PercentSpoke_Praat_Sans_Alogia",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$PercentSpoke_Praat,
                                      Symptom = d_segment_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `alogia and proportion of spoken time_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")


 



TotalPercentSpoke_Praat_Flat_Df <- ModelsBySymptom(Name = "PercentSpoke_Praat_Sans_GloFlat",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$PercentSpoke_Praat,
                                      Symptom = d_segment_SZ$GloFlat,
                                      SkepticPrior = SkepticPrior,
                                      MA_model =
`flat affect and proportion of spoken time_BayesianPrior` ,
                                      Informed = TRUE,
                                      level="Segment")



TotalPercentSpoke_Praat_Alogia_Df <- ModelsBySymptom(Name = "PercentSpoke_Praat_Sans_GloAlogia",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$PercentSpoke_Praat,
                                      Symptom = d_segment_SZ$GloAlogia,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `alogia and proportion of spoken time_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")


 

```

# PercentSpoken and PANSS

```{r, eval = TRUE, echo= FALSE}



   # PANSS SCALE



TotalPercentSpoke_Praat_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "PercentSpoke_Praat_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PercentSpoke_Praat,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `total psychopathology and proportion of spoken time_BayesianPrior` ,
                                      Informed = TRUE,
                                      level="Trial")


 

TotalPercentSpoke_Praat_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "PercentSpoke_Praat_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PercentSpoke_Praat,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and proportion of spoken time_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")

 

TotalPercentSpoke_Praat_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "PercentSpoke_Praat_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PercentSpoke_Praat,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

# PANNS subscales





TotalPercentSpoke_Praat_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "PercentSpoke_Praat_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PercentSpoke_Praat,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `flat affect and proportion of spoken time_BayesianPrior` ,
                                      Informed = TRUE,
                                      level="Trial")


 


TotalPercentSpoke_Praat_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "PercentSpoke_Praat_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PercentSpoke_Praat,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `alogia and proportion of spoken time_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")


 

```


# PercentSpoken Segment and PANSS

```{r, eval = FALSE, echo= FALSE}

   # PANSS SCALE



TotalPercentSpoke_Praat_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "PercentSpoke_Praat_Panss_Tot",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$PercentSpoke_Praat,
                                      Symptom = d_segment_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `total psychopathology and proportion of spoken time_BayesianPrior` ,
                                      Informed = TRUE,
                                      level="Segment")


 

TotalPercentSpoke_Praat_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "PercentSpoke_Praat_Panss_Neg",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$PercentSpoke_Praat,
                                      Symptom = d_segment_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and proportion of spoken time_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")

 

TotalPercentSpoke_Praat_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "PercentSpoke_Praat_Panss_Pos",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$PercentSpoke_Praat,
                                      Symptom = d_segment_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")


 

# PANNS subscales





TotalPercentSpoke_Praat_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "PercentSpoke_Praat_PANNS_Blunt",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$PercentSpoke_Praat,
                                      Symptom = d_segment_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `flat affect and proportion of spoken time_BayesianPrior` ,
                                      Informed = FALSE,
                                      level="Segment")


 


TotalPercentSpoke_Praat_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "PercentSpoke_Praat_PANNS_Conv",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$PercentSpoke_Praat,
                                      Symptom = d_segment_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `alogia and proportion of spoken time_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")


 


```

# Mean Pause duration and Sans

```{r, eval = TRUE, echo= FALSE}





# SANS

TotalMeanPauseDur_Praat_Sans_Df <- ModelsBySymptom(Name = "MeanPauseDurPraat_SansTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanPauseDur_Praat,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and pause duration_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")

 

TotalMeanPauseDur_Praat_Saps_Df <- ModelsBySymptom(Name = "MeanPauseDurPraat_SapsTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanPauseDur_Praat,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

# SANS subscales


TotalMeanPauseDur_Praat_Flat_Df <- ModelsBySymptom(Name = "MeanPauseDurPraat_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanPauseDur_Praat,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

Total_MeanPauseDur_Praat_Alogia_Df <- ModelsBySymptom(Name = "MeanPauseDurPraat_AlogiaTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanPauseDur_Praat,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


TotalMeanPauseDur_Praat_Flat_Df <- ModelsBySymptom(Name = "MeanPauseDurPraat_GloFlat",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanPauseDur_Praat,
                                      Symptom = d_trial_SZ$GloFlat,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

Total_MeanPauseDur_Praat_Alogia_Df <- ModelsBySymptom(Name = "MeanPauseDurPraat_GloAlogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanPauseDur_Praat,
                                      Symptom = d_trial_SZ$GloAlogia,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 




```



# Mean Pause dur Segment and Sans


```{r, eval = FALSE, echo= FALSE}



# SANS

TotalMeanPauseDur_Praat_Sans_Df <- ModelsBySymptom(Name = "MeanPauseDurPraat_SansTot",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$MeanPauseDur_Praat,
                                      Symptom = d_segment_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and pause duration_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")

 

TotalMeanPauseDur_Praat_Saps_Df <- ModelsBySymptom(Name = "MeanPauseDurPraat_SapsTot",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$MeanPauseDur_Praat,
                                      Symptom = d_segment_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")

 

# SANS subscales


TotalMeanPauseDur_Praat_Flat_Df <- ModelsBySymptom(Name = "MeanPauseDurPraat_FlatAff",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$MeanPauseDur_Praat,
                                      Symptom = d_segment_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")

 

Total_MeanPauseDur_Praat_Alogia_Df <- ModelsBySymptom(Name = "MeanPauseDurPraat_AlogiaTot",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$MeanPauseDur_Praat,
                                      Symptom = d_segment_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")


 


TotalMeanPauseDur_Praat_Flat_Df <- ModelsBySymptom(Name = "MeanPauseDurPraat_GloFlat",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$MeanPauseDur_Praat,
                                      Symptom = d_segment_SZ$GloFlat,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")

 

Total_MeanPauseDur_Praat_Alogia_Df <- ModelsBySymptom(Name = "MeanPauseDurPraat_GloAlogia",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$MeanPauseDur_Praat,
                                      Symptom = d_segment_SZ$GloAlogia,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")


 



```



# Mean Pause duration and PANSS

```{r, eval = TRUE, echo= FALSE}



# PANSS SCALE


TotalMeanPauseDur_Praat_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "MeanPauseDur_Praat_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanPauseDur_Praat,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalMeanPauseDur_Praat_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "MeanPauseDur_Praat_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanPauseDur_Praat,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and pause duration_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Trial")



 

TotalMeanPauseDur_Praat_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "MeanPauseDur_Praat_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanPauseDur_Praat,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

# PANNS subscales


TotalMeanPauseDur_Praat_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "MeanPauseDur_Praat_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanPauseDur_Praat,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 


TotalMeanPauseDur_Praat_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "MeanPauseDur_Praat_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanPauseDur_Praat,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

```

# Mean Pause dur Segment and PANSS

```{r, eval =FALSE, echo= FALSE}




# PANSS SCALE


TotalMeanPauseDur_Praat_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "MeanPauseDur_Praat_Panss_Tot",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$MeanPauseDur_Praat,
                                      Symptom = d_segment_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")


 

TotalMeanPauseDur_Praat_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "MeanPauseDur_Praat_Panss_Neg",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$MeanPauseDur_Praat,
                                      Symptom = d_segment_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and pause duration_BayesianPrior`,
                                      Informed = TRUE,
                                      level="Segment")



 

TotalMeanPauseDur_Praat_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "MeanPauseDur_Praat_Panss_Pos",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$MeanPauseDur_Praat,
                                      Symptom = d_segment_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")

 

# PANNS subscales




TotalMeanPauseDur_Praat_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "MeanPauseDur_Praat_PANNS_Blunt",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$MeanPauseDur_Praat,
                                      Symptom = d_segment_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")

 


TotalMeanPauseDur_Praat_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "MeanPauseDur_Praat_PANNS_Conv",
                                      data =  d_segment_SZ,
                                      Outcome = d_segment_SZ$MeanPauseDur_Praat,
                                      Symptom = d_segment_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Segment")


 



```


# Speech_rate and Sans

```{r, eval = TRUE, echo= FALSE}




# SANS

TotalSpeech_Rate_Praat_Sans_Df <- ModelsBySymptom(Name = "Speech_Rate_SansTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Speech_Rate_Praat,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalSpeech_Rate_Praat_Saps_Df <- ModelsBySymptom(Name = "Speech_Rate_SapsTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Speech_Rate_Praat,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 



# SANS subscales


TotalSpeech_Rate_Praat_Flat_Df <- ModelsBySymptom(Name = "Speech_Rate_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Speech_Rate_Praat,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

Total_Speech_Rate_Praat_Alogia_Df <- ModelsBySymptom(Name = "Speech_Rate_AlogiaTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Speech_Rate_Praat,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 





TotalSpeech_Rate_Praat_Flat_Df <- ModelsBySymptom(Name = "Speech_Rate_GLoFlat",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Speech_Rate_Praat,
                                      Symptom = d_trial_SZ$GloFlat,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 


Total_Speech_Rate_Praat_Alogia_Df <- ModelsBySymptom(Name = "Speech_Rate_GloAlogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Speech_Rate_Praat,
                                      Symptom = d_trial_SZ$GloAlogia,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 




```

# Speech rate and PANSS

```{r, eval = TRUE, echo= FALSE}



# PANSS SCALE

Speech_Rate_Praat_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "Speech_Rate_Praat_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Speech_Rate_Praat,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

Speech_Rate_Praat_Cova_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "Speech_Rate_Praat_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Speech_Rate_Praat,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

Speech_Rate_Praat_Cova_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "Speech_Rate_Praat_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Speech_Rate_Praat,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

# PANNS subscales




TotalSpeech_Rate_Praat_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "Speech_Rate_Praat_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Speech_Rate_Praat,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


       
       
TotalSpeech_Rate_Praat_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "Speech_Rate_Praat_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Speech_Rate_Praat,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 


```

# Number of pauses and Sans

```{r, eval=TRUE, echo= FALSE}




# SANS

TotalPauseNumMin_Praat_Sans_Df <- ModelsBySymptom(Name = "PauseNumMinPraat_SansTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PauseNumMin_Praat,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalPauseNumMin_Praat_Saps_Df <- ModelsBySymptom(Name = "PauseNumMinPraat_SapsTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PauseNumMin_Praat,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

# SANS subscales


TotalPauseNumMin_Praat_Flat_Df <- ModelsBySymptom(Name = "PauseNumMinPraat_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PauseNumMin_Praat,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

Total_PauseNumMin_Praat_Alogia_Df <- ModelsBySymptom(Name = "PauseNumMinPraat_AlogiaTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PauseNumMin_Praat,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



TotalPauseNumMin_Praat_Flat_Df <- ModelsBySymptom(Name = "PauseNumMinPraat_GloFlat",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PauseNumMin_Praat,
                                      Symptom = d_trial_SZ$GloFlat,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

Total_PauseNumMin_Praat_Alogia_Df <- ModelsBySymptom(Name = "PauseNumMinPraat_GloAlogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PauseNumMin_Praat,
                                      Symptom = d_trial_SZ$GloAlogia,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


```

# Number of pauses and PANSS

```{r, eval = TRUE, echo= FALSE}



# PANSS SCALE



PauseNumMin_Praat_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "PauseNumMin_Praat_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PauseNumMin_Praat,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


PauseNumMin_Praat_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "PauseNumMin_Praat_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PauseNumMin_Praat,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 


PauseNumMin_Praat_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "PauseNumMin_Praat_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PauseNumMin_Praat,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 


# PANNS subscales




TotalPauseNumMin_Praat_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "PauseNumMin_Praat_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PauseNumMin_Praat,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


TotalPauseNumMin_Praat_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "PauseNumMin_Praat_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PauseNumMin_Praat,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


```

# Number of utterance and SANS/SAPS

```{r, eval=TRUE, echo= FALSE}


TotalTurnNumMin_Praat_Sans_Df <- ModelsBySymptom(Name = "TurnNumMin_Praat_SansTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnNumMin_Praat,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalTurnNumMin_Praat_Saps_Df <- ModelsBySymptom(Name = "TurnNumMin_Praat_SapsTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnNumMin_Praat,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

# SANS subscales


TotalTurnNumMin_Praat_Flat_Df <- ModelsBySymptom(Name = "TurnNumMin_Praat_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnNumMin_Praat,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

Total_TurnNumMin_Praat_Alogia_Df <- ModelsBySymptom(Name = "TurnNumMin_Praat_AlogiaTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnNumMin_Praat,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 





Total_TurnNumMin_Praat_GLoFlat_Df <- ModelsBySymptom(Name = "TurnNumMin_Praat_GloFlat",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnNumMin_Praat,
                                      Symptom = d_trial_SZ$GloFlat,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



TotalTurnNumMin_Praat_GLoalogia_Df <- ModelsBySymptom(Name = "TurnNumMin_Praat_GloAlogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnNumMin_Praat,
                                      Symptom = d_trial_SZ$GloAlogia,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 


```


# Number of utterance and PANSS

```{r, eval=TRUE, echo= FALSE}

# PRAAT


TurnNumMin_Praat_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "TurnNumMin_Praat_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnNumMin_Praat,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


TurnNumMin_Praat_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "TurnNumMin_Praat_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnNumMin_Praat,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 


TurnNumMin_Praat_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "TurnNumMin_Praat_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnNumMin_Praat,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 


# PANNS subscales




TotalTurnNumMin_Praat_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "TurnNumMin_Praat_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnNumMin_Praat,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


TotalTurnNumMin_Praat_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "TurnNumMin_Praat_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnNumMin_Praat,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


```




# Duration of utterance and SANS/SAPS

```{r, eval=TRUE, echo= FALSE}

TurnDuration_Praat_Sans_Df <- ModelsBySymptom(Name = "TurnDuration_Praat_SansTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnDuration_Praat,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TurnDuration_Praat_Saps_Df <- ModelsBySymptom(Name = "TurnDuration_Praat_SapsTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnDuration_Praat,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

# SANS subscales


TurnDuration_Praat_Flat_Df <- ModelsBySymptom(Name = "TurnDuration_Praat_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnDuration_Praat,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TurnDuration_Praat_Alogia_Df <- ModelsBySymptom(Name = "TurnDuration_Praat_AlogiaTot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnDuration_Praat,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



TurnDuration_Praat_GloFlat_Df <- ModelsBySymptom(Name = "TurnDuration_Praat_GloFlat",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnDuration_Praat,
                                      Symptom = d_trial_SZ$GloFlat,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TurnDuration_Praat_GloAlogia_Df <- ModelsBySymptom(Name = "TurnDuration_Praat_GloAlogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnDuration_Praat,
                                      Symptom = d_trial_SZ$GloAlogia,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


```



# Duration of utterance and PANSS


```{r, eval=TRUE, echo= FALSE}




# PRAAT


PauseNumMin_Praat_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "TurnDuration_Praat_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnDuration_Praat,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


PauseNumMin_Praat_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "TurnDuration_Praat_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnDuration_Praat,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 


PauseNumMin_Praat_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "TurnDuration_Praat_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnDuration_Praat,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 


# PANNS subscales





TotalPauseNumMin_Praat_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "TurnDuration_Praat_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnDuration_Praat,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


TotalPauseNumMin_Praat_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "TurnDuration_Praat_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnDuration_Praat,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

```




# F1 Median

```{r, eval = TRUE}


TotalPitch_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "F1_Median_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_Median,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 



TotalF1_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "F1_Median_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_Median,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalF1_Median_Flat_Df <- ModelsBySymptom(Name = "F1_Median_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_Median,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



TotalF1_Median_Alogia_Df <- ModelsBySymptom(Name = "F1_Median_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_Median,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 


 
##   PANNS    

TotalF1_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "F1_Median_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_Median,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF1_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "F1_Median_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_Median,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF1_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "F1_Median_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_Median,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales



  

TotalF1_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "F1_Median_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_Median,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF1_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "F1_Median_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_Median,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



```

# F1 IQR

```{r, eval = TRUE}


TotalF1_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "F1_IQR_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_IQR,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF1_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "F1_IQR_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_IQR,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalF1_IQR_Flat_Df <- ModelsBySymptom(Name = "F1_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_IQR,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF1_IQR_Alogia_Df <- ModelsBySymptom(Name = "F1_IQR_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_IQR,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalF1_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "F1_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_IQR,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF1_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "F1_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_IQR,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF1_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "F1_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_IQR,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales




TotalF1_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "F1_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_IQR,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF1_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "F1_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F1_IQR,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 




```


# F2 Median

```{r, eval = TRUE}

TotalF2_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "F2_Median_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_Median,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF2_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "F2_Median_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_Median,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalF2_Median_Flat_Df <- ModelsBySymptom(Name = "F2_Median_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_Median,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF2_Median_Alogia_Df <- ModelsBySymptom(Name = "F2_Median_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_Median,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalF2_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "F2_Median_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_Median,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF2_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "F2_Median_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_Median,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF2_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "F2_Median_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_Median,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales



TotalF2_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "F2_Median_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_Median,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF2_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "F2_Median_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_Median,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 






```

# F2 IQR

```{r, eval = TRUE}

TotalF2_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "F2_IQR_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_IQR,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed =FALSE,
                                      level="Trial")


 

TotalF2_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "F2_IQR_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_IQR,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalF2_IQR_Flat_Df <- ModelsBySymptom(Name = "F2_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_IQR,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF2_IQR_Alogia_Df <- ModelsBySymptom(Name = "F2_IQR_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_IQR,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalF2_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "F2_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_IQR,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF2_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "F2_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_IQR,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed =FALSE,
                                      level="Trial")


 

TotalF2_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "F2_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_IQR,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales




TotalF2_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "F2_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_IQR,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF2_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "F2_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F2_IQR,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 







```


# F3 Median

```{r, eval = TRUE}


TotalPitch_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "F3_Median_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_Median,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 




TotalF3_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "F3_Median_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_Median,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalF3_Median_Flat_Df <- ModelsBySymptom(Name = "F3_Median_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_Median,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 




TotalF3_Median_Alogia_Df <- ModelsBySymptom(Name = "F3_Median_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_Median,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")




 
####    PANNS     ######

TotalF3_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "F3_Median_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_Median,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF3_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "F3_Median_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_Median,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF3_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "F3_Median_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_Median,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales




TotalF3_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "F3_Median_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_Median,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF3_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "F3_Median_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_Median,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



```




# F3 IQR

```{r, eval = TRUE}


TotalF3_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "F3_IQR_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_IQR,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF3_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "F3_IQR_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_IQR,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalF3_IQR_Flat_Df <- ModelsBySymptom(Name = "F3_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_IQR,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF3_IQR_Alogia_Df <- ModelsBySymptom(Name = "F3_IQR_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_IQR,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalF3_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "F3_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_IQR,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF3_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "F3_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_IQR,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF3_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "F3_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_IQR,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales




TotalF3_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "F3_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_IQR,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF3_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "F3_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F3_IQR,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 




```


# F4 Median

```{r, eval = TRUE}


TotalPitch_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "F4_Median_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_Median,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 



TotalF4_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "F4_Median_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_Median,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalF4_Median_Flat_Df <- ModelsBySymptom(Name = "F4_Median_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_Median,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")




TotalF4_Median_Alogia_Df <- ModelsBySymptom(Name = "F4_Median_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_Median,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

 
####    PANNS     ######

TotalF4_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "F4_Median_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_Median,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF4_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "F4_Median_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_Median,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF4_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "F4_Median_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_Median,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales




TotalF4_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "F4_Median_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_Median,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF4_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "F4_Median_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_Median,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



```

# F4 IQR

```{r, eval = TRUE}


TotalF4_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "F4_IQR_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_IQR,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF4_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "F4_IQR_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_IQR,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalF4_IQR_Flat_Df <- ModelsBySymptom(Name = "F4_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_IQR,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF4_IQR_Alogia_Df <- ModelsBySymptom(Name = "F4_IQR_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_IQR,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalF4_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "F4_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_IQR,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF4_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "F4_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_IQR,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF4_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "F4_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_IQR,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales






TotalF4_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "F4_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_IQR,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF4_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "F4_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F4_IQR,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 




```

# F5 Median

```{r, eval = TRUE}


TotalPitch_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "F5_Median_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_Median,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 



TotalF5_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "F5_Median_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_Median,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalF5_Median_Flat_Df <- ModelsBySymptom(Name = "F5_Median_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_Median,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



TotalF5_Median_Alogia_Df <- ModelsBySymptom(Name = "F5_Median_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_Median,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")



 
####    PANNS     ######

TotalF5_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "F5_Median_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_Median,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF5_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "F5_Median_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_Median,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF5_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "F5_Median_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_Median,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales




TotalF5_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "F5_Median_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_Median,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF5_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "F5_Median_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_Median,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



```

# F5 IQR

```{r, eval = TRUE}


TotalF5_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "F5_IQR_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_IQR,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF5_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "F5_IQR_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_IQR,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalF5_IQR_Flat_Df <- ModelsBySymptom(Name = "F5_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_IQR,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF5_IQR_Alogia_Df <- ModelsBySymptom(Name = "F5_IQR_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_IQR,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalF5_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "F5_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_IQR,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF5_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "F5_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_IQR,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalF5_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "F5_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_IQR,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales




TotalF5_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "F5_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_IQR,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalF5_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "F5_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$F5_IQR,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 




```


# H1H2 Median


```{r, eval = TRUE}


TotalH1H2_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "H1H2_Median_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_Median,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalH1H2_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "H1H2_Median_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_Median,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalH1H2_Median_Flat_Df <- ModelsBySymptom(Name = "H1H2_Median_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_Median,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalH1H2_Median_Alogia_Df <- ModelsBySymptom(Name = "H1H2_Median_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_Median,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalH1H2_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "H1H2_Median_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_Median,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalH1H2_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "H1H2_Median_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_Median,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalH1H2_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "H1H2_Median_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_Median,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales




TotalH1H2_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "H1H2_Median_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_Median,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalH1H2_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "H1H2_Median_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_Median,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 





```


# H1H2 IQR



```{r, eval = TRUE}


TotalH1H2_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "H1H2_IQR_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_IQR,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalH1H2_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "H1H2_IQR_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_IQR,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalH1H2_IQR_Flat_Df <- ModelsBySymptom(Name = "H1H2_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_IQR,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalH1H2_IQR_Alogia_Df <- ModelsBySymptom(Name = "H1H2_IQR_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_IQR,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalH1H2_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "H1H2_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_IQR,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalH1H2_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "H1H2_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_IQR,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalH1H2_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "H1H2_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_IQR,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales





TotalH1H2_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "H1H2_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_IQR,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalH1H2_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "H1H2_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$H1H2_IQR,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 





```

#  QOQ_Median 


```{r, eval =  TRUE}


TotalQOQ_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "QOQ_Median_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_Median,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalQOQ_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "QOQ_Median_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_Median,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalQOQ_Median_Flat_Df <- ModelsBySymptom(Name = "QOQ_Median_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_Median,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalQOQ_Median_Alogia_Df <- ModelsBySymptom(Name = "QOQ_Median_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_Median,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalQOQ_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "QOQ_Median_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_Median,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalQOQ_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "QOQ_Median_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_Median,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalQOQ_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "QOQ_Median_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_Median,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales


 

TotalQOQ_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "QOQ_Median_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_Median,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalQOQ_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "QOQ_Median_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_Median,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 






```


# QOQ IQR

```{r, eval = TRUE}

TotalQOQ_IQ_Sans_Tot_Df <- ModelsBySymptom(Name = "QOQ_IQR_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_IQR,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalQOQ_IQ_Saps_Tot_Df <- ModelsBySymptom(Name = "QOQ_IQR_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_IQR,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalQOQ_IQ_Flat_Df <- ModelsBySymptom(Name = "QOQ_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_IQR,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalQOQ_IQ_Alogia_Df <- ModelsBySymptom(Name = "QOQ_IQR_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_IQR,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalQOQ_IQ_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "QOQ_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_IQR,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalQOQ_IQ_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "QOQ_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_IQR,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalQOQ_IQ_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "QOQ_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_IQR,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales





TotalQOQ_IQ_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "QOQ_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_IQR,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalQOQ_IQ_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "QOQ_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$QOQ_IQR,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 




```


# NAQ Median


```{r, eval =  TRUE}


TotalNAQ_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "NAQ_Median_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_Median,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalNAQ_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "NAQ_Median_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_Median,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalNAQ_Median_Flat_Df <- ModelsBySymptom(Name = "NAQ_Median_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_Median,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalNAQ_Median_Alogia_Df <- ModelsBySymptom(Name = "NAQ_Median_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_Median,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalNAQ_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "NAQ_Median_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_Median,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalNAQ_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "NAQ_Median_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_Median,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalNAQ_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "NAQ_Median_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_Median,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales



TotalNAQ_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "NAQ_Median_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_Median,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalNAQ_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "NAQ_Median_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_Median,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 







```

# NAQ IQR

```{r, eval =  TRUE}

TotalNAQ_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "NAQ_IQR_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_IQR,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalNAQ_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "NAQ_IQR_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_IQR,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalNAQ_IQR_Flat_Df <- ModelsBySymptom(Name = "NAQ_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_IQR,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalNAQ_IQR_Alogia_Df <- ModelsBySymptom(Name = "NAQ_IQR_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_IQR,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalNAQ_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "NAQ_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_IQR,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalNAQ_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "NAQ_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_IQR,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalNAQ_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "NAQ_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_IQR,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales





TotalNAQ_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "NAQ_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_IQR,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalNAQ_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "NAQ_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$NAQ_IQR,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 




```

# HNR Median

```{r, eval =  TRUE}


TotalHNR_mean_Sans_Tot_Df <- ModelsBySymptom(Name = "HNR_mean_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_mean,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalHNR_mean_Saps_Tot_Df <- ModelsBySymptom(Name = "HNR_mean_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_mean,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalHNR_mean_Flat_Df <- ModelsBySymptom(Name = "HNR_mean_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_mean,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalHNR_mean_Alogia_Df <- ModelsBySymptom(Name = "HNR_mean_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_mean,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalHNR_mean_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "HNR_mean_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_mean,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalHNR_mean_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "HNR_mean_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_mean,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalHNR_mean_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "HNR_mean_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_mean,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales



TotalHNR_mean_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "HNR_mean_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_mean,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalHNR_mean_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "HNR_mean_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_mean,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 







```

# HNR STD

```{r, eval =  TRUE}


TotalHNR_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "HNR_IQR_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_std,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalHNR_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "HNR_IQR_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_std,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalHNR_IQR_Flat_Df <- ModelsBySymptom(Name = "HNR_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_std,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalHNR_IQR_Alogia_Df <- ModelsBySymptom(Name = "HNR_IQR_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_std,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalHNR_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "HNR_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_std,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalHNR_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "HNR_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_std,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalHNR_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "HNR_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_std,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales

 

TotalHNR_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "HNR_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_std,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalHNR_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "HNR_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HNR_std,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 







```


# PSP Median

```{r, eval =  TRUE}


TotalPSP_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "PSP_Median_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_Median,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalPSP_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "PSP_Median_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_Median,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalPSP_Median_Flat_Df <- ModelsBySymptom(Name = "PSP_Median_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_Median,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalPSP_Median_Alogia_Df <- ModelsBySymptom(Name = "PSP_Median_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_Median,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalPSP_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "PSP_Median_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_Median,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalPSP_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "PSP_Median_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_Median,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalPSP_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "PSP_Median_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_Median,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales



TotalPSP_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "PSP_Median_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_Median,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalPSP_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "PSP_Median_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_Median,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 







```


# PSP IQR

```{r, eval =  TRUE}


TotalPSP_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "PSP_IQR_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_IQR,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalPSP_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "PSP_IQR_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_IQR,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalPSP_IQR_Flat_Df <- ModelsBySymptom(Name = "PSP_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_IQR,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalPSP_IQR_Alogia_Df <- ModelsBySymptom(Name = "PSP_IQR_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_IQR,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalPSP_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "PSP_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_IQR,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalPSP_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "PSP_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_IQR,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalPSP_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "PSP_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_IQR,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales



TotalPSP_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "PSP_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_IQR,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalPSP_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "PSP_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PSP_IQR,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 







```



# MDQ Median

```{r, eval =  TRUE}


TotalMDQ_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "MDQ_Median_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_Median,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalMDQ_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "MDQ_Median_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_Median,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalMDQ_Median_Flat_Df <- ModelsBySymptom(Name = "MDQ_Median_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_Median,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalMDQ_Median_Alogia_Df <- ModelsBySymptom(Name = "MDQ_Median_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_Median,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalMDQ_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "MDQ_Median_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_Median,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalMDQ_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "MDQ_Median_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_Median,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalMDQ_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "MDQ_Median_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_Median,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales



TotalMDQ_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "MDQ_Median_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_Median,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalMDQ_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "MDQ_Median_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_Median,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 







```


# MDQ IQR

```{r, eval =  TRUE}


TotalMDQ_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "MDQ_IQR_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_IQR,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalMDQ_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "MDQ_IQR_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_IQR,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalMDQ_IQR_Flat_Df <- ModelsBySymptom(Name = "MDQ_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_IQR,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalMDQ_IQR_Alogia_Df <- ModelsBySymptom(Name = "MDQ_IQR_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_IQR,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalMDQ_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "MDQ_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_IQR,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalMDQ_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "MDQ_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_IQR,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalMDQ_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "MDQ_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_IQR,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales



TotalMDQ_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "MDQ_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_IQR,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalMDQ_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "MDQ_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MDQ_IQR,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 







```

# HRF Median

```{r, eval =  TRUE}


TotalHRF_Median_Sans_Tot_Df <- ModelsBySymptom(Name = "HRF_Median_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_Median,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalHRF_Median_Saps_Tot_Df <- ModelsBySymptom(Name = "HRF_Median_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_Median,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalHRF_Median_Flat_Df <- ModelsBySymptom(Name = "HRF_Median_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_Median,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalHRF_Median_Alogia_Df <- ModelsBySymptom(Name = "HRF_Median_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_Median,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalHRF_Median_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "HRF_Median_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_Median,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalHRF_Median_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "HRF_Median_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_Median,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalHRF_Median_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "HRF_Median_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_Median,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales



TotalHRF_Median_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "HRF_Median_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_Median,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalHRF_Median_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "HRF_Median_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_Median,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 







```


# HRF IQR

```{r, eval =  TRUE}


TotalHRF_IQR_Sans_Tot_Df <- ModelsBySymptom(Name = "HRF_IQR_Sans_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_IQR,
                                      Symptom = d_trial_SZ$Sans_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalHRF_IQR_Saps_Tot_Df <- ModelsBySymptom(Name = "HRF_IQR_Saps_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_IQR,
                                      Symptom = d_trial_SZ$Saps_Tot,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

# SANS subscales

TotalHRF_IQR_Flat_Df <- ModelsBySymptom(Name = "HRF_IQR_Sans_FlatAff",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_IQR,
                                      Symptom = d_trial_SZ$FlatAff_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalHRF_IQR_Alogia_Df <- ModelsBySymptom(Name = "HRF_IQR_Sans_Alogia",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_IQR,
                                      Symptom = d_trial_SZ$Alogia_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 



 
####    PANNS     ######

TotalHRF_IQR_Panss_Tot_Df <- ModelsBySymptomPannsSub(Name = "HRF_IQR_Panss_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_IQR,
                                      Symptom = d_trial_SZ$PANSS_Tot,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalHRF_IQR_Panss_Neg_Df <- ModelsBySymptomPannsSub(Name = "HRF_IQR_Panss_Neg",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_IQR,
                                      Symptom = d_trial_SZ$PANSS_Neg,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 

TotalHRF_IQR_Panss_Pos_Df <- ModelsBySymptomPannsSub(Name = "HRF_IQR_Panss_Pos",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_IQR,
                                      Symptom = d_trial_SZ$PANSS_Pos,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `positive symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")


 


# PANNS subscales



TotalHRF_IQR_PANNS_Blunt_Df <- ModelsBySymptomPannsSub(Name = "HRF_IQR_PANNS_Blunt",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_IQR,
                                      Symptom = d_trial_SZ$Blun_Aff_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")

 

TotalHRF_IQR_PANNS_Conv_Df <- ModelsBySymptomPannsSub(Name = "HRF_IQR_PANNS_Conv",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$HRF_IQR,
                                      Symptom = d_trial_SZ$Lack_Spont_Conv_PANNS,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")


 







```


# Analysis on medication and clinical and social features 

#Model definitions


```{r}



MedicationVoice_Language_f <-
  bf(Outcome ~ 0 + Language + Language : D2R +
       (1 | gr(NewID, by = group)))

#get_prior(SymptomVoice_Language_f, data)

MedicationVoice_Gender_f <-
  bf(Outcome ~ 0 + Language:Gender + Language:Gender:D2R +
       (1 | gr(NewID, by=group2)))

## Skeptic and informed priors are defined within the function



CPZVoice_Language_f <-
  bf(Outcome ~ 0 + Language + Language : CPZ +
       (1 | gr(NewID, by = group)))

FESVoice_Language_f <-
  bf(Outcome ~ 0 + Language + Language : FES +
       (1 | gr(NewID, by = group)))

CPZ_D2R_Voice_Language_f <-
  bf(Outcome ~ 0 + Language + Language : D2R + Language:D2R:CPZ +
       (1 | gr(NewID, by = group)))

DUIVoice_Language_f <-
  bf(Outcome ~ 0 + Language + Language : Ill_Dur +
       (1 | gr(NewID, by = group)))


SymptomVoice_Language_f <-
  bf(Outcome ~ 0 + Language + Language : mo(Symptom) +
       (1 | gr(NewID, by = Language)))


# Panns dimension only available for CH corpus (for now), thus I am using this formula below

SymptomVoice_PannsSub_f <-
  bf(Outcome ~ 0 + Language + Language : mo(Symptom) +
       (1 | gr(NewID, by = Language)))

#get_prior(SymptomVoice_Language_f, data)

SymptomVoice_Gender_f <-
  bf(Outcome ~ 0 + Language:Gender + Language:Gender:mo(Symptom) + (1 | gr(NewID, by=group2)))


SkepticPrior <- c(
  prior(normal(0, .5), class=b),
  prior(normal(0, .7), class=sd),
  prior(normal(0.3, 0.1), class = sigma)
)




```


# DeBoer et al. (2020)'s Informed Priors

```{r, eval = TRUE}

# Load DeBoer et al. (2020) data

d_med_prior <- as.data.frame(
  read_excel(here("data", "meta", "DeBoer_2020_Med_results.xlsx")))


# Extract effect size and se for the different features, and for different contrasts (HC_vs_HIGH_D2R, HC_vs_LOW_D2R, HIGH_D2R_vs_LOW_D2R )


for (i in seq(nrow(d_med_prior))){
  t<-d_med_prior[i,]
  #n<-dfm[i,]
  print(t$Name)
  meta=MetaAnalysisMed(d=t,
                      Name=t$Name,
                      NameContrast1 = "HC_vs_HIGH_D2R",
                      NameContrast2 = "HC_vs_HIGH_D2R",
                      NameContrast3 = "HC_vs_HIGH_D2R",
                      FeatureHIGH_D2R= "HIGH_D2R_Mean",
                      FeatureLOW_D2R= "LOW_D2R_Mean",
                      FeatureHC= "HC_D2R_Mean",
                      FeatureSDHIGH_D2= "HIGH_D2R_Sd",
                      FeatureSDLOW_D2= "LOW_D2R_Sd",
                      FeatureSDHC="HC_D2R_Sd")
}



```


# D2R Medication Analysis


```{r, eval = TRUE}




Pitch_Cova_Median_Trial_Med <- ModelsByMedication(Name = "Pitch_Cova_Median_Med",
                              data = d_trial,
                              Variable = d_trial$Pitch_Median,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")






Pitch_Cova_IQR_Trial_Med <- ModelsByMedication(Name = "Pitch_Cova_IQR_Med",
                              data = d_trial,
                              Variable = d_trial$Pitch_IQR,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")







SpeechRate_Trial_Med <- ModelsByMedication(Name = "SpeechRate_Med",
                              data = d_trial,
                              Variable = d_trial$Speech_Rate_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")





SpeechPercentagePraat_Trial_Med <- ModelsByMedication(Name = "SpeechPercentagePraat_Med",
                              data = d_trial,
                              Variable = d_trial$PercentSpoke_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = MA_Percentage_time_speaking,
                              Informed = TRUE,
                              level="Trial")



MeanPauseDurationPraat_Trial_Med <- ModelsByMedication(Name = "MeanPauseDurationPraat_Med",
                              data = d_trial,
                              Variable = d_trial$MeanPauseDur_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = MA_Pause_duration,
                              Informed = TRUE,
                              level="Trial")




MeanNumberPausesPraat_Trial_Med <- ModelsByMedication(Name = "MeanNumberPausesPraat_Med",
                              data = d_trial,
                              Variable = d_trial$PauseNumMin_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = MA_Pause_duration,
                              Informed = FALSE,
                              level="Trial")





MeanNumberTurnPraat_Trial_Med <- ModelsByMedication(Name = "MeanNumberTurnPraat_Med",
                              data = d_trial,
                              Variable = d_trial$TurnNumMin_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = MA_Pause_duration,
                              Informed = FALSE,
                              level="Trial")




MeanTurnDurationPraat_Trial_Med <- ModelsByMedication(Name = "MeanTurnDurationPraat_Med",
                              data = d_trial,
                              Variable = d_trial$MeanTurnDur_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = MA_Speaking_turn_duration,
                              Informed = TRUE,
                              level="Trial")






TotalNumberWords_Trial_Med <- ModelsByMedication(Name = "TotalNumberwords_Med",
                              data = d_trial,
                              Variable = d_trial$TotalNumberWords,
                              SkepticPrior = SkepticPrior,
                              MA_model = MA_Total_number_words,
                              Informed = TRUE,
                              level="Trial")




```



# CPZ


```{r, eval =TRUE}
 
# Pitch Median and IQR

Pitch_Cova_Median_Trial_CPZ<- ModelsByCPZ(Name = "Pitch_Cova_Median_CPZ",
                              data = d_trial_SZ,
                              Variable = d_trial_SZ$Pitch_Median,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")


Pitch_Cova_IQR_Trial_CPZ<- ModelsByCPZ(Name = "Pitch_Cova_IQR_CPZ",
                              data = d_trial_SZ,
                              Variable = d_trial_SZ$Pitch_IQR,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")




 
# Speech Rate

Speech_Rate_Praat_Trial_CPZ<- ModelsByCPZ(Name = "Speech_Rate_Praat_CPZ",
                              data = d_trial_SZ,
                              Variable = d_trial_SZ$Speech_Rate_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")



#  Speech Percentage


PercentSpoke_Praat_Trial_CPZ<- ModelsByCPZ(Name = "PercentSpoke_Praat_CPZ",
                              data = d_trial_SZ,
                              Variable = d_trial_SZ$PercentSpoke_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")



# Pause Duration 


MeanPauseDur_Praat_Trial_CPZ<- ModelsByCPZ(Name = "MeanPauseDur_Praat_CPZ",
                              data = d_trial_SZ,
                              Variable = d_trial_SZ$MeanPauseDur_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")
 



# Number of pauses

PauseNumMin_Praat_Trial_CPZ<- ModelsByCPZ(Name = "PauseNumMin_Praat_CPZ",
                              data = d_trial_SZ,
                              Variable = d_trial_SZ$PauseNumMin_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")



# Utterance Duration

MeanTurnDur_Praat_Trial_CPZ<- ModelsByCPZ(Name = "MeanTurnDur_Praat_CPZ",
                              data = d_trial_SZ,
                              Variable = d_trial_SZ$MeanTurnDur_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")



# Number of turn

TurnNumMin_Praat_Trial_CPZ<- ModelsByCPZ(Name = "TurnNumMin_Praat_CPZ",
                              data = d_trial_SZ,
                              Variable = d_trial_SZ$TurnNumMin_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")




# Number of words

NumbofWords_Praat_Trial_CPZ<- ModelsByCPZ(Name = "NumbofWords_CPZ",
                              data = d_trial_SZ,
                              Variable = d_trial_SZ$TotalNumberWords,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")






```

# Personal and social performance scale (PSP)


```{r, eval = FALSE}



TotalPitchMedian_PeSoPe_Df <- ModelsByPesope(Name = "Pitch_Median_PesoPe",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_Median,
                                      Symptom = d_trial_SZ$PeSoPe,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")





TotalPitchIQR_PeSoPe_Df <- ModelsByPesope(Name = "Pitch_IQR_PesoPe",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Pitch_IQR,
                                      Symptom = d_trial_SZ$PeSoPe,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")



TotalSpeech_Rate_Praat_Pesope_Df <- ModelsByPesope(Name = "Speech_Rate_Pesope",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$Speech_Rate_Praat,
                                      Symptom = d_trial_SZ$PeSoPe,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")



TotalPercentSpoke_Praat_Pesope_Tot_Df <- ModelsByPesope(Name = "PercentSpoke_Praat_Pesope_Tot",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PercentSpoke_Praat,
                                      Symptom = d_trial_SZ$PeSoPe,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and proportion of spoken time_BayesianPrior` ,
                                      Informed = FALSE,
                                      level="Trial")




TotalPauseDurPraat_PeSoPe_Df <- ModelsByPesope(Name = "Pitch_PauseDurPraat_PesoPe",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanPauseDur_Praat,
                                      Symptom = d_trial_SZ$PeSoPe,
                                      SkepticPrior = SkepticPrior,
                                      MA_model = `negative symptoms and mean pitch_BayesianPrior`,
                                      Informed = FALSE,
                                      level="Trial")




TotalPauseNumMinPraat_Pesope_Df <- ModelsByPesope(Name = "PauseNumMinPraat_Pesope",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$PauseNumMin_Praat,
                                      Symptom = d_trial_SZ$PeSoPe,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")





TotalMeanTurnDur_Praat_Pesope_Df <- ModelsByPesope(Name = "MeanTurnDur_Praat_Pesope",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$MeanTurnDur_Praat,
                                      Symptom = d_trial_SZ$PeSoPe,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")




TotalTurnNumMin_Praat_Pesope_Df <- ModelsByPesope(Name = "TurnNumMin_Praat__Pesope",
                                      data =  d_trial_SZ,
                                      Outcome = d_trial_SZ$TurnNumMin_Praat,
                                      Symptom = d_trial_SZ$PeSoPe,
                                      SkepticPrior = SkepticPrior,
                                      Informed = FALSE,
                                      level="Trial")




```

# Duration of Illness (DUI) analysis


```{r, eval = FALSE}


Pitch_Cova_Median_Trial_DUI<- ModelsByDUI(Name = "Pitch_Cova_Median_DUI",
                              data = d_trial_DUI,
                              Variable = d_trial_DUI$Pitch_Median,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")






Pitch_Cova_IQR_Trial_DUI <- ModelsByDUI(Name = "Pitch_Cova_IQR_DUI",
                              data = d_trial_DUI,
                              Variable = d_trial_DUI$Pitch_IQR,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")





# Speech Rate

Speech_Rate_Praat_Trial_DUI <- ModelsByDUI(Name = "Speech_Rate_Praat_DUI",
                              data = d_trial_DUI,
                              Variable = d_trial_DUI$Speech_Rate_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")




#  Speech Percentage


PercentSpoke_Praat_Trial_DUI<- ModelsByDUI(Name = "PercentSpoke_Praat_DUI",
                              data = d_trial_DUI,
                              Variable = d_trial_DUI$PercentSpoke_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")

ht




# Pause Duration 


MeanPauseDur_Praat_Trial_DUI<- ModelsByDUI(Name = "MeanPauseDur_Praat_DUI",
                              data = d_trial_DUI,
                              Variable = d_trial_DUI$MeanPauseDur_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")


# Number of pauses

PauseNumMin_Praat_Trial_DUI<- ModelsByDUI(Name = "PauseNumMin_Praat_DUI",
                              data = d_trial_DUI,
                              Variable = d_trial_DUI$PauseNumMin_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")



#  Turn Duration

MeanTurnDur_Praat_Trial_DUI<- ModelsByDUI(Name = "MeanTurnDur_Praat_DUI",
                              data = d_trial_DUI,
                              Variable = d_trial_DUI$MeanTurnDur_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")



# Number of turn

TurnNumMin_Praat_Trial_DUI<- ModelsByDUI(Name = "TurnNumMin_Praat_DUI",
                              data = d_trial_DUI,
                              Variable = d_trial_DUI$TurnNumMin_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Pitch_variability_Prior,
                              Informed = FALSE,
                              level="Trial")




```

# First-episode (FES) vs chronic patients  analysis


```{r, eval = FALSE, echo= FALSE}


## Pitch_Median



PitchMedianDf <- ModelsByFES(Name = "PitchMedian_FES",
                              data = d_trial_FES, 
                              Variable = d_trial_FES$Pitch_Median,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Pitch_mean_BayesianPrior, 
                              Informed = FALSE, 
                              level="Trial")




#Pitch IQR



Pitch_Cova_IQR_Trial <- ModelsByFES(Name = "Pitch_IQR_Cova_FES",
                              data = d_trial_FES, 
                              Variable = d_trial_FES$Pitch_IQR,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Pitch_variability_BayesianPrior, 
                              Informed = FALSE, 
                              level="Trial")



## Speech Rate




SpeechRateDf <- ModelsByFES(Name = "SpeechRate_FES",
                              data = d_trial_FES, 
                              Variable = d_trial_FES$Speech_Rate_Praat,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Speech_rate_BayesianPrior, 
                              Informed = FALSE, 
                              level="Trial")


## Speech Percentage



SpeechPercentagePraatDf <- ModelsByFES(Name = "SpeechPercentagePraat_FES",
                              data = d_trial_FES, 
                              Variable = d_trial_FES$PercentSpoke_Praat,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Proportion_of_spoken_time_BayesianPrior,
                              Informed = FALSE, 
                              level="Trial")




# Pause Duration




PauseDurationPraatDf <- ModelsByFES(Name = "MeanPauseuDurationPraat_FES",
                              data = d_trial_FES, 
                              Variable = d_trial_FES$MeanPauseDur_Praat,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Pause_duration_BayesianPrior, 
                              Informed = FALSE, 
                              level="Trial")




# Number of pauses




PauseNumberPraatDf <- ModelsByFES(Name = "PauseNumberMinPraat_FES",
                              data = d_trial_FES, 
                              Variable = d_trial_FES$PauseNumMin_Praat,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Number_of_pauses_BayesianPrior, 
                              Informed = FALSE, 
                              level="Trial")





# Turn Duration





TurnDurationPraatDf <- ModelsByFES(Name = "MeanTurnDurationPraat_FES",
                              data = d_trial_FES, 
                              Variable = d_trial_FES$MeanTurnDur_Praat,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Speech_duration_BayesianPrior, 
                              Informed = FALSE, 
                              level="Trial")




# Number of Turn




TurnNumMin_PraatDf <- ModelsByFES(Name = "TurnNumMin_PraatPraat_FES",
                              data = d_trial_FES,
                              Variable = d_trial_FES$TurnNumMin_Praat,
                              SkepticPrior = SkepticPrior,
                              MA_model = Number_of_pauses_BayesianPrior,
                              Informed = FALSE,
                              level="Trial")




```

#  Main functions

```{r}


brmsFun <- function(Name,
                    formula,
                    data,
                    family = gaussian,
                    prior = SkepticPrior,
                    iter = 10000,
                    path = "models",
                    stanvars = stanvar(placeholder, name = "placeholder")) {
 
  
  m <- brm(
    formula,
    data = data,
    family = family,
    iter = iter,
    chains = 2,
    cores = 2,
    prior = prior,
    sample_prior = T,
    file = paste0(path, "/",Name),
    control = list(adapt_delta = 0.99,
                   max_treedepth = 20),
    stanvars = stanvars,
  )
  
  m <- add_criterion(m, 
        criterion = c("loo", "bayes_R2"), 
        reloo = F, 
        file = paste0(path, "/",Name))
  
  return(m)
}



brmsFunMed <- function(Name,
                    formula,
                    data,
                    family = gaussian,
                    prior = SkepticPrior,
                    iter = 10000,
                    path = "models",
                    stanvars = stanvar(placeholder, name = "placeholder")) {
  

  m <- brm(
    formula,
    data = data,
    family = family,
    iter = iter,
    chains = 2,
    cores = 4,
    prior = prior,
    sample_prior = T,
    file = paste0(path, "/",Name),
    control = list(adapt_delta = 0.99,
                   max_treedepth = 20),
    stanvars = stanvars,
  )
  
  m <- add_criterion(m, 
                     criterion = c("loo", "bayes_R2"), 
                     reloo = F, 
                     file = paste0(path, "/",Name))
  
  return(m)
}



brmsFunStudent <- function(Name,
                    formula,
                    data,
                    family = student,
                    prior = SkepticPrior,
                    iter = 10000,
                    path = "models",
                    stanvars = stanvar(placeholder, name = "placeholder")) {
  
  
  m <- brm(
    formula,
    data = data,
    family = family,
    iter = iter,
    chains = 2,
    cores = 2,
    prior = prior,
    sample_prior = T,
    file = paste0(path, "/",Name),
    control = list(adapt_delta = 0.99,
                   max_treedepth = 20),
    stanvars = stanvars
  )
  
  m <- add_criterion(m, 
                     criterion = c("loo", "bayes_R2"), 
                     reloo = F, 
                     file = paste0(path, "/",Name))
  
  return(m)
}

ResultsByString <- function(hyp, ER01, rng = 1){
  
  hypString <- paste0(
    round(hyp$hypothesis$Estimate * rng,2),
    " (",
    round(hyp$hypothesis$CI.Lower * rng,2),
    " ",
    round(hyp$hypothesis$CI.Upper * rng,2),
    ") ER = ",
    round(hyp$hypothesis$Evid.Ratio,2)
  )
  if (hyp$hypothesis$Evid.Ratio < 3){
    hypString <- paste0(hypString, " ER01 = ", round(ER01,2))
  }
  
  return(hypString)
  
} 




PlotByDiagnosis <- function(mod, name){  

x <- pp_check(mod, ndraws = 100)
t <- ggtitle(paste0("posterior_check_", name))
plot(x + t)


plot(hypothesis(mod, "LanguageD > 0"))
plot(hypothesis(mod, "LanguageC > 0"))
plot(hypothesis(mod, "LanguageJ > 0"))
plot(hypothesis(mod, "LanguageD:DiagnosisSCZ > 0"))
plot(hypothesis(mod, "LanguageC:DiagnosisSCZ > 0"))
plot(hypothesis(mod, "LanguageJ:DiagnosisSCZ > 0"))


plot(hypothesis(mod, "Intercept:groupD0 > 0", class="sd", group="NewID"))
plot(hypothesis(mod, "Intercept:groupD1 > 0", class="sd", group="NewID"))
plot(hypothesis(mod, "Intercept:groupC0 > 0", class="sd", group="NewID"))
plot(hypothesis(mod, "Intercept:groupC1 > 0", class="sd", group="NewID"))
plot(hypothesis(mod, "Intercept:groupJ0 > 0", class="sd", group="NewID"))
plot(hypothesis(mod, "Intercept:groupJ1 > 0", class="sd", group="NewID"))



x <- posterior_samples(mod)
y <- ggplot(x) + 
  geom_density(aes(prior_sigma), color = "red")  +
  geom_density(aes(sigma), color = "blue") +
  theme_classic() 

z <-  ggtitle(paste0("sigma_", name))
plot(y + z)





}


PlotByMedication <- function(mod, name){ 
  
x <- pp_check(mod, ndraws = 100)
t <- ggtitle(paste0("posterior_check_", name))
plot(x + t)


plot(hypothesis(mod, "LanguageD > 0"))
plot(hypothesis(mod, "LanguageC > 0"))
#plot(hypothesis(mod, "LanguageJ > 0"))
plot(hypothesis(mod, "LanguageD:D2Rlow > 0"))
plot(hypothesis(mod, "LanguageC:D2Rlow > 0"))
plot(hypothesis(mod, "LanguageD:D2Rhigh > 0"))
plot(hypothesis(mod, "LanguageC:D2Rhigh > 0"))
#plot(hypothesis(mod, "LanguageJ:D2Rlow > 0"))

plot(hypothesis(mod, "Intercept:groupC0 > 0", class="sd", group="NewID"))
plot(hypothesis(mod, "Intercept:groupC1 > 0", class="sd", group="NewID"))
plot(hypothesis(mod, "Intercept:groupD0 > 0", class="sd", group="NewID"))
plot(hypothesis(mod, "Intercept:groupD1 > 0", class="sd", group="NewID"))
#plot(hypothesis(mod, "Intercept:groupJ0 > 0", class="sd", group="NewID"))
#plot(hypothesis(mod, "Intercept:groupJ1 > 0", class="sd", group="NewID"))

plot(conditional_effects(mod),
     points = T,
     ask =F)


x <- posterior_samples(mod)
y <- ggplot(x) + 
  geom_density(aes(prior_sigma), color = "red")  +
  geom_density(aes(sigma), color = "blue") +
  theme_classic() 

z <-  ggtitle(paste0("sigma_", name))
plot(y + z)





}



ModelsByDiagnosis <- function(Name = "PitchMedian",
                              data = d_trial, 
                              Variable = d_trial$Pitch_Median,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Pitch_mean_Prior,
                              Informed = FALSE, 
                              level = "Trial"){
 
  
  # Extracting Outcome variable
  
  data$Outcome <- Variable
  
  data <- data %>% 
    mutate(Outcome = Variable) %>%
    subset(!is.na(Outcome))
  
  data$Outcome[data$Language=="D"] <- scale(data$Outcome[data$Language=="D"])
  data$Outcome[data$Language=="C"] <- scale(data$Outcome[data$Language=="C"])
  data$Outcome[data$Language=="J"] <- scale(data$Outcome[data$Language=="J"])
  data$Outcome[data$Language=="G"] <- scale(data$Outcome[data$Language=="G"])
  
  
  
  # Fitting Models
 SkepticModelLanguage <- brmsFun(
    Name = paste0(Name, "_SkepticModel_", level),
    formula = Model_Language_f,
    prior = SkepticPrior,
    data = data, iter = 10000)

  
  
  print("Priors, summary and plots of the skeptic model")
  print(prior_summary(SkepticModelLanguage))
  print(summary(SkepticModelLanguage))
  PlotByDiagnosis(SkepticModelLanguage,"SkepticModel")
  
  
  SkepticModelGender <- brmsFun(
    Name = paste0(Name,"_SkepticModelGender_",level),
    formula = Model_Gender_f,
    data = data)
  
  
  SkepticModelAge <- brmsFun(
    Name = paste0(Name,"_SkepticModelAge_",level),
    formula = Model_Age_f,
    data = data)


  SkepticModelVerbIQ <- brmsFun(
    Name = paste0(Name,"_SkepticModelVerbIQ_",level),
    formula = Model_IQ_f,
    data = data)

  ## First we report the effect of diagnosis
  
  xDK <- hypothesis(SkepticModelLanguage,"LanguageD:DiagnosisSCZ > 0")
  xCH <- hypothesis(SkepticModelLanguage,"LanguageC:DiagnosisSCZ > 0")
  xJP <- hypothesis(SkepticModelLanguage,"LanguageJ:DiagnosisSCZ > 0")
  xGE <- hypothesis(SkepticModelLanguage,"LanguageG:DiagnosisSCZ > 0")
  
  
  if (xDK$hypothesis$Estimate < 0){
    xDK <- hypothesis(SkepticModelLanguage,"LanguageD:DiagnosisSCZ < 0")
  }
  if (xCH$hypothesis$Estimate < 0){
    xCH <- hypothesis(SkepticModelLanguage,"LanguageC:DiagnosisSCZ < 0")
  }
  if (xJP$hypothesis$Estimate < 0){
    xJP <- hypothesis(SkepticModelLanguage,"LanguageJ:DiagnosisSCZ < 0")
  }
  if (xGE$hypothesis$Estimate < 0){
    xGE <- hypothesis(SkepticModelLanguage,"LanguageG:DiagnosisSCZ < 0")
  }
  
  ER01DK = hypothesis(SkepticModelLanguage,"LanguageD:DiagnosisSCZ = 0")$hypothesis$Evid.Ratio
  ER01CH = hypothesis(SkepticModelLanguage,"LanguageC:DiagnosisSCZ = 0")$hypothesis$Evid.Ratio
  ER01JP = hypothesis(SkepticModelLanguage,"LanguageJ:DiagnosisSCZ = 0")$hypothesis$Evid.Ratio  
  ER01GE = hypothesis(SkepticModelLanguage,"LanguageG:DiagnosisSCZ = 0")$hypothesis$Evid.Ratio  
  
  SkepticDK_string <- ResultsByString(xDK, ER01DK)
  SkepticCH_string <- ResultsByString(xCH, ER01CH)
  SkepticJP_string <- ResultsByString(xJP, ER01JP)
  SkepticGE_string <- ResultsByString(xGE, ER01GE)
  
 
  
   #We then look at whether gender and age  moderators have an impact
  
    xDK <- hypothesis(SkepticModelGender,"LanguageD:GenderF:DiagnosisSCZ > LanguageD:GenderM:DiagnosisSCZ")
   if (xDK$hypothesis$Estimate < 0){
    xDK <- hypothesis(SkepticModelGender,"LanguageD:GenderF:DiagnosisSCZ < LanguageD:GenderM:DiagnosisSCZ")
  }
  ER01DK = hypothesis(SkepticModelGender,"LanguageD:GenderF:DiagnosisSCZ = LanguageD:GenderM:DiagnosisSCZ")$hypothesis$Evid.Ratio
  
  
  xCH <- hypothesis(SkepticModelGender,"LanguageC:GenderF:DiagnosisSCZ > LanguageC:GenderM:DiagnosisSCZ")
  if (xCH$hypothesis$Estimate < 0){
    xCH <- hypothesis(SkepticModelGender,"LanguageC:GenderF:DiagnosisSCZ < LanguageC:GenderM:DiagnosisSCZ")
  }
  ER01CH = hypothesis(SkepticModelGender,"LanguageC:GenderF:DiagnosisSCZ = LanguageC:GenderM:DiagnosisSCZ")$hypothesis$Evid.Ratio

  xJP <- hypothesis(SkepticModelGender,"LanguageJ:GenderF:DiagnosisSCZ > LanguageJ:GenderM:DiagnosisSCZ")
  if (xJP$hypothesis$Estimate < 0){
    xJP <- hypothesis(SkepticModelGender,"LanguageJ:GenderF:DiagnosisSCZ < LanguageJ:GenderM:DiagnosisSCZ")
  }
   ER01JP = hypothesis(SkepticModelGender,"LanguageJ:GenderF:DiagnosisSCZ = LanguageJ:GenderM:DiagnosisSCZ")$hypothesis$Evid.Ratio

   
   xGE <- hypothesis(SkepticModelGender,"LanguageG:GenderF:DiagnosisSCZ > LanguageG:GenderM:DiagnosisSCZ")
   if (xGE$hypothesis$Estimate < 0){
     xGE <- hypothesis(SkepticModelGender,"LanguageG:GenderF:DiagnosisSCZ < LanguageG:GenderM:DiagnosisSCZ")
   }
   ER01GE = hypothesis(SkepticModelGender,"LanguageG:GenderF:DiagnosisSCZ = LanguageG:GenderM:DiagnosisSCZ")$hypothesis$Evid.Ratio
   
   
  SkepticDK_Sex_string <- ResultsByString(xDK, ER01DK)
  SkepticCH_Sex_string <- ResultsByString(xCH, ER01CH)
  SkepticJP_Sex_string <- ResultsByString(xJP, ER01JP)
  SkepticGE_Sex_string <- ResultsByString(xGE, ER01GE)
  
  
  #Age

  xDK <- hypothesis(SkepticModelAge,"LanguageD:DiagnosisSCZ:Age > 0")
  if (xDK$hypothesis$Estimate < 0){
    xDK <- hypothesis(SkepticModelAge,"LanguageD:DiagnosisSCZ:Age < 0")
  }
  BF01DK = hypothesis(SkepticModelAge,"LanguageD:DiagnosisSCZ:Age = 0")$hypothesis$Evid.Ratio


  xCH <- hypothesis(SkepticModelAge,"LanguageC:DiagnosisSCZ:Age > 0")
  if (xCH$hypothesis$Estimate < 0){
    xCH <- hypothesis(SkepticModelAge,"LanguageC:DiagnosisSCZ:Age < 0")
  }
  BF01CH = hypothesis(SkepticModelAge,"LanguageC:DiagnosisSCZ:Age = 0")$hypothesis$Evid.Ratio


  xJP <- hypothesis(SkepticModelAge,"LanguageJ:DiagnosisSCZ:Age > 0")
  if (xJP$hypothesis$Estimate < 0){
    xJP <- hypothesis(SkepticModelAge,"LanguageJ:DiagnosisSCZ:Age < 0")
  }
  BF01JP = hypothesis(SkepticModelAge,"LanguageJ:DiagnosisSCZ:Age = 0")$hypothesis$Evid.Ratio


  xGE <- hypothesis(SkepticModelAge,"LanguageG:DiagnosisSCZ:Age > 0")
  if (xGE$hypothesis$Estimate < 0){
    xGE <- hypothesis(SkepticModelAge,"LanguageG:DiagnosisSCZ:Age < 0")
  }
  BF01GE = hypothesis(SkepticModelAge,"LanguageG:DiagnosisSCZ:Age = 0")$hypothesis$Evid.Ratio


  SkepticDK_Age_string <- ResultsByString(xDK, BF01DK)
  SkepticCH_Age_string <- ResultsByString(xCH, BF01CH)
  SkepticJP_Age_string <- ResultsByString(xJP, BF01JP)
  SkepticGE_Age_string <- ResultsByString(xGE, BF01GE)

  # IQ


  xDK <- hypothesis(SkepticModelVerbIQ,"LanguageD:DiagnosisSCZ:VerbIQ > 0")
  if (xDK$hypothesis$Estimate < 0){
    xDK <- hypothesis(SkepticModelVerbIQ,"LanguageD:DiagnosisSCZ:VerbIQ < 0")
  }
  BF01DK = hypothesis(SkepticModelVerbIQ,"LanguageD:DiagnosisSCZ:VerbIQ = 0")$hypothesis$Evid.Ratio


  xCH <- hypothesis(SkepticModelVerbIQ,"LanguageC:DiagnosisSCZ:VerbIQ > 0")
  if (xCH$hypothesis$Estimate < 0){
    xCH <- hypothesis(SkepticModelVerbIQ,"LanguageC:DiagnosisSCZ:VerbIQ < 0")
  }
  BF01CH = hypothesis(SkepticModelVerbIQ,"LanguageC:DiagnosisSCZ:VerbIQ = 0")$hypothesis$Evid.Ratio


  xJP <- hypothesis(SkepticModelVerbIQ,"LanguageJ:DiagnosisSCZ:VerbIQ > 0")
  if (xJP$hypothesis$Estimate < 0){
    xJP <- hypothesis(SkepticModelVerbIQ,"LanguageJ:DiagnosisSCZ:VerbIQ < 0")
  }
  BF01JP = hypothesis(SkepticModelVerbIQ,"LanguageJ:DiagnosisSCZ:VerbIQ = 0")$hypothesis$Evid.Ratio


  xGE <- hypothesis(SkepticModelVerbIQ,"LanguageG:DiagnosisSCZ:VerbIQ > 0")
  if (xGE$hypothesis$Estimate < 0){
    xGE <- hypothesis(SkepticModelVerbIQ,"LanguageG:DiagnosisSCZ:VerbIQ < 0")
  }
  BF01GE = hypothesis(SkepticModelVerbIQ,"LanguageG:DiagnosisSCZ:VerbIQ = 0")$hypothesis$Evid.Ratio


  SkepticDK_VerbIQ_string <- ResultsByString(xDK, BF01DK)
  SkepticCH_VerbIQ_string <- ResultsByString(xCH, BF01CH)
  SkepticJP_VerbIQ_string <- ResultsByString(xJP, BF01JP)
  SkepticGE_VerbIQ_string <- ResultsByString(xGE, BF01GE)

 
   
  ## Now onto making a table with the results  
  
  HypTable <- data.frame(
    Labels = c("", 
               paste0(Name, "_", level), 
               "Skeptical DK", 
               "Skeptical CH", 
               "Skeptical JP",
               "Skeptical GE"), #, "MA", "Informed DK", "Informed CH"
    Diagnosis = c ("Group (SCZ - CT)", 
                   "", 
                   SkepticDK_string,  
                   SkepticCH_string, 
                   SkepticJP_string, 
                   SkepticGE_string),
     Sex = c ("Biological sex (M - F)", 
              "", 
              SkepticDK_Sex_string, 
              SkepticCH_Sex_string,
              SkepticJP_Sex_string, 
              SkepticGE_Sex_string),
     Age = c ("Age",
             "",
              SkepticDK_Age_string,
              SkepticCH_Age_string,
              SkepticJP_Age_string,
              SkepticGE_Age_string),
     IQ = c ("IQ",
             "",
             SkepticDK_VerbIQ_string,
             SkepticCH_VerbIQ_string,
             SkepticJP_VerbIQ_string,
             SkepticGE_VerbIQ_string)
    
  )
  
  
  
  
  if (Informed) {
    
    gc()
    
    MA <- MA_Bayesreport(MA_model)
    MA_string <- paste0(MA$Mean, " (", MA$CI_l, " ", MA$CI_u, ")")
    
    xm <- MA$Mean
    xs <- MA$Sd
    
    InformedPrior <- c(
      prior(normal(xm, xs), class = b),
      prior(normal(0, .7), class = sd) ,
      prior(normal(0, .5), class = b, coef = LanguageD),
      prior(normal(0, .5), class = b, coef = LanguageC),
      prior(normal(0, .5), class = b, coef = LanguageJ),
      prior(normal(0, .5), class = b, coef = LanguageG),
      prior(normal(0.3, 0.1), class = sigma)
    )
    
    stanvars <- stanvar(xm, name = 'xm') + stanvar(xs, name = 'xs')
    
    InformedModel <-
      brmsFun(
        Name = paste0(Name, "_InformedModel_", level),
        formula = Model_Language_f,
        data = data,
        prior = InformedPrior,
        stanvars = stanvars
      )
    
    print("Priors, summary and plots of the informed model")
    print(summary(InformedModel))
    print(prior_summary(InformedModel))
    PlotByDiagnosis(InformedModel, "InformedModel")

    print("Model comparison with the skeptic model")
    print(loo_compare(SkepticModelLanguage, InformedModel))
    print(loo_model_weights(SkepticModelLanguage, InformedModel))

    
    
    ## First we report the effect of diagnosis
    xDK <- hypothesis(InformedModel, "LanguageD:DiagnosisSCZ > 0")
    xCH <- hypothesis(InformedModel, "LanguageC:DiagnosisSCZ > 0")
    xJP <- hypothesis(InformedModel, "LanguageJ:DiagnosisSCZ > 0")
    xGE <- hypothesis(InformedModel, "LanguageG:DiagnosisSCZ > 0")
    
    if (xDK$hypothesis$Estimate < 0) {
      xDK <- hypothesis(InformedModel, "LanguageD:DiagnosisSCZ < 0")
    }
    if (xCH$hypothesis$Estimate < 0) {
      xCH <- hypothesis(InformedModel, "LanguageC:DiagnosisSCZ < 0")
    }
    if (xJP$hypothesis$Estimate < 0) {
      xJP <- hypothesis(InformedModel, "LanguageJ:DiagnosisSCZ < 0")
    }
    if (xGE$hypothesis$Estimate < 0) {
      xGE <- hypothesis(InformedModel, "LanguageG:DiagnosisSCZ < 0")
    }
    
    ER01DK = hypothesis(InformedModel, "LanguageD:DiagnosisSCZ = 0")$hypothesis$Evid.Ratio
    ER01CH = hypothesis(InformedModel, "LanguageC:DiagnosisSCZ = 0")$hypothesis$Evid.Ratio
    ER01JP = hypothesis(InformedModel, "LanguageJ:DiagnosisSCZ = 0")$hypothesis$Evid.Ratio
    ER01GE = hypothesis(InformedModel, "LanguageG:DiagnosisSCZ = 0")$hypothesis$Evid.Ratio
    
    InformedDK_string <- ResultsByString(xDK, ER01DK)
    InformedCH_string <- ResultsByString(xCH, ER01CH)
    InformedJP_string <- ResultsByString(xJP, ER01JP)
    InformedGE_string <- ResultsByString(xGE, ER01GE)
    
  
    
    HypTable <- data.frame(
         Labels = c(
           "",
           paste0(Name, "_", level),
           "MA Priors",
           "Skeptical DK",
           "Skeptical CH",
           "Skeptical JP",
           "Skeptical GE",
           "Informed DK",
           "Informed CH",
           "Informed JP",
           "Informed GE"
         ),
        
         Diagnosis = c (
           "Group (SCZ - CT)",
           "",
           MA_string,
           SkepticDK_string,
           SkepticCH_string,
           SkepticJP_string,
           SkepticGE_string,
           InformedDK_string,
           InformedCH_string,
           InformedJP_string,
           InformedGE_string          
         )
         ,
         Sex = c (
           "Biological sex (M - F)",
           "",
           "",
           SkepticDK_Sex_string,
           SkepticCH_Sex_string,
           SkepticJP_Sex_string,
           SkepticGE_Sex_string,
           "NA", "NA", "NA", "NA"
         ),
         Age = c ("Age",
                  "",
                  "",
                  SkepticDK_Age_string,
                  SkepticCH_Age_string,
                  SkepticJP_Age_string,
                  SkepticGE_Age_string,
                  "NA", "NA", "NA", "NA"),
         IQ = c ("IQ",
                 "",
                 "",
                 SkepticDK_VerbIQ_string,
                 SkepticCH_VerbIQ_string,
                 SkepticJP_VerbIQ_string,
                 SkepticGE_VerbIQ_string,
                 "NA", "NA", "NA", "NA")
         
    )
    


# Plots
    
    post <- posterior_samples(SkepticModelLanguage) %>%
      select(
        SkepticPrior = prior_b,
        SkepticDK = "b_LanguageD:DiagnosisSCZ",
        SkepticCH = "b_LanguageC:DiagnosisSCZ",
        SkepticJP = "b_LanguageJ:DiagnosisSCZ",
        SkepticGE = "b_LanguageG:DiagnosisSCZ"
      )
    
    post1 <- posterior_samples(InformedModel) %>%
      select(
        InformedPrior = "prior_b_LanguageD:DiagnosisSCZ",
        InformedDK = "b_LanguageD:DiagnosisSCZ",
        InformedCH = "b_LanguageC:DiagnosisSCZ",
        InformedJP = "b_LanguageJ:DiagnosisSCZ",
        InformedGE = "b_LanguageG:DiagnosisSCZ"
      )
    
    post2 <- cbind(post, post1) %>%
      gather(parameter, value, SkepticPrior:InformedGE, factor_key = TRUE)
    
       
    post2$parameter <- factor( post2$parameter , levels = c("SkepticDK", "InformedDK", "SkepticCH", "InformedCH", "SkepticJP", "InformedJP", "SkepticGE", "InformedGE", "SkepticPrior", "InformedPrior"))
    
  
    
    CompPlot <- ggplot(post2, aes(value, parameter)) +
      geom_density_ridges() +
      geom_vline(xintercept = 0, linetype = "dashed") + 
      scale_fill_cyclical(values = c("blue", "green"))

    
      print(CompPlot)
    
    

    
    PriorPlot <- post2 %>%
      subset(parameter %in% c("InformedPrior", "SkepticPrior")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    DanishPlot <- post2 %>%
      subset(parameter %in% c("InformedDK", "SkepticDK")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    ChinesePlot <- post2 %>%
      subset(parameter %in% c("InformedCH", "SkepticCH")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    JapanesePlot <- post2 %>%
      subset(parameter %in% c("InformedJP", "SkepticJP")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    GermanPlot <- post2 %>%
      subset(parameter %in% c("InformedGE", "SkepticGE")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    #library(patchwork)
    x <- PriorPlot / DanishPlot / ChinesePlot / JapanesePlot / GermanPlot
    print(x)
    
    

    
  }
  

  
  print("Estimates in a table")
  formattable(HypTable)

  return(HypTable)

  
}




brmsFunSym<-function(Name, formula, data, family = gaussian, 
                     prior = SkepticPrior, iter = 6000, 
                     path="C:/Users/Alberto/Desktop/model/symptoms",
                     stanvars = stanvar(placeholder, name = "placeholder")){
  m <- brm(formula, 
           data = data,
           family = family,
           iter = iter, 
           chains=2, 
           cores = 2,
           backend = "cmdstanr",
           threads = threading(2),
           prior = prior,
           sample_prior = T,
           file = paste0(path, "/", Name),
           control= list(adapt_delta = 0.99,
                         max_treedepth = 20),
           stanvars = stanvars
  )
  
  
  m <- add_criterion(m, 
                     criterion = c("loo", "bayes_R2"), 
                     reloo = F, 
                     file = paste0(path, "/",Name))
  return(m)
}





PlotBySymtpom <- function(mod, name){
  
  #posterior check
  x <- pp_check(mod, ndraws = 100)
  t <- ggtitle(paste0("posterior_check_", name))
  plot(x + t)
  
  
  # plot hypothesis
  plot(hypothesis(mod, "LanguageD > 0"))
  plot(hypothesis(mod, "LanguageC > 0"))
  plot(hypothesis(mod, "LanguageD:moSymptom > 0", class="bsp"))
  plot(hypothesis(mod, "LanguageC:moSymptom > 0", class="bsp"))
  plot(hypothesis(mod, "Intercept:LanguageC > 0", class="sd", group="NewID"))
  plot(hypothesis(mod, "Intercept:LanguageD > 0", class="sd", group="NewID"))
  plot(hypothesis(mod, "sigma > 0", class=NULL))
  
  
  #Visualization
  
  conditional_effects(mod)
  plot(conditional_effects(mod),
       points = T, ask = F)
 
  #sigma
  x <- posterior_samples(mod)
  ggplot(x) + 
    geom_density(aes(prior_sigma), color = "red")  +
    geom_density(aes(sigma), color = "blue") +
    theme_classic() + ggtitle(paste0("sigma_", name))

  
}



ModelsBySymptom <- function(Name = "TotalPitchMedian",
                            data = d_trial_SZ,
                            Outcome = d_trial_SZ$PitchMedianS,
                            Symptom = d_trial_SZ$AdosTotal,
                            SkepticPrior = SkepticPrior,
                            MA_model = PitchMean_BayesianPrior,
                            Informed = TRUE,
                            level = "Trial") {


  

  
  # Extracting Outcome variable
  
  data$Outcome <- Outcome
  
  data$Outcome[data$Language == "D"] <- (data$Outcome[data$Language == "D"] - min(data$Outcome[data$Language == "D"], na.rm = T))
  
  
  data$Outcome[data$Language == "D"] <- data$Outcome[data$Language == "D"] / (max(data$Outcome[data$Language == "D"], na.rm = TRUE))
  
  
  data$Outcome[data$Language == "C"] <- (data$Outcome[data$Language == "C"] - min(data$Outcome[data$Language == "C"], na.rm = T))
  
  
  data$Outcome[data$Language == "C"] <- data$Outcome[data$Language == "C"] / (max(data$Outcome[data$Language == "C"], na.rm = TRUE))
  
  
  data$Outcome[data$Language == "J"] <- (data$Outcome[data$Language == "J"] - min(data$Outcome[data$Language == "J"], na.rm = T))
  
  
  data$Outcome[data$Language == "J"] <- data$Outcome[data$Language == "J"] / (max(data$Outcome[data$Language == "J"], na.rm = TRUE))
  
  
  
  data$Outcome[data$Language == "G"] <- (data$Outcome[data$Language == "G"] - min(data$Outcome[data$Language == "G"], na.rm = T))
  
  
  data$Outcome[data$Language == "G"] <- data$Outcome[data$Language == "G"] / (max(data$Outcome[data$Language == "G"], na.rm = TRUE))
  
 
  
  data$Symptom <- Symptom
  data$Symptom <- as.integer(data$Symptom)
  data <- data %>% subset(!is.na(Symptom) & !is.na(Outcome)) %>%
    mutate(Language = as.factor(as.character(Language)))
  
  ## Priors
  rng <- range(data$Symptom, na.rm = T)[2]
  
  # adjust prior
  
  xm = (.3 / rng) * 2
  
  
  if ("D" %in% unique(data$Language)){
    SkepticPrior <- c(prior(normal(0.5, .3), class = b),
                       prior(normal(0, xm), class=b, coef = "LanguageD:moSymptom"),
                       prior(normal(0, .1), class = sd),
                       prior(normal(0.3, 0.1), class = sigma))
  }
  if ("C" %in% unique(data$Language)){
    SkepticPrior <- c(prior(normal(0.5, .3), class = b),
                       prior(normal(0, xm), class=b, coef = "LanguageC:moSymptom"),
                       prior(normal(0, .1), class = sd),
                       prior(normal(0.3, 0.1), class = sigma))
  }
  if ("D" %in% unique(data$Language) & "C" %in% unique(data$Language)){
    SkepticPrior <- c(prior(normal(0.5, .3), class = b),
                       prior(normal(0, xm), class=b, coef = "LanguageD:moSymptom"),
                       prior(normal(0, xm), class=b, coef = "LanguageC:moSymptom"),
                       prior(normal(0, .1), class = sd),
                       prior(normal(0.3, 0.1), class = sigma))
  }
  


  
  
  
  
  stanvars <-
    stanvar(xm, name = 'xm')
  
  

  SkepticModelLanguage <-
    brmsFunSym(
      Name = paste0(Name, "_SkepticModel", level),
      formula = SymptomVoice_Language_f,
      data = data,
      prior = SkepticPrior,
      stanvars = stanvars
    )
  
  print("Priors, summary and plots of the skeptic model")
  print(prior_summary(SkepticModelLanguage))
  print(summary(SkepticModelLanguage))
 
  PlotBySymtpom(SkepticModelLanguage, "Skeptic_model")

  
  
  

  ## First we report the effect of diagnosis
  xDK <- hypothesis(SkepticModelLanguage, "LanguageD:moSymptom > 0", class = "bsp")
  xCH <- hypothesis(SkepticModelLanguage, "LanguageC:moSymptom > 0", class = "bsp")
  
  if (xDK$hypothesis$Estimate < 0) {
    xDK <- hypothesis(SkepticModelLanguage, "LanguageD:moSymptom < 0", class = "bsp")
  }
  
  if (xCH$hypothesis$Estimate < 0) {
    xCH <- hypothesis(SkepticModelLanguage, "LanguageC:moSymptom < 0", class = "bsp")
  }
  
  ER01DK = hypothesis(SkepticModelLanguage, "LanguageD:moSymptom = 0", class =
                        "bsp")$hypothesis$Evid.Ratio
  ER01CH = hypothesis(SkepticModelLanguage, "LanguageC:moSymptom = 0", class =
                        "bsp")$hypothesis$Evid.Ratio
  
  SkepticDK_string <- ResultsByString(xDK, ER01DK, rng = rng)
  SkepticCH_string <- ResultsByString(xCH, ER01CH, rng = rng)
  
  # DK > CH
  x1 <- hypothesis(SkepticModelLanguage,
               "LanguageD:moSymptom > LanguageC:moSymptom",
               class = "bsp")
  if (x1$hypothesis$Estimate < 0) {
    x1 <-
      hypothesis(SkepticModelLanguage,
                 "LanguageD:moSymptom < LanguageC:moSymptom",
                 class = "bsp")
  }
  ER01 = hypothesis(SkepticModelLanguage,
                    "LanguageD:moSymptom = LanguageC:moSymptom",
                    class = "bsp")$hypothesis$Evid.Ratio
  
  
  
  HypTable <- data.frame(
    Labels = c("", Name, "Skeptical DK", 
               "Skeptical CH"
               ),
    Diagnosis = c (
      "Group (SCZ - CT)",
      "",
      SkepticDK_string,
      SkepticCH_string

    )

  )
  
  
  if (Informed) {
    

    
    MA <- MA_Bayesreport(MA_model)
    
    MA_string <-
      paste0(MA$Mean, " (", MA$CI_l, " ", MA$CI_u, ")")
    
    xm <- MA$Mean
    xs <- MA$Sd
    xm2 <- xm / rng
    xs2 <- (xs / rng) * 3
    
    InformedPrior <- c(
      prior(normal(xm2, xs2), class = b),
      prior(normal(0, 0.1), class = sd) ,
      prior(normal(0.5, .3), class = b, coef = LanguageD),
      prior(normal(0.5, .3), class = b, coef = LanguageC),
      prior(normal(0, .3), class = sigma)
    )
    
    stanvars <-
      stanvar(xm2, name = 'xm2') + stanvar(xs2, name = 'xs2')
    
    InformedModelLanguage <-
      brmsFunSym(
        Name = paste0(Name, "_InformedModel_", level),
        formula = SymptomVoice_Language_f,
        data = data,
        prior = InformedPrior,
        stanvars = stanvars
      )
    

    

    print("Priors, summary and plots of the informed model")
    print(prior_summary(InformedModelLanguage))
    print(summary(InformedModelLanguage))

    PlotBySymtpom(InformedModelLanguage, "Informed_model")
    
    
    # Model comparison
    
    
    print("Model comparison with the skeptic model")
    print(loo_compare(SkepticModelLanguage, InformedModelLanguage))
    print(loo_model_weights(SkepticModelLanguage, InformedModelLanguage))
    
    str_weight <- loo_model_weights(SkepticModelLanguage, InformedModelLanguage)
    
    sw <- data.frame(round(str_weight[1],3), round(str_weight[2],3))
    
    if (sw[1] > sw[2]){
      str_w <- paste0("Skeptic Model ", sw$round.str_weight.1...3., ".00")
    } else {
      str_w <- paste0("Informed Model ", sw$round.str_weight.2...3., ".00")
    }
    

    ## First we report the effect of diagnosis
    
    xDK <- hypothesis(InformedModelLanguage, "LanguageD:moSymptom > 0", class = "bsp")
    xCH <- hypothesis(InformedModelLanguage, "LanguageC:moSymptom > 0", class = "bsp")
    
    if (xDK$hypothesis$Estimate < 0) {
      xDK <- hypothesis(InformedModelLanguage, "LanguageD:moSymptom < 0", class = "bsp")
    }
    if (xCH$hypothesis$Estimate < 0) {
      xCH <- hypothesis(InformedModelLanguage, "LanguageC:moSymptom < 0", class = "bsp")
    }
    
    ER01DK = hypothesis(InformedModelLanguage, "LanguageD:moSymptom = 0", class =
                          "bsp")$hypothesis$Evid.Ratio
    ER01CH = hypothesis(InformedModelLanguage, "LanguageC:moSymptom = 0", class =
                          "bsp")$hypothesis$Evid.Ratio
    
    InformedDK_string <- ResultsByString(xDK, ER01DK, rng = rng)
    InformedCH_string <- ResultsByString(xCH, ER01CH, rng = rng)

    
    HypTable <- data.frame(
      Labels = c(
        "",
        Name,
        "MA Priors",
        "Skeptical DK",
        "Skeptical CH",
        "Informed DK",
        "Informed CH",
        "Stacking weight"
      ),
      Diagnosis = c (
        "Group (SCZ - CT)",
        "",
        MA_string,
        SkepticDK_string,
        SkepticCH_string,
        InformedDK_string,
        InformedCH_string,
        str_w
      )
    )
    
    # Plots
    # print("Fixed effects informed rng")
    
    InformedPlotDK <-
    plot(hypothesis(InformedModelLanguage, "LanguageD:moSymptom > 0", class =
                      "bsp"))[[1]] +
    xlim(-1, 1) + ylim(0, 7) +
    theme_classic() +
    geom_vline(xintercept = 0,
               linetype = "dotted",
               color = "blue") +
    ggtitle(Name) +
    theme(plot.title = element_text(hjust = 0.5))

    ggsave(
    plot = InformedPlotDK,
    file = here("plots", paste0(
      Name, "_InformedPlot_DK_", level, ".svg"
    )),
    units = "cm",
    height = 7,
    width = 12
    )

    InformedPlotCH <-
    plot(hypothesis(InformedModelLanguage, "LanguageC:moSymptom > 0", class =
                      "bsp"))[[1]] +
    xlim(-1, 1) + ylim(0, 7) +
    theme_classic() +
    geom_vline(xintercept = 0,
                linetype = "dotted",
              color = "blue") +
    ggtitle(Name) +
    theme(plot.title = element_text(hjust = 0.5))

    ggsave(
     plot = InformedPlotCH,
    file = here("plots", paste0(
      Name, "_InformedPlot_CH_", level, ".svg"
    )),
    units = "cm",
    height = 7,
    width = 12
    )

    post <- posterior_samples(SkepticModelLanguage) %>%
      select(
        SkepticPrior = "prior_bsp_LanguageD:moSymptom",
        SkepticDK = "bsp_LanguageD:moSymptom",
        SkepticCH = "bsp_LanguageC:moSymptom"
        #     SkepticJP = "b_LanguageJ:MoSymptom"
      )

    post1 <-
      posterior_samples(InformedModelLanguage) %>%
      select(
        InformedPrior = "prior_bsp",
        InformedDK = "bsp_LanguageD:moSymptom",
        InformedCH = "bsp_LanguageC:moSymptom"
        #      InformedJP = "b_LanguageJ:moSymptom"
      )

    post2 <- cbind(post, post1) %>%
      gather(parameter,
             value,
             SkepticPrior:InformedCH,
             factor_key = TRUE)

    PriorPlot <- post2 %>%
      subset(parameter %in% c("InformedPrior", "SkepticPrior")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-0.2,0.2) +
      ylim(0, 80) +
      theme_classic()


    DanishPlot <- post2 %>%
      subset(parameter %in% c("InformedDK", "SkepticDK")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-0.05,0.05) +
      ylim(0, 700) +
      theme_classic()

    ChinesePlot <- post2 %>%
      subset(parameter %in% c("InformedCH", "SkepticCH")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-0.1,0.1) +
      ylim(0, 200) +
      theme_classic()

    x <- PriorPlot / DanishPlot / ChinesePlot
    print(x)

    CompPlot <- ggplot(post2, aes(value, parameter)) +
      geom_density_ridges() +
      geom_vline(xintercept = 0, linetype = "dashed") +
      theme_classic()
    print(CompPlot)
    
    
  }
  
  print("Hypothesis testing")
  formattable(HypTable)
  assign("ht", ht, envir = .GlobalEnv)

  return(HypTable)
}



ModelsBySymptomPannsSub <- function(Name = "TotalPitchMedian",
                            data = d_trial_SZ,
                            Outcome = d_trial_SZ$PitchMedianS,
                            Symptom = d_trial_SZ$AdosTotal,
                            SkepticPrior = SkepticPrior,
                            MA_model = PitchMean_Prior,
                            Informed = TRUE,
                            level = "Trial") {
  

  
  # Extracting Outcome variable
  data$Outcome <- Outcome
  
  data$Outcome[data$Language == "D"] <- (data$Outcome[data$Language == "D"] - min(data$Outcome[data$Language == "D"], na.rm = T))
  
  
  data$Outcome[data$Language == "D"] <- data$Outcome[data$Language == "D"] / (max(data$Outcome[data$Language == "D"], na.rm = TRUE))
  
  
  data$Outcome[data$Language == "C"] <- (data$Outcome[data$Language == "C"] - min(data$Outcome[data$Language == "C"], na.rm = T))
  
  
  data$Outcome[data$Language == "C"] <- data$Outcome[data$Language == "C"] / (max(data$Outcome[data$Language == "C"], na.rm = TRUE))
  
  
  data$Outcome[data$Language == "J"] <- (data$Outcome[data$Language == "J"] - min(data$Outcome[data$Language == "J"], na.rm = T))
  
  
  data$Outcome[data$Language == "J"] <- data$Outcome[data$Language == "J"] / (max(data$Outcome[data$Language == "J"], na.rm = TRUE))
  
  
  
  data$Outcome[data$Language == "G"] <- (data$Outcome[data$Language == "G"] - min(data$Outcome[data$Language == "G"], na.rm = T))
  
  
  data$Outcome[data$Language == "G"] <- data$Outcome[data$Language == "G"] / (max(data$Outcome[data$Language == "G"], na.rm = TRUE))
  
  
 

  data$Symptom <- Symptom
  data$Symptom <- as.integer(data$Symptom)
  data <- data %>% subset(!is.na(Symptom) & !is.na(Outcome)) %>%
    mutate(Language = as.factor(as.character(Language)))
  
  ## Priors
  rng <- range(data$Symptom, na.rm = T)[2]
  
  # adjust prior
  xm = (.3 / rng) * 2

  
  stanvars <-
    stanvar(xm, name = 'xm')
  
  
  if ("C" %in% unique(data$Language)){
    SkepticPrior <- c(prior(normal(0.5, .3), class = b),
                      prior(normal(0, xm), class=b, coef = "moSymptom"),
                      prior(normal(0, .1), class = sd),
                      prior(normal(0.3, 0.1), class = sigma))}
  
  
  
  if ("J" %in% unique(data$Language)){
    SkepticPrior <- c(prior(normal(0.5, .3), class = b),
                      prior(normal(0, xm), class=b, coef = "moSymptom"),
                      prior(normal(0, .1), class = sd),
                      prior(normal(0.3, 0.1), class = sigma))}
  
  
  
  if ("G" %in% unique(data$Language)){
    SkepticPrior <- c(prior(normal(0.5, .3), class = b),
                      prior(normal(0, xm), class=b, coef = "moSymptom"),
                      prior(normal(0, .1), class = sd),
                      prior(normal(0.3, 0.1), class = sigma))}
  
  
  if ("C" %in% unique(data$Language) & "G" %in% unique(data$Language)){
    SkepticPrior <- c(prior(normal(0.5, .3), class = b),
                      prior(normal(0, xm), class=b, coef = "LanguageC:moSymptom"),
                      prior(normal(0, xm), class=b, coef = "LanguageG:moSymptom"),
                      prior(normal(0, .1), class = sd),
                      prior(normal(0.3, 0.1), class = sigma))
  }
  
  
  
  if ("C" %in% unique(data$Language) & "J" %in% unique(data$Language) & "G" %in% unique(data$Language)){
    SkepticPrior <- c(prior(normal(0.5, .3), class = b),
                      prior(normal(0, xm), class=b, coef = "LanguageC:moSymptom"),
                      prior(normal(0, xm), class=b, coef = "LanguageJ:moSymptom"),
                      prior(normal(0, xm), class=b, coef = "LanguageG:moSymptom"),
                      prior(normal(0, .1), class = sd),
                      prior(normal(0.3, 0.1), class = sigma))
  }
  
  


  # Fitting Models

  SkepticModelLanguage <-
    brmsFunSym(
      Name = paste0(Name, "_SkepticModel", level),
      formula = SymptomVoice_PannsSub_f,
      data = data,
      prior = SkepticPrior,
      stanvars = stanvars
    )
  
  print("Priors, summary and plots of the skeptic model")
  print(prior_summary(SkepticModelLanguage))
  print(summary(SkepticModelLanguage))


  
  ## First we report the effect of diagnosis

  if ("C" %in% unique(data$Language) & "G" %in% unique(data$Language)){
    
    
    xCH <- hypothesis(SkepticModelLanguage, "LanguageC:moSymptom > 0", class = "bsp")
    xGE <- hypothesis(SkepticModelLanguage, "LanguageG:moSymptom > 0", class = "bsp")
    
    if (xCH$hypothesis$Estimate < 0) {
      xCH <- hypothesis(SkepticModelLanguage, "LanguageC:moSymptom < 0", class = "bsp")
    }
    
    
    if (xGE$hypothesis$Estimate < 0) {
      xGE <- hypothesis(SkepticModelLanguage, "LanguageG:moSymptom < 0", class = "bsp")
    }
    
    
    
    
    ER01CH = hypothesis(SkepticModelLanguage, "LanguageC:moSymptom = 0", class =
                          "bsp")$hypothesis$Evid.Ratio
    ER01GE = hypothesis(SkepticModelLanguage, "LanguageG:moSymptom = 0", class =
                          "bsp")$hypothesis$Evid.Ratio
    
    
    
    
    SkepticCH_string <- ResultsByString(xCH, ER01CH, rng = rng)
    SkepticGE_string <- ResultsByString(xGE, ER01GE, rng = rng)
    
    
    
    HypTable <- data.frame(
      Labels = c("", Name,"Skeptical CH", "Skeptical GE" ),
      Diagnosis = c("Group (SCZ - CT)", "",  SkepticCH_string,  SkepticGE_string)

    )
    
  }
  
  
  
  
  
  if ("C" %in% unique(data$Language) & "J" %in% unique(data$Language) & "G" %in% unique(data$Language)){


    xCH <- hypothesis(SkepticModelLanguage, "LanguageC:moSymptom > 0", class = "bsp")
    xJP <- hypothesis(SkepticModelLanguage, "LanguageJ:moSymptom > 0", class = "bsp")
    xGE <- hypothesis(SkepticModelLanguage, "LanguageG:moSymptom > 0", class = "bsp")

    if (xCH$hypothesis$Estimate < 0) {
      xCH <- hypothesis(SkepticModelLanguage, "LanguageC:moSymptom < 0", class = "bsp")
    }

    if (xJP$hypothesis$Estimate < 0) {
      xJP <- hypothesis(SkepticModelLanguage, "LanguageJ:moSymptom < 0", class = "bsp")
    }

    if (xGE$hypothesis$Estimate < 0) {
      xGE <- hypothesis(SkepticModelLanguage, "LanguageG:moSymptom < 0", class = "bsp")
    }




    ER01CH = hypothesis(SkepticModelLanguage, "LanguageC:moSymptom = 0", class =
                          "bsp")$hypothesis$Evid.Ratio
    ER01JP = hypothesis(SkepticModelLanguage, "LanguageJ:moSymptom = 0", class =
                          "bsp")$hypothesis$Evid.Ratio
    ER01GE = hypothesis(SkepticModelLanguage, "LanguageG:moSymptom = 0", class =
                          "bsp")$hypothesis$Evid.Ratio




    SkepticCH_string <- ResultsByString(xCH, ER01CH, rng = rng)
    SkepticJP_string <- ResultsByString(xJP, ER01JP, rng = rng)
    SkepticGE_string <- ResultsByString(xGE, ER01GE, rng = rng)

        HypTable <- data.frame(
      Labels = c("", Name,"Skeptical CH","Skeptical JP","Skeptical GE" ),
      Diagnosis = c("Group (SCZ - CT)", "",  SkepticCH_string, SkepticJP_string, SkepticGE_string)

    )




  }


  
  
  if (Informed) {
    MA <- MA_Bayesreport(MA_model)
    MA_string <-
      paste0(MA$Mean, " (", MA$CI_l, " ", MA$CI_u, ")")
    

    xm <- MA$Mean
    xs <- MA$Sd
    xm2 <- xm / rng
    xs2 <- (xs / rng) * 3
    
 
    stanvars <-
      stanvar(xm2, name = 'xm2') + stanvar(xs2, name = 'xs2')
    
    if ("C" %in% unique(data$Language)) {
      
      InformedPrior <- c(
        prior(normal(xm2, xs2), class = b),
        prior(normal(0, 0.1), class = sd) ,
        prior(normal(0.5, .3), class = b, coef = LanguageC),
        prior(normal(0, .3), class = sigma))
      
    }
    
    
    if ("J" %in% unique(data$Language)) {
      InformedPrior <- c(
        prior(normal(xm2, xs2), class = b),
        prior(normal(0, 0.1), class = sd) ,
        prior(normal(0.5, .3), class = b, coef = LanguageJ),
        prior(normal(0, .3), class = sigma))
      
    }
    
    
    if ("G" %in% unique(data$Language)){
      InformedPrior <- c(
        prior(normal(xm2, xs2), class = b),
        prior(normal(0, 0.1), class = sd) ,
        prior(normal(0.5, .3), class = b, coef = LanguageG),
        prior(normal(0, .3), class = sigma))
      
    }
    
    if ("C" %in% unique(data$Language) & "G" %in% unique(data$Language)){
      InformedPrior <- c(
        prior(normal(xm2, xs2), class = b),
        prior(normal(0, 0.1), class = sd) ,
        prior(normal(0.5, .3), class = b, coef = LanguageC),
        prior(normal(0.5, .3), class = b, coef = LanguageG),
        prior(normal(0, .3), class = sigma)
      )
      
    
    if ("C" %in% unique(data$Language) & "J" %in% unique(data$Language) & "G" %in% unique(data$Language)){
      InformedPrior <- c(
        prior(normal(xm2, xs2), class = b),
        prior(normal(0, 0.1), class = sd) ,
        prior(normal(0.5, .3), class = b, coef = LanguageC),
        prior(normal(0.5, .3), class = b, coef = LanguageG),
        prior(normal(0.5, .3), class = b, coef = LanguageJ),
        prior(normal(0, .3), class = sigma))
      
    }
    

    }
    
    InformedModelLanguage <-
      brmsFunSym(
        Name = paste0(Name, "_InformedModel_PannsSub_", level),
        formula = SymptomVoice_PannsSub_f,
        data = data,
        prior = InformedPrior,
        stanvars = stanvars
        )

    

    print("Priors, summary and plots of the informed model")
    print(prior_summary(InformedModelLanguage))
    print(summary(InformedModelLanguage))



    # Model comparison


    print("Model comparison with the skeptic model")
    print(loo_compare(SkepticModelLanguage, InformedModelLanguage))
    print(loo_model_weights(SkepticModelLanguage, InformedModelLanguage))
    
    str_weight <- loo_model_weights(SkepticModelLanguage, InformedModelLanguage)
    
    sw <- data.frame(round(str_weight[1],3), round(str_weight[2],3))
    
    if (sw[1] > sw[2]){
      str_w <- paste0("Skeptic Model ", sw$round.str_weight.1...3., ".00")
    } else {
      str_w <- paste0("Informed Model ", sw$round.str_weight.2...3., ".00")
    }
    



    ## First we report the effect of diagnosis

    if ("C" %in% unique(data$Language) & "G" %in% unique(data$Language)){


      xCH <- hypothesis(InformedModelLanguage, "LanguageC:moSymptom > 0", class = "bsp")
      xGE <- hypothesis(InformedModelLanguage, "LanguageG:moSymptom > 0", class = "bsp")

      if (xCH$hypothesis$Estimate < 0) {
        xCH <- hypothesis(InformedModelLanguage, "LanguageC:moSymptom < 0", class = "bsp")
      }

      if (xGE$hypothesis$Estimate < 0) {
        xGE <- hypothesis(InformedModelLanguage, "LanguageG:moSymptom < 0", class = "bsp")
      }




      ER01CH = hypothesis(InformedModelLanguage, "LanguageC:moSymptom = 0", class =
                            "bsp")$hypothesis$Evid.Ratio
      ER01GE = hypothesis(InformedModelLanguage, "LanguageG:moSymptom = 0", class =
                            "bsp")$hypothesis$Evid.Ratio


      InformedCH_string <- ResultsByString(xCH, ER01CH, rng = rng)
      InformedGE_string <- ResultsByString(xGE, ER01GE, rng = rng)


      HypTable <- data.frame(
        Labels = c(
          "",
          Name,
          "MA Priors",
          "Skeptical CH",
          "Skeptical GE",
          "Informed CH",
          "Informed GE",
          "Stacking weight"
        ),
        Diagnosis = c (
          "Group (SCZ - CT)",
          "",
          MA_string,
          SkepticCH_string,
          SkepticGE_string,
          InformedCH_string,
          InformedGE_string,
          str_w
        )

      )


    }

    if ("C" %in% unique(data$Language) & "J" %in% unique(data$Language) & "G" %in% unique(data$Language)){


      xCH <- hypothesis(InformedModelLanguage, "LanguageC:moSymptom > 0", class = "bsp")
      xJP <- hypothesis(InformedModelLanguage, "LanguageJ:moSymptom > 0", class = "bsp")
      xGE <- hypothesis(InformedModelLanguage, "LanguageG:moSymptom > 0", class = "bsp")

      if (xCH$hypothesis$Estimate < 0) {
        xCH <- hypothesis(InformedModelLanguage, "LanguageC:moSymptom < 0", class = "bsp")
      }

      if (xJP$hypothesis$Estimate < 0) {
        xJP <- hypothesis(InformedModelLanguage, "LanguageJ:moSymptom < 0", class = "bsp")
      }

      if (xGE$hypothesis$Estimate < 0) {
        xGE <- hypothesis(InformedModelLanguage, "LanguageG:moSymptom < 0", class = "bsp")
      }




      ER01CH = hypothesis(InformedModelLanguage, "LanguageC:moSymptom = 0", class =
                            "bsp")$hypothesis$Evid.Ratio
      ER01JP = hypothesis(InformedModelLanguage, "LanguageJ:moSymptom = 0", class =
                            "bsp")$hypothesis$Evid.Ratio
      ER01GE = hypothesis(InformedModelLanguage, "LanguageG:moSymptom = 0", class =
                            "bsp")$hypothesis$Evid.Ratio


      InformedCH_string <- ResultsByString(xCH, ER01CH, rng = rng)
      InformedJP_string <- ResultsByString(xJP, ER01JP, rng = rng)
      InformedGE_string <- ResultsByString(xGE, ER01GE, rng = rng)


      HypTable <- data.frame(
        Labels = c(
          "",
          Name,
          "MA Priors",
          "Skeptical CH",
          "Skeptical JP",
          "Skeptical GE",
          "Informed CH",
          "Informed JP",
          "Informed GE",
          "Stacking weight"
        ),
        Diagnosis = c (
          "Group (SCZ - CT)",
          "",
          MA_string,
          SkepticCH_string,
          SkepticJP_string,
          SkepticGE_string,
          InformedCH_string,
          InformedJP_string,
          InformedGE_string,
          str_w
        )
      )

    }




    InformedPlotCH <-
    plot(hypothesis(InformedModelLanguage, "LanguageC:moSymptom > 0", class =
                      "bsp"))[[1]] +
    xlim(-1, 1) + ylim(0, 7) +
    theme_classic() +
    geom_vline(xintercept = 0,
                linetype = "dotted",
              color = "blue") +
    ggtitle(Name) +
    theme(plot.title = element_text(hjust = 0.5))

    ggsave(
     plot = InformedPlotCH,
    file = here("plots", paste0(
      Name, "_InformedPlot_CH_", level, ".svg"
    )),
    units = "cm",
    height = 7,
    width = 12
    )

    InformedPlotGE <-
      plot(hypothesis(InformedModelLanguage, "LanguageG:moSymptom > 0", class =
                        "bsp"))[[1]] +
      xlim(-1, 1) + ylim(0, 7) +
      theme_classic() +
      geom_vline(xintercept = 0,
                 linetype = "dotted",
                 color = "blue") +
      ggtitle(Name) +
      theme(plot.title = element_text(hjust = 0.5))

    ggsave(
      plot = InformedPlotCH,
      file = here("plots", paste0(
        Name, "_InformedPlot_GE_", level, ".svg"
      )),
      units = "cm",
      height = 7,
      width = 12
    )



    post <- posterior_samples(SkepticModelLanguage) %>%
      select(
        SkepticPrior = "prior_bsp_LanguageC:moSymptom",
        SkepticCH = "bsp_LanguageC:moSymptom",
        SkepticGE = "bsp_LanguageG:moSymptom"
        #     SkepticJP = "b_LanguageJ:MoSymptom"
      )

    post1 <-
      posterior_samples(InformedModelLanguage) %>%
      select(
        InformedPrior = "prior_bsp",
        InformedCH = "bsp_LanguageC:moSymptom",
        InformedGE = "bsp_LanguageG:moSymptom"
        #      InformedJP = "b_LanguageJ:moSymptom"
      )

    post2 <- cbind(post, post1) %>%
      gather(parameter,
             value,
             SkepticPrior:InformedGE,
             factor_key = TRUE)


    PriorPlot <- post2 %>%
      subset(parameter %in% c("InformedPrior", "SkepticPrior")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-0.2,0.2) +
      ylim(0, 80) +
      theme_classic()



    ChinesePlot <- post2 %>%
      subset(parameter %in% c("InformedCH", "SkepticCH")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-0.1,0.1) +
      ylim(0, 200) +
      theme_classic()

    GermanPlot <- post2 %>%
      subset(parameter %in% c("InformedGE", "SkepticGE")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-0.05,0.05) +
      ylim(0, 700) +
      theme_classic()

    x <- PriorPlot /ChinesePlot / GermanPlot
    print(x)


    if ("J" %in% unique(data$Language)){


      InformedPlotJP <-
        plot(hypothesis(InformedModelLanguage, "LanguageJ:moSymptom > 0", class =
                          "bsp"))[[1]] +
        xlim(-1, 1) + ylim(0, 7) +
        theme_classic() +
        geom_vline(xintercept = 0,
                   linetype = "dotted",
                   color = "blue") +
        ggtitle(Name) +
        theme(plot.title = element_text(hjust = 0.5))

      ggsave(
        plot = InformedPlotCH,
        file = here("plots", paste0(
          Name, "_InformedPlot_JP_", level, ".svg"
        )),
        units = "cm",
        height = 7,
        width = 12
      )


      post <- posterior_samples(SkepticModelLanguage) %>%
        select(
          SkepticPrior = "prior_bsp_LanguageC:moSymptom",
          SkepticCH = "bsp_LanguageC:moSymptom",
          SkepticGE = "bsp_LanguageG:moSymptom",
          SkepticJP = "bsp_LanguageJ:moSymptom"
        )

      post1 <-
        posterior_samples(InformedModelLanguage) %>%
        select(
          InformedPrior = "prior_bsp",
          InformedCH = "bsp_LanguageC:moSymptom",
          InformedGE = "bsp_LanguageG:moSymptom",
          InformedJP = "bsp_LanguageJ:moSymptom"
        )

      post2 <- cbind(post, post1) %>%
        gather(parameter,
               value,
               SkepticPrior:InformedJP,
               factor_key = TRUE)

      JapanesePlot <- post2 %>%
        subset(parameter %in% c("InformedJP", "SkepticJP")) %>%
        ggplot(aes(value, fill=parameter)) +
        geom_density(alpha=0.3) +
        geom_vline(xintercept = 0, linetype = "dashed") +
        xlim(-0.1,0.1) +
        ylim(0, 200) +
        theme_classic()

      x <- PriorPlot /ChinesePlot / GermanPlot /JapanesePlot
      print(x)

    }

    CompPlot <- ggplot(post2, aes(value, parameter)) +
      geom_density_ridges() +
      geom_vline(xintercept = 0, linetype = "dashed") +
      theme_classic()
    print(CompPlot)
    
    
  }
  
  print("Hypothesis testing")
  
  formattable(HypTable)
  return(HypTable)
  
}




ModelsByMedication <- function(Name = "TotalPitchMedian",
                              data = d_trial_SZ, 
                              Variable = d_trial$PitchMedianS,
                              SkepticPrior = SkepticPrior, 
                              MA_model = Pitch_mean_Prior,
                              Informed = FALSE, 
                              level = "Trial"){
  

  
  
 
  # Extracting Outcome variable
  data$Outcome <- Variable
  
  data <- data %>% 
    mutate(Outcome = Variable) %>%
    subset(!is.na(Outcome))
  
  data$Outcome[data$Language=="D"] <- scale(data$Outcome[data$Language=="D"])
  data$Outcome[data$Language=="C"] <- scale(data$Outcome[data$Language=="C"])
  data$Outcome[data$Language=="G"] <- scale(data$Outcome[data$Language=="G"])
  
  
  
  SkepticPrior <- c(
    prior(normal(0, .5), class=b),
    prior(normal(0, .7), class=sd),
    prior(normal(0.3, 0.1), class = sigma)
  )
  
 
  # Fitting Models
  SkepticModelLanguage <- brmsFunMed(
    Name = paste0(Name, "_SkepticModel_Medi_", level),
    formula = MedicationVoice_Language_f,
    data = data, iter = 10000)
  
  
  
  print("Priors, summary and plots of the skeptic model")
  print(prior_summary(SkepticModelLanguage))
  print(summary(SkepticModelLanguage))
  PlotByMedication(SkepticModelLanguage,"SkepticModel_Medi")
  
  

  
  
  ## First we report the effect of diagnosis
  
  x1DK <- hypothesis(SkepticModelLanguage,"LanguageD:D2Rlow > 0")
  x1CH <- hypothesis(SkepticModelLanguage,"LanguageC:D2Rlow > 0")
  x1GE <- hypothesis(SkepticModelLanguage,"LanguageG:D2Rlow > 0")
  
  
  if (x1DK$hypothesis$Estimate < 0){
    x1DK <- hypothesis(SkepticModelLanguage,"LanguageD:D2Rlow < 0")
  }
  if (x1CH$hypothesis$Estimate < 0){
    x1CH <- hypothesis(SkepticModelLanguage,"LanguageC:D2Rlow < 0")
  }

  if (x1GE$hypothesis$Estimate < 0){
    x1GE <- hypothesis(SkepticModelLanguage,"LanguageG:D2Rlow < 0")
  }
  
  
  
  ER01DK = hypothesis(SkepticModelLanguage,"LanguageD:D2Rlow = 0")$hypothesis$Evid.Ratio
  ER01CH = hypothesis(SkepticModelLanguage,"LanguageC:D2Rlow = 0")$hypothesis$Evid.Ratio
  ER01GE = hypothesis(SkepticModelLanguage,"LanguageG:D2Rlow = 0")$hypothesis$Evid.Ratio
  
  x2DK <- hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh > 0")
  x2CH <- hypothesis(SkepticModelLanguage,"LanguageC:D2Rhigh > 0")
  x2GE <- hypothesis(SkepticModelLanguage,"LanguageG:D2Rhigh > 0")
  
  
  if (x2DK$hypothesis$Estimate < 0){
    x2DK <- hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh < 0")
  }
  if (x2CH$hypothesis$Estimate < 0){
    x2CH <- hypothesis(SkepticModelLanguage,"LanguageC:D2Rhigh < 0")
  }

  if (x2GE$hypothesis$Estimate < 0){
    x2GE <- hypothesis(SkepticModelLanguage,"LanguageG:D2Rhigh < 0")
  }
  
  ER02DK = hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh = 0")$hypothesis$Evid.Ratio
  ER02CH = hypothesis(SkepticModelLanguage,"LanguageC:D2Rhigh = 0")$hypothesis$Evid.Ratio
  ER02GE = hypothesis(SkepticModelLanguage,"LanguageG:D2Rhigh = 0")$hypothesis$Evid.Ratio
  
  
  SkepticDK1_string <- ResultsByString(x1DK, ER01DK)
  SkepticCH1_string <- ResultsByString(x1CH, ER01CH)
  SkepticGE1_string <- ResultsByString(x1GE, ER01GE)
  
  SkepticDK2_string <- ResultsByString(x2DK, ER02DK)
  SkepticCH2_string <- ResultsByString(x2CH, ER02CH)
  SkepticGE2_string <- ResultsByString(x2GE, ER02GE)
  
  
  
  
   # High > Low
  
  x1 <- hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh > LanguageD:D2Rlow")
  if (x1$hypothesis$Estimate < 0){
    x1 <- hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh < LanguageD:D2Rlow")
  }
  CO01 = hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh = LanguageD:D2Rlow")$hypothesis$Evid.Ratio

  
  x2 <- hypothesis(SkepticModelLanguage,"LanguageC:D2Rhigh > LanguageC:D2Rlow")
  if (x2$hypothesis$Estimate < 0){
    x2 <- hypothesis(SkepticModelLanguage,"LanguageC:D2Rhigh < LanguageC:D2Rlow")
  }
  CO02 = hypothesis(SkepticModelLanguage,"LanguageC:D2Rhigh = LanguageC:D2Rlow")$hypothesis$Evid.Ratio
  
  
  x3 <- hypothesis(SkepticModelLanguage,"LanguageG:D2Rhigh > LanguageG:D2Rlow")
  if (x3$hypothesis$Estimate < 0){
    x3 <- hypothesis(SkepticModelLanguage,"LanguageG:D2Rhigh < LanguageG:D2Rlow")
  }
  CO03 = hypothesis(SkepticModelLanguage,"LanguageG:D2Rhigh = LanguageG:D2Rlow")$hypothesis$Evid.Ratio
  
  
  # # Report contrasts
  
  # # High > Low 
   SkepticHighLow_DK_Contrast_String <- ResultsByString(x1, CO01)
   SkepticHighLow_CH_Contrast_String <- ResultsByString(x2, CO02)
   SkepticHighLow_GE_Contrast_String <- ResultsByString(x3, CO03)
   
  
 
  ## Now onto making a table with the results  
  HypTable <- data.frame(
    Labels = c("", 
               Name, 
               "Skeptical DK Low", 
               "Skeptical CH Low", 
               "Skeptical GE Low", 
               "Skeptical DK High", 
               "Skeptical CH High", 
               "Skeptical GE High", 
               "Skeptical DK High-Low", 
               "Skeptical CH High-Low", 
               "Skeptical GE High-Low"),
    Diagnosis = c ("Group (SCZ - CT)", 
                   "", 
                   SkepticDK1_string,  
                   SkepticCH1_string, 
                   SkepticGE1_string, 
                   SkepticDK2_string,  
                   SkepticCH2_string, 
                   SkepticGE2_string, 
                   SkepticHighLow_DK_Contrast_String, 
                   SkepticHighLow_CH_Contrast_String, 
                   SkepticHighLow_GE_Contrast_String   
                   )

  )
  
  if (Informed) {
    MA <- MA_Med_report(MA_model)
    MA_string1 <- paste0(MA$Mean_HIGHvsHC, " (","+", MA$Sd_HIGHvsHC, " -", MA$Sd_HIGHvsHC, ")")
    MA_string2 <- paste0(MA$Mean_LOWvsHC, " (","+", MA$Sd_LOWvsHC, " -", MA$Sd_LOWvsHC, ")")
    MA_string3 <- paste0(MA$Mean_HIGHvsLOW, " (","+", MA$Sd_HIGHvsLOW, " -", MA$Sd_HIGHvsLOW, ")")
    
    
    round(MA_model$Mean_LOWvsHC, 2)
    
    xm1 <- as.numeric(MA_model$Mean_LOWvsHC)
    xs1 <- as.numeric(MA_model$Sd_LOWvsHC)
    
    xm2 <- as.numeric(MA_model$Mean_HIGHvsHC)
    xs2 <- as.numeric(MA_model$Sd_HIGHvsHC)

    
    InformedPrior <- c(
      prior(normal(xm1, xs1), class=b, coef = LanguageD:D2Rlow),
      prior(normal(xm1, xs1), class=b, coef = LanguageC:D2Rlow),
      prior(normal(xm1, xs1), class=b, coef = LanguageG:D2Rlow),
      prior(normal(xm2, xs2), class=b, coef = LanguageD:D2Rhigh),
      prior(normal(xm2, xs2), class=b, coef = LanguageC:D2Rhigh),
      prior(normal(xm2, xs2), class=b, coef = LanguageG:D2Rhigh),
      prior(normal(0, .7), class = sd) ,
      prior(normal(0, .5), class = b, coef = LanguageD),
      prior(normal(0, .5), class = b, coef = LanguageC),
      prior(normal(0, .5), class = b, coef = LanguageG),
      prior(normal(0.3, 0.1), class = sigma)
    )
    
    stanvars <- stanvar(xm1, name = 'xm1') + stanvar(xs1, name = 'xs1') + stanvar(xm2, name = 'xm2') + stanvar(xs2, name = 'xs2')
    
    InformedModelLanguage <-
      brmsFunMed(
        Name = paste0(Name, "_InformedModel_", level),
        formula = MedicationVoice_Language_f,
        data = data,
        prior = InformedPrior,
        stanvars = stanvars
      )
    
    print("Priors, summary and plots of the informed model")
    print(summary(InformedModelLanguage))
    print(prior_summary(InformedModelLanguage))
    PlotByMedication(InformedModelLanguage, "InformedModel")
    
    print("Model comparison with the skeptic model")
    print(loo_compare(SkepticModelLanguage, InformedModelLanguage))
    print(loo_model_weights(SkepticModelLanguage, InformedModelLanguage))
    
    
    
    ## First we report the effect of diagnosis
    x1DK <- hypothesis(InformedModelLanguage,"LanguageD:D2Rlow > 0")
    x1CH <- hypothesis(InformedModelLanguage,"LanguageC:D2Rlow > 0")
    x1CH <- hypothesis(InformedModelLanguage,"LanguageG:D2Rlow > 0")

    if (x1DK$hypothesis$Estimate < 0){
      x1DK <- hypothesis(InformedModelLanguage,"LanguageD:D2Rlow < 0")
    }
    if (x1CH$hypothesis$Estimate < 0){
      x1CH <- hypothesis(InformedModelLanguage,"LanguageC:D2Rlow < 0")
    }
    if (x1GE$hypothesis$Estimate < 0){
      x1GE <- hypothesis(InformedModelLanguage,"LanguageG:D2Rlow < 0")
    }

    
    ER01DK = hypothesis(InformedModelLanguage,"LanguageD:D2Rlow = 0")$hypothesis$Evid.Ratio
    ER01CH = hypothesis(InformedModelLanguage,"LanguageC:D2Rlow = 0")$hypothesis$Evid.Ratio
    ER01GE = hypothesis(InformedModelLanguage,"LanguageG:D2Rlow = 0")$hypothesis$Evid.Ratio

    x2DK <- hypothesis(InformedModelLanguage,"LanguageD:D2Rhigh > 0")
    x2CH <- hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh > 0")
    x2GE <- hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh > 0")

    if (x2DK$hypothesis$Estimate < 0){
      x2DK <- hypothesis(InformedModelLanguage,"LanguageD:D2Rhigh < 0")
    }
    if (x2CH$hypothesis$Estimate < 0){
      x2CH <- hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh < 0")
    }
    if (x2GE$hypothesis$Estimate < 0){
      x2GE <- hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh < 0")
    }

    
    ER02DK = hypothesis(InformedModelLanguage,"LanguageD:D2Rhigh = 0")$hypothesis$Evid.Ratio
    ER02CH = hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh = 0")$hypothesis$Evid.Ratio
    ER02GE = hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh = 0")$hypothesis$Evid.Ratio
    
    
    InformedDK1_string <- ResultsByString(x1DK, ER01DK)
    InformedCH1_string <- ResultsByString(x1CH, ER01CH)
    InformedGE1_string <- ResultsByString(x1GE, ER01GE)
    
    InformedDK2_string <- ResultsByString(x2DK, ER02DK)
    InformedCH2_string <- ResultsByString(x2CH, ER02CH)
    InformedGE2_string <- ResultsByString(x2GE, ER02GE)
    
    
    # High > Low
    
    x1 <- hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh > LanguageD:D2Rlow")
    if (x1$hypothesis$Estimate < 0){
      x1 <- hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh < LanguageD:D2Rlow")
    }
    CO01 = hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh = LanguageD:D2Rlow")$hypothesis$Evid.Ratio
    
    
    x2 <- hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh > LanguageC:D2Rlow")
    if (x2$hypothesis$Estimate < 0){
      x2 <- hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh < LanguageC:D2Rlow")
    }
    CO02 = hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh = LanguageC:D2Rlow")$hypothesis$Evid.Ratio
    
    
    x3 <- hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh > LanguageG:D2Rlow")
    if (x3$hypothesis$Estimate < 0){
      x3 <- hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh < LanguageG:D2Rlow")
    }
    CO03 = hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh = LanguageG:D2Rlow")$hypothesis$Evid.Ratio
    
    
    InformedHighLow_DK_Contrast_String <- ResultsByString(x1, CO01)
    InformedHighLow_CH_Contrast_String <- ResultsByString(x2, CO02)
    InformedHighLow_GE_Contrast_String <- ResultsByString(x3, CO03) 
    

    
    HypTable <- data.frame(
      Labels = c(
        "",
        Name,
        "MA_Priors_High vs HC",
        "MA_Priors_Low vs HC",
        "MA_Priors_High vs Low",
        "Skeptical DK Low",
        "Skeptical CH Low",
        "Skeptical GE Low",
        "Skeptical DK High",
        "Skeptical CH High",
        "Skeptical GE High",
        "Skeptical DK High-Low", 
        "Skeptical CH High-Low", 
        "Skeptical GE High-Low",       
        "Informed DK Low",
        "Informed CH Low",
        "Informed GE Low",
        "Informed DK High",
        "Informed CH High",
        "Informed GE High",
        "Informedal DK High-Low", 
        "Informedal CH High-Low", 
        "Informedal GE High-Low" 
      ),
      #
      Diagnosis = c (
        "Group (SCZ - CT)",
        "",
        MA_string1,
        MA_string2,
        MA_string3, 
        SkepticDK1_string,
        SkepticCH1_string,
        SkepticGE1_string,
        SkepticDK2_string,
        SkepticCH2_string,
        SkepticGE2_string,
        SkepticHighLow_DK_Contrast_String, 
        SkepticHighLow_CH_Contrast_String, 
        SkepticHighLow_GE_Contrast_String,   
        InformedDK1_string,
        InformedCH1_string,
        InformedGE1_string,
        InformedDK2_string,
        InformedCH2_string,
        InformedGE2_string,
        InformedHighLow_DK_Contrast_String, 
        InformedHighLow_CH_Contrast_String, 
        InformedHighLow_GE_Contrast_String
      )
      )
  
    
   
    
    post <- posterior_samples(SkepticModelLanguage) %>%
      select(
        SkepticPrior = prior_b,
        SkepticDK1 = "b_LanguageD:D2Rlow",
        SkepticCH1 = "b_LanguageC:D2Rlow",
        SkepticGE1 = "b_LanguageG:D2Rlow",
        SkepticDK2 = "b_LanguageD:D2Rhigh",
        SkepticCH2 = "b_LanguageC:D2Rhigh",
        SkepticGE2 = "b_LanguageG:D2Rhigh"
      )
    
    post1 <- posterior_samples(InformedModelLanguage) %>%
      select(
        InformedPrior1 = "prior_b_LanguageD:D2Rlow",
        InformedPrior2 = "prior_b_LanguageD:D2Rhigh",
        InformedPrior3 = "prior_b_LanguageD:D2Rhigh",
        InformedDK1 = "b_LanguageD:D2Rlow",
        InformedCH1 = "b_LanguageC:D2Rlow",
        InformedGE1 = "b_LanguageG:D2Rlow",
        InformedDK2 = "b_LanguageD:D2Rhigh",
        InformedCH2 = "b_LanguageC:D2Rhigh",
        InformedGE2 = "b_LanguageG:D2Rhigh",
      )
    
    post2 <- cbind(post, post1) %>%
      gather(parameter, value, SkepticPrior:InformedGE2, factor_key = TRUE)

     
    PriorPlot <- post2 %>%
      subset(parameter %in% c("InformedPrior1", "InformedPrior2", "InformedPrior3","SkepticPrior")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    DanishPlot <- post2 %>%
      subset(parameter %in% c("InformedDK1", "SkepticDK1", "InformedDK2", "SkepticDK2")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    ChinesePlot <- post2 %>%
      subset(parameter %in% c("InformedCH1", "SkepticCH1", "InformedCH2", "SkepticCH2")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    GermanPlot <- post2 %>%
      subset(parameter %in% c("InformedGE1", "SkepticGE1", "InformedGE2", "SkepticGE2")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    #library(patchwork)
    x <- PriorPlot / DanishPlot / ChinesePlot/GermanPlot 
    print(x)
    
    
    
    
    CompPlot <- ggplot(post2, aes(value, parameter)) +
      geom_density_ridges() +
      geom_vline(xintercept = 0, linetype = "dashed") +
      theme_classic()
    print(CompPlot)
    
  }
  
  print("Estimates in a table")
  formattable(HypTable)
  return(HypTable)
 
  
}



ModelsByCPZ <- function(Name = "TotalPitchMedian",
                               data = d_trial_SZ, 
                               Variable = d_trial$PitchMedianS,
                               SkepticPrior = SkepticPrior, 
                               MA_model = Pitch_mean_Prior,
                               Informed = FALSE, 
                               level = "Trial"){
  


  
  # Extracting Outcome variable
  data$Outcome <- Variable
  
  data <- data %>% 
    mutate(Outcome = Variable) %>%
    subset(!is.na(Outcome))
  
  data$Outcome[data$Language=="D"] <- scale(data$Outcome[data$Language=="D"])
  data$Outcome[data$Language=="C"] <- scale(data$Outcome[data$Language=="C"])
  data$Outcome[data$Language=="G"] <- scale(data$Outcome[data$Language=="G"])
  

  SkepticPrior <- c(
    prior(normal(0, .5), class=b),
    prior(normal(0, .7), class=sd),
    prior(normal(0.3, 0.1), class = sigma)
  )

  # Fitting Models
  
  SkepticModelLanguage <- brmsFunMed(
    Name = paste0(Name, "_SkepticModel_CPZ_", level),
    formula = CPZVoice_Language_f,
    data = data, iter = 10000)
  


  
  print("Priors, summary and plots of the skeptic model")
  print(prior_summary(SkepticModelLanguage))
  print(summary(SkepticModelLanguage))
  

  
  
  # First we report the effect of diagnosis

  x1DK <- hypothesis(SkepticModelLanguage,"LanguageD:CPZ  > 0")
  x1CH <- hypothesis(SkepticModelLanguage,"LanguageC:CPZ  > 0")
  x1GE <- hypothesis(SkepticModelLanguage,"LanguageG:CPZ  > 0")


  if (x1DK$hypothesis$Estimate < 0){
    x1DK <- hypothesis(SkepticModelLanguage,"LanguageD:CPZ  < 0")
  }
  if (x1CH$hypothesis$Estimate < 0){
    x1CH <- hypothesis(SkepticModelLanguage,"LanguageC:CPZ  < 0")
  }

  if (x1GE$hypothesis$Estimate < 0){
    x1GE <- hypothesis(SkepticModelLanguage,"LanguageG:CPZ  < 0")
  }



  ER01DK = hypothesis(SkepticModelLanguage,"LanguageD:CPZ  = 0")$hypothesis$Evid.Ratio
  ER01CH = hypothesis(SkepticModelLanguage,"LanguageC:CPZ  = 0")$hypothesis$Evid.Ratio
  ER01GE = hypothesis(SkepticModelLanguage,"LanguageG:CPZ  = 0")$hypothesis$Evid.Ratio


  SkepticDK1_string <- ResultsByString(x1DK, ER01DK, rng = 100)
  SkepticCH1_string <- ResultsByString(x1CH, ER01CH, rng = 100)
  SkepticGE1_string <- ResultsByString(x1GE, ER01GE, rng = 100)


  ## Now onto making a table with the results
  
  HypTable <- data.frame(
    Labels = c("",
               Name,
               "Skeptical DK CPZ",
               "Skeptical CH CPZ",
               "Skeptical GE CPZ"),
    Diagnosis = c ("Group (SCZ - CT)",
                   "",
                   SkepticDK1_string,
                   SkepticCH1_string,
                   SkepticGE1_string
    ))
  

  
  
  if (Informed) {
    MA <- MA_Med_report(MA_model)
    MA_string1 <- paste0(MA$Mean_HIGHvsHC, " (","+", MA$Sd_HIGHvsHC, " -", MA$Sd_HIGHvsHC, ")")
    MA_string2 <- paste0(MA$Mean_LOWvsHC, " (","+", MA$Sd_LOWvsHC, " -", MA$Sd_LOWvsHC, ")")
    MA_string3 <- paste0(MA$Mean_HIGHvsLOW, " (","+", MA$Sd_HIGHvsLOW, " -", MA$Sd_HIGHvsLOW, ")")
    
    
    round(MA_model$Mean_LOWvsHC, 2)
    
    xm1 <- as.numeric(MA_model$Mean_LOWvsHC)
    xs1 <- as.numeric(MA_model$Sd_LOWvsHC)
    
    xm2 <- as.numeric(MA_model$Mean_HIGHvsHC)
    xs2 <- as.numeric(MA_model$Sd_HIGHvsHC)
    
    
    InformedPrior <- c(
      prior(normal(xm1, xs1), class=b, coef = LanguageD:D2Rlow),
      prior(normal(xm1, xs1), class=b, coef = LanguageC:D2Rlow),
      prior(normal(xm1, xs1), class=b, coef = LanguageG:D2Rlow),
      prior(normal(xm2, xs2), class=b, coef = LanguageD:D2Rhigh),
      prior(normal(xm2, xs2), class=b, coef = LanguageC:D2Rhigh),
      prior(normal(xm2, xs2), class=b, coef = LanguageG:D2Rhigh),
      prior(normal(0, .7), class = sd) ,
      prior(normal(0, .5), class = b, coef = LanguageD),
      prior(normal(0, .5), class = b, coef = LanguageC),
      prior(normal(0, .5), class = b, coef = LanguageG),
      prior(normal(0.3, 0.1), class = sigma)
    )
    
    stanvars <- stanvar(xm1, name = 'xm1') + stanvar(xs1, name = 'xs1') + stanvar(xm2, name = 'xm2') + stanvar(xs2, name = 'xs2')
    
    InformedModelLanguage <-
      brmsFunMed(
        Name = paste0(Name, "_InformedModel_", level),
        formula = MedicationVoice_Language_f,
        data = data,
        prior = InformedPrior,
        stanvars = stanvars
      )
    
    print("Priors, summary and plots of the informed model")
    print(summary(InformedModelLanguage))
    print(prior_summary(InformedModelLanguage))
    PlotByMedication(InformedModelLanguage, "InformedModel")
    
    print("Model comparison with the skeptic model")
    print(loo_compare(SkepticModelLanguage, InformedModelLanguage))
    print(loo_model_weights(SkepticModelLanguage, InformedModelLanguage))
    
    
    
    ## First we report the effect of diagnosis
    x1DK <- hypothesis(InformedModelLanguage,"LanguageD:D2Rlow > 0")
    x1CH <- hypothesis(InformedModelLanguage,"LanguageC:D2Rlow > 0")
    x1CH <- hypothesis(InformedModelLanguage,"LanguageG:D2Rlow > 0")

    if (x1DK$hypothesis$Estimate < 0){
      x1DK <- hypothesis(InformedModelLanguage,"LanguageD:D2Rlow < 0")
    }
    if (x1CH$hypothesis$Estimate < 0){
      x1CH <- hypothesis(InformedModelLanguage,"LanguageC:D2Rlow < 0")
    }
    if (x1GE$hypothesis$Estimate < 0){
      x1GE <- hypothesis(InformedModelLanguage,"LanguageG:D2Rlow < 0")
    }

    
    ER01DK = hypothesis(InformedModelLanguage,"LanguageD:D2Rlow = 0")$hypothesis$Evid.Ratio
    ER01CH = hypothesis(InformedModelLanguage,"LanguageC:D2Rlow = 0")$hypothesis$Evid.Ratio
    ER01GE = hypothesis(InformedModelLanguage,"LanguageG:D2Rlow = 0")$hypothesis$Evid.Ratio

    x2DK <- hypothesis(InformedModelLanguage,"LanguageD:D2Rhigh > 0")
    x2CH <- hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh > 0")
    x2GE <- hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh > 0")

    if (x2DK$hypothesis$Estimate < 0){
      x2DK <- hypothesis(InformedModelLanguage,"LanguageD:D2Rhigh < 0")
    }
    if (x2CH$hypothesis$Estimate < 0){
      x2CH <- hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh < 0")
    }
    if (x2GE$hypothesis$Estimate < 0){
      x2GE <- hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh < 0")
    }

    
    ER02DK = hypothesis(InformedModelLanguage,"LanguageD:D2Rhigh = 0")$hypothesis$Evid.Ratio
    ER02CH = hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh = 0")$hypothesis$Evid.Ratio
    ER02GE = hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh = 0")$hypothesis$Evid.Ratio
    
    
    InformedDK1_string <- ResultsByString(x1DK, ER01DK, rng = 100)
    InformedCH1_string <- ResultsByString(x1CH, ER01CH, rng = 100)
    InformedGE1_string <- ResultsByString(x1GE, ER01GE, rng = 100)
    
    InformedDK2_string <- ResultsByString(x2DK, ER02DK, rng = 100)
    InformedCH2_string <- ResultsByString(x2CH, ER02CH, rng = 100)
    InformedGE2_string <- ResultsByString(x2GE, ER02GE, rng = 100)
    
    
    # High > Low
    x1 <- hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh > LanguageD:D2Rlow")
    if (x1$hypothesis$Estimate < 0){
      x1 <- hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh < LanguageD:D2Rlow")
    }
    CO01 = hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh = LanguageD:D2Rlow")$hypothesis$Evid.Ratio
    
    
    x2 <- hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh > LanguageC:D2Rlow")
    if (x2$hypothesis$Estimate < 0){
      x2 <- hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh < LanguageC:D2Rlow")
    }
    CO02 = hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh = LanguageC:D2Rlow")$hypothesis$Evid.Ratio
    
    
    x3 <- hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh > LanguageG:D2Rlow")
    if (x3$hypothesis$Estimate < 0){
      x3 <- hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh < LanguageG:D2Rlow")
    }
    CO03 = hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh = LanguageG:D2Rlow")$hypothesis$Evid.Ratio
    
    
    InformedHighLow_DK_Contrast_String <- ResultsByString(x1, CO01)
    InformedHighLow_CH_Contrast_String <- ResultsByString(x2, CO02)
    InformedHighLow_GE_Contrast_String <- ResultsByString(x3, CO03) 
    
    
    
    HypTable <- data.frame(
      Labels = c(
        "",
        Name,
        "MA_Priors_High vs HC",
        "MA_Priors_Low vs HC",
        "MA_Priors_High vs Low",
        "Skeptical DK Low",
        "Skeptical CH Low",
        "Skeptical GE Low",
        "Skeptical DK High",
        "Skeptical CH High",
        "Skeptical GE High",
        "Skeptical DK High-Low", 
        "Skeptical CH High-Low", 
        "Skeptical GE High-Low",       
        "Informed DK Low",
        "Informed CH Low",
        "Informed GE Low",
        "Informed DK High",
        "Informed CH High",
        "Informed GE High",
        "Informedal DK High-Low", 
        "Informedal CH High-Low", 
        "Informedal GE High-Low" 
      ),
      #
      Diagnosis = c (
        "Group (SCZ - CT)",
        "",
        MA_string1,
        MA_string2,
        MA_string3, 
        SkepticDK1_string,
        SkepticCH1_string,
        SkepticGE1_string,
        SkepticDK2_string,
        SkepticCH2_string,
        SkepticGE2_string,
        SkepticHighLow_DK_Contrast_String, 
        SkepticHighLow_CH_Contrast_String, 
        SkepticHighLow_GE_Contrast_String,   
        InformedDK1_string,
        InformedCH1_string,
        InformedGE1_string,
        InformedDK2_string,
        InformedCH2_string,
        InformedGE2_string,
        InformedHighLow_DK_Contrast_String, 
        InformedHighLow_CH_Contrast_String, 
        InformedHighLow_GE_Contrast_String
      )
    )
    
    
    
    
    post <- posterior_samples(SkepticModelLanguage) %>%
      select(
        SkepticPrior = prior_b,
        SkepticDK1 = "b_LanguageD:D2Rlow",
        SkepticCH1 = "b_LanguageC:D2Rlow",
        SkepticGE1 = "b_LanguageG:D2Rlow",
        SkepticDK2 = "b_LanguageD:D2Rhigh",
        SkepticCH2 = "b_LanguageC:D2Rhigh",
        SkepticGE2 = "b_LanguageG:D2Rhigh"
      )
    
    post1 <- posterior_samples(InformedModelLanguage) %>%
      select(
        InformedPrior1 = "prior_b_LanguageD:D2Rlow",
        InformedPrior2 = "prior_b_LanguageD:D2Rhigh",
        InformedPrior3 = "prior_b_LanguageD:D2Rhigh",
        InformedDK1 = "b_LanguageD:D2Rlow",
        InformedCH1 = "b_LanguageC:D2Rlow",
        InformedGE1 = "b_LanguageG:D2Rlow",
        InformedDK2 = "b_LanguageD:D2Rhigh",
        InformedCH2 = "b_LanguageC:D2Rhigh",
        InformedGE2 = "b_LanguageG:D2Rhigh",
      )
    
    post2 <- cbind(post, post1) %>%
      gather(parameter, value, SkepticPrior:InformedGE2, factor_key = TRUE)
    
    
    PriorPlot <- post2 %>%
      subset(parameter %in% c("InformedPrior1", "InformedPrior2", "InformedPrior3","SkepticPrior")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    DanishPlot <- post2 %>%
      subset(parameter %in% c("InformedDK1", "SkepticDK1", "InformedDK2", "SkepticDK2")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    ChinesePlot <- post2 %>%
      subset(parameter %in% c("InformedCH1", "SkepticCH1", "InformedCH2", "SkepticCH2")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    GermanPlot <- post2 %>%
      subset(parameter %in% c("InformedGE1", "SkepticGE1", "InformedGE2", "SkepticGE2")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    x <- PriorPlot / DanishPlot / ChinesePlot/GermanPlot 
    print(x)
    
    
    
    
    CompPlot <- ggplot(post2, aes(value, parameter)) +
      geom_density_ridges() +
      geom_vline(xintercept = 0, linetype = "dashed") +
      theme_classic()
    print(CompPlot)
    
  }
  
  print("Estimates in a table")
  formattable(HypTable)
  return(HypTable)
  
  
}


ModelsByDUI <- function(Name = "TotalPitchMedian",
                        data = d_trial_SZ, 
                        Variable = d_trial$PitchMedianS,
                        SkepticPrior = SkepticPrior, 
                        MA_model = Pitch_mean_Prior,
                        Informed = FALSE, 
                        level = "Trial"){
  
  
  
  # Extracting Outcome variable
  data$Outcome <- Variable
  
  data <- data %>% 
    mutate(Outcome = Variable) %>%
    subset(!is.na(Outcome))
  
  data$Outcome[data$Language=="D"] <- scale(data$Outcome[data$Language=="D"])
  data$Outcome[data$Language=="C"] <- scale(data$Outcome[data$Language=="C"])
  data$Outcome[data$Language=="G"] <- scale(data$Outcome[data$Language=="G"])
  
  
  
  SkepticPrior <- c(
    prior(normal(0, .5), class=b),
    prior(normal(0, .7), class=sd),
    prior(normal(0.3, 0.1), class = sigma)
  )
  
  # Fitting Models
  SkepticModelLanguage <- brmsFunMed(
    Name = paste0(Name, "_SkepticModel_DUI_", level),
    formula = DUIVoice_Language_f,
    data = data, iter = 10000)
  
  
  print("Priors, summary and plots of the skeptic model")
  print(prior_summary(SkepticModelLanguage))
  print(summary(SkepticModelLanguage))


  
  ## First we report the effect of diagnosis
  
  x1DK <- hypothesis(SkepticModelLanguage,"LanguageD:Ill_Dur > 0")
  x1CH <- hypothesis(SkepticModelLanguage,"LanguageC:Ill_Dur  > 0")
  x1GE <- hypothesis(SkepticModelLanguage,"LanguageG:Ill_Dur  > 0")
  
  
  if (x1DK$hypothesis$Estimate < 0){
    x1DK <- hypothesis(SkepticModelLanguage,"LanguageD:Ill_Dur  < 0")
  }
  if (x1CH$hypothesis$Estimate < 0){
    x1CH <- hypothesis(SkepticModelLanguage,"LanguageC:Ill_Dur  < 0")
  }
  
  if (x1GE$hypothesis$Estimate < 0){
    x1GE <- hypothesis(SkepticModelLanguage,"LanguageG:Ill_Dur  < 0")
  }
  
  
  
  ER01DK = hypothesis(SkepticModelLanguage,"LanguageD:Ill_Dur  = 0")$hypothesis$Evid.Ratio
  ER01CH = hypothesis(SkepticModelLanguage,"LanguageC:Ill_Dur  = 0")$hypothesis$Evid.Ratio
  ER01GE = hypothesis(SkepticModelLanguage,"LanguageG:Ill_Dur  = 0")$hypothesis$Evid.Ratio
  
  
  
  SkepticDK1_string <- ResultsByString(x1DK, ER01DK, rng = 10)
  SkepticCH1_string <- ResultsByString(x1CH, ER01CH, rng = 10)
  SkepticGE1_string <- ResultsByString(x1GE, ER01GE, rng = 10)


  
  
  
  
  ## Now onto making a table with the results  
  HypTable <- data.frame(
    Labels = c("", 
               Name, 
               "Skeptical DUI DK", 
               "Skeptical DUI CH", 
               "Skeptical DUI GE"), 
    Diagnosis = c ("Group (SCZ - CT)", 
                   "", 
                   SkepticDK1_string,  
                   SkepticCH1_string, 
                   SkepticGE1_string 
    )

  )
  
  
  print("Estimates in a table")
  formattable(HypTable)
  return(HypTable)
  
}




ModelsByPesope <- function(Name = "TotalPitchMedian",
                            data = d_trial_SZ,
                            Outcome = d_trial_SZ$PitchMedianS,
                            Symptom = d_trial_SZ$AdosTotal,
                            SkepticPrior = SkepticPrior,
                            MA_model = PitchMean_BayesianPrior,
                            Informed = TRUE,
                            level = "Trial") {
  

  

   
  # Extracting Outcome variable
  
  data$Outcome <- Outcome
  
  
  data$Outcome[data$Language == "D"] <- (data$Outcome[data$Language == "D"] - min(data$Outcome[data$Language == "D"], na.rm = T))
  
  
  data$Outcome[data$Language == "D"] <- data$Outcome[data$Language == "D"] / (max(data$Outcome[data$Language == "D"], na.rm = TRUE))
  
  
  data$Outcome[data$Language == "C"] <- (data$Outcome[data$Language == "C"] - min(data$Outcome[data$Language == "C"], na.rm = T))
  
  
  data$Outcome[data$Language == "C"] <- data$Outcome[data$Language == "C"] / (max(data$Outcome[data$Language == "C"], na.rm = TRUE))
  
  
  
  
  data$Symptom <- Symptom
  data$Symptom <- as.integer(data$Symptom)
  data <- data %>% subset(!is.na(Symptom) & !is.na(Outcome)) %>%
    mutate(Language = as.factor(as.character(Language)))
  
  ## Priors
  rng <- range(data$Symptom, na.rm = T)[2]
  
  # adjust prior
  
  xm = (.3 / rng) * 2
  
  
  
  if ("D" %in% unique(data$Language) & "C" %in% unique(data$Language)){
    SkepticPrior <- c(prior(normal(0.5, .3), class = b),
                      prior(normal(0, xm), class=b, coef = "LanguageD:moSymptom"),
                      prior(normal(0, xm), class=b, coef = "LanguageC:moSymptom"),
                      prior(normal(0, .1), class = sd),
                      prior(normal(0.3, 0.1), class = sigma))
  }
  

  
  stanvars <-
    stanvar(xm, name = 'xm')
  

  
  
  SkepticModelLanguage <-
    brmsFunSym(
      Name = paste0(Name, "_SkepticModel", level),
      formula = SymptomVoice_Language_f,
      data = data,
      prior = SkepticPrior,
      stanvars = stanvars
    )
  
  print("Priors, summary and plots of the skeptic model")
  print(prior_summary(SkepticModelLanguage))
  print(summary(SkepticModelLanguage))
  
  PlotBySymtpom(SkepticModelLanguage, "Skeptic_model")
  
  
  

  
  ## First we report the effect of diagnosis
  xDK <- hypothesis(SkepticModelLanguage, "LanguageD:moSymptom > 0", class = "bsp")
  xCH <- hypothesis(SkepticModelLanguage, "LanguageC:moSymptom > 0", class = "bsp")
  
  
  if (xDK$hypothesis$Estimate < 0) {
    xDK <- hypothesis(SkepticModelLanguage, "LanguageD:moSymptom < 0", class = "bsp")
  }
  
  if (xCH$hypothesis$Estimate < 0) {
    xCH <- hypothesis(SkepticModelLanguage, "LanguageC:moSymptom < 0", class = "bsp")
  }
  
  
  ER01DK = hypothesis(SkepticModelLanguage, "LanguageD:moSymptom = 0", class =
                        "bsp")$hypothesis$Evid.Ratio
  ER01CH = hypothesis(SkepticModelLanguage, "LanguageC:moSymptom = 0", class =
                        "bsp")$hypothesis$Evid.Ratio
  
  
  SkepticDK_string <- ResultsByString(xDK, ER01DK, rng = rng)
  SkepticCH_string <- ResultsByString(xCH, ER01CH, rng = rng)
  
  
  
  
  
  HypTable <- data.frame(
    Labels = c("", 
               Name, 
               "Skeptical DK", 
               "Skeptical CH"

    ),
    Diagnosis = c (
      "Group (SCZ - CT)",
      "",
      SkepticDK_string,
      SkepticCH_string
    )
   
  )
  
  
  if (Informed) {
    
    
    
    MA <- MA_Bayesreport(MA_model)
    MA_string <-
      paste0(MA$Mean, " (", MA$CI_l, " ", MA$CI_u, ")")
    
    xm <- MA$Mean
    xs <- MA$Sd
    xm2 <- xm / rng
    xs2 <- (xs / rng) * 3
    
    InformedPrior <- c(
      prior(normal(xm2, xs2), class = b),
      prior(normal(0, 0.1), class = sd) ,
      prior(normal(0.5, .3), class = b, coef = LanguageD),
      prior(normal(0.5, .3), class = b, coef = LanguageC),
      prior(normal(0, .3), class = sigma)
    )
    
    stanvars <-
      stanvar(xm2, name = 'xm2') + stanvar(xs2, name = 'xs2')
    
    InformedModelLanguage <-
      brmsFunSym(
        Name = paste0(Name, "_InformedModel_", level),
        formula = SymptomVoice_Language_f,
        data = data,
        prior = InformedPrior,
        stanvars = stanvars
      )
    
    
    
    
    print("Priors, summary and plots of the informed model")
    print(prior_summary(InformedModelLanguage))
    print(summary(InformedModelLanguage))
    
    PlotBySymtpom(InformedModelLanguage, "Informed_model")
    
    
    # Model comparison
    
    
    print("Model comparison with the skeptic model")
    print(loo_compare(SkepticModelLanguage, InformedModelLanguage))
    print(loo_model_weights(SkepticModelLanguage, InformedModelLanguage))
    
    
    
    ## First we report the effect of diagnosis
    
    xDK <- hypothesis(InformedModelLanguage, "LanguageD:moSymptom > 0", class = "bsp")
    xCH <- hypothesis(InformedModelLanguage, "LanguageC:moSymptom > 0", class = "bsp")
    
    if (xDK$hypothesis$Estimate < 0) {
      xDK <- hypothesis(InformedModelLanguage, "LanguageD:moSymptom < 0", class = "bsp")
    }
    if (xCH$hypothesis$Estimate < 0) {
      xCH <- hypothesis(InformedModelLanguage, "LanguageC:moSymptom < 0", class = "bsp")
    }
    
    ER01DK = hypothesis(InformedModelLanguage, "LanguageD:moSymptom = 0", class =
                          "bsp")$hypothesis$Evid.Ratio
    ER01CH = hypothesis(InformedModelLanguage, "LanguageC:moSymptom = 0", class =
                          "bsp")$hypothesis$Evid.Ratio
    
    InformedDK_string <- ResultsByString(xDK, ER01DK, rng = rng)
    InformedCH_string <- ResultsByString(xCH, ER01CH, rng = rng)
    

    
    
    HypTable <- data.frame(
      Labels = c(
        "",
        Name,
        "MA Priors",
        "Skeptical DK",
        "Skeptical CH",
        "Informed DK",
        "Informed CH"
      ),
      Diagnosis = c (
        "Group (SCZ - CT)",
        "",
        MA_string,
        SkepticDK_string,
        SkepticCH_string,
        InformedDK_string,
        InformedCH_string
      )

    )
    
    # Plots
    # print("Fixed effects informed rng")
    
    InformedPlotDK <-
      plot(hypothesis(InformedModelLanguage, "LanguageD:moSymptom > 0", class =
                        "bsp"))[[1]] +
      xlim(-1, 1) + ylim(0, 7) +
      theme_classic() +
      geom_vline(xintercept = 0,
                 linetype = "dotted",
                 color = "blue") +
      ggtitle(Name) +
      theme(plot.title = element_text(hjust = 0.5))
    
    ggsave(
      plot = InformedPlotDK,
      file = here("plots", paste0(
        Name, "_InformedPlot_DK_", level, ".svg"
      )),
      units = "cm",
      height = 7,
      width = 12
    )
    
    InformedPlotCH <-
      plot(hypothesis(InformedModelLanguage, "LanguageC:moSymptom > 0", class =
                        "bsp"))[[1]] +
      xlim(-1, 1) + ylim(0, 7) +
      theme_classic() +
      geom_vline(xintercept = 0,
                 linetype = "dotted",
                 color = "blue") +
      ggtitle(Name) +
      theme(plot.title = element_text(hjust = 0.5))
    
    ggsave(
      plot = InformedPlotCH,
      file = here("plots", paste0(
        Name, "_InformedPlot_CH_", level, ".svg"
      )),
      units = "cm",
      height = 7,
      width = 12
    )
    
    post <- posterior_samples(SkepticModelLanguage) %>%
      select(
        SkepticPrior = "prior_bsp_LanguageD:moSymptom",
        SkepticDK = "bsp_LanguageD:moSymptom",
        SkepticCH = "bsp_LanguageC:moSymptom"
      )
    
    post1 <-
      posterior_samples(InformedModelLanguage) %>%
      select(
        InformedPrior = "prior_bsp",
        InformedDK = "bsp_LanguageD:moSymptom",
        InformedCH = "bsp_LanguageC:moSymptom"
      )
    
    post2 <- cbind(post, post1) %>%
      gather(parameter,
             value,
             SkepticPrior:InformedCH,
             factor_key = TRUE)
    
    PriorPlot <- post2 %>%
      subset(parameter %in% c("InformedPrior", "SkepticPrior")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-0.2,0.2) +
      ylim(0, 80) +
      theme_classic()
    
    
    DanishPlot <- post2 %>%
      subset(parameter %in% c("InformedDK", "SkepticDK")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-0.05,0.05) +
      ylim(0, 700) +
      theme_classic()
    
    ChinesePlot <- post2 %>%
      subset(parameter %in% c("InformedCH", "SkepticCH")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-0.1,0.1) +
      ylim(0, 200) +
      theme_classic()
    
    x <- PriorPlot / DanishPlot / ChinesePlot
    print(x)
    
    CompPlot <- ggplot(post2, aes(value, parameter)) +
      geom_density_ridges() +
      geom_vline(xintercept = 0, linetype = "dashed") +
      theme_classic()
    print(CompPlot)
    
    
  }
  
  print("Estimates in a table")
  return(HypTable)
}


ModelsByFES <- function(Name = "TotalPitchMedian",
                               data = d_trial_SZ, 
                               Variable = d_trial$PitchMedianS,
                               SkepticPrior = SkepticPrior, 
                               MA_model = Pitch_mean_Prior,
                               Informed = FALSE, 
                               level = "Trial"){
  
  


  # Extracting Outcome variable
  data$Outcome <- Variable
  
  data <- data %>% 
    mutate(Outcome = Variable) %>%
    subset(!is.na(Outcome))
  
  data$Outcome[data$Language=="D"] <- scale(data$Outcome[data$Language=="D"])
  data$Outcome[data$Language=="C"] <- scale(data$Outcome[data$Language=="C"])
  data$Outcome[data$Language=="G"] <- scale(data$Outcome[data$Language=="G"])
  
  
  
  SkepticPrior <- c(
    prior(normal(0, .5), class=b),
    prior(normal(0, .7), class=sd),
    prior(normal(0.3, 0.1), class = sigma)
  )
  
  
  # Fitting Models
  SkepticModelLanguage <- brmsFunMed(
    Name = paste0(Name, "_SkepticModel_FES_", level),
    formula = FESVoice_Language_f,
    data = data, iter = 10000)
  
  
  
  print("Priors, summary and plots of the skeptic model")
  print(prior_summary(SkepticModelLanguage))
  print(summary(SkepticModelLanguage))


  
  ## First we report the effect of diagnosis
  
  x1DK <- hypothesis(SkepticModelLanguage,"LanguageD:FES1 > 0")
  x1CH <- hypothesis(SkepticModelLanguage,"LanguageC:FES1 > 0")
  x1GE <- hypothesis(SkepticModelLanguage,"LanguageG:FES1 > 0")
  
  
  if (x1DK$hypothesis$Estimate < 0){
    x1DK <- hypothesis(SkepticModelLanguage,"LanguageD:FES1 < 0")
  }
  if (x1CH$hypothesis$Estimate < 0){
    x1CH <- hypothesis(SkepticModelLanguage,"LanguageC:FES1 < 0")
  }
  if (x1GE$hypothesis$Estimate < 0){
    x1GE <- hypothesis(SkepticModelLanguage,"LanguageG:FES1 < 0")
  }
  
  
  ER01DK = hypothesis(SkepticModelLanguage,"LanguageD:FES1 = 0")$hypothesis$Evid.Ratio
  ER01CH = hypothesis(SkepticModelLanguage,"LanguageC:FES1 = 0")$hypothesis$Evid.Ratio
  ER01GE = hypothesis(SkepticModelLanguage,"LanguageG:FES1 = 0")$hypothesis$Evid.Ratio
  
  x2DK <- hypothesis(SkepticModelLanguage,"LanguageD:FES2 > 0")
  x2CH <- hypothesis(SkepticModelLanguage,"LanguageC:FES2 > 0")
  x2GE <- hypothesis(SkepticModelLanguage,"LanguageG:FES2 > 0")
  
  
  if (x2DK$hypothesis$Estimate < 0){
    x2DK <- hypothesis(SkepticModelLanguage,"LanguageD:FES2 < 0")
  }
  if (x2CH$hypothesis$Estimate < 0){
    x2CH <- hypothesis(SkepticModelLanguage,"LanguageC:FES2 < 0")
  }
  if (x2GE$hypothesis$Estimate < 0){
    x2GE <- hypothesis(SkepticModelLanguage,"LanguageG:FES2 < 0")
  }
  
  ER02DK = hypothesis(SkepticModelLanguage,"LanguageD:FES2 = 0")$hypothesis$Evid.Ratio
  ER02CH = hypothesis(SkepticModelLanguage,"LanguageC:FES2 = 0")$hypothesis$Evid.Ratio
  ER02GE = hypothesis(SkepticModelLanguage,"LanguageG:FES2 = 0")$hypothesis$Evid.Ratio
  
  
  SkepticDK1_string <- ResultsByString(x1DK, ER01DK)
  SkepticCH1_string <- ResultsByString(x1CH, ER01CH)
  SkepticGE1_string <- ResultsByString(x1GE, ER01GE)
  
  SkepticDK2_string <- ResultsByString(x2DK, ER02DK)
  SkepticCH2_string <- ResultsByString(x2CH, ER02CH)
  SkepticGE2_string <- ResultsByString(x2GE, ER02GE)
  
  
  
  
  # High > Low
  
  x1 <- hypothesis(SkepticModelLanguage,"LanguageD:FES2 > LanguageD:FES1")
  if (x1$hypothesis$Estimate < 0){
    x1 <- hypothesis(SkepticModelLanguage,"LanguageD:FES2 < LanguageD:FES1")
  }
  CO01 = hypothesis(SkepticModelLanguage,"LanguageD:FES2 = LanguageD:FES1")$hypothesis$Evid.Ratio
  
  
  x2 <- hypothesis(SkepticModelLanguage,"LanguageC:FES2 > LanguageC:FES1")
  if (x2$hypothesis$Estimate < 0){
    x2 <- hypothesis(SkepticModelLanguage,"LanguageC:FES2 < LanguageC:FES1")
  }
  CO02 = hypothesis(SkepticModelLanguage,"LanguageC:FES2 = LanguageC:FES1")$hypothesis$Evid.Ratio
  
  
  x3 <- hypothesis(SkepticModelLanguage,"LanguageG:FES2 > LanguageG:FES1")
  if (x3$hypothesis$Estimate < 0){
    x3 <- hypothesis(SkepticModelLanguage,"LanguageG:FES2 < LanguageG:FES1")
  }
  CO03 = hypothesis(SkepticModelLanguage,"LanguageG:FES2 = LanguageG:FES1")$hypothesis$Evid.Ratio
  
  
  # # Report contrasts
  
  # # High > Low 
  SkepticHighLow_DK_Contrast_String <- ResultsByString(x1, CO01)
  SkepticHighLow_CH_Contrast_String <- ResultsByString(x2, CO02)
  SkepticHighLow_GE_Contrast_String <- ResultsByString(x3, CO03)
  
  
  
  ## Now onto making a table with the results  
  HypTable <- data.frame(
    Labels = c("", 
               Name, 
               "Skeptical DK FES", 
               "Skeptical CH FES", 
               "Skeptical GE FES", 
               "Skeptical DK CHRONIC", 
               "Skeptical CH CHRONIC ", 
               "Skeptical GE CHRONIC ", 
               "Skeptical DK CHRONIC - FES", 
               "Skeptical CH CHRONIC - FES ", 
               "Skeptical GE CHRONIC - FES "), 
    Diagnosis = c ("Group (SCZ - CT)", 
                   "", 
                   SkepticDK1_string,  
                   SkepticCH1_string, 
                   SkepticGE1_string, 
                   SkepticDK2_string,  
                   SkepticCH2_string, 
                   SkepticGE2_string, 
                   SkepticHighLow_DK_Contrast_String, 
                   SkepticHighLow_CH_Contrast_String, 
                   SkepticHighLow_GE_Contrast_String   
    )

  ) 
  
  
  if (Informed) {
    MA <- MA_Med_report(MA_model)
    MA_string1 <- paste0(MA$Mean_HIGHvsHC, " (","+", MA$Sd_HIGHvsHC, " -", MA$Sd_HIGHvsHC, ")")
    MA_string2 <- paste0(MA$Mean_LOWvsHC, " (","+", MA$Sd_LOWvsHC, " -", MA$Sd_LOWvsHC, ")")
    MA_string3 <- paste0(MA$Mean_HIGHvsLOW, " (","+", MA$Sd_HIGHvsLOW, " -", MA$Sd_HIGHvsLOW, ")")
    
    
    round(MA_model$Mean_LOWvsHC, 2)
    
    xm1 <- as.numeric(MA_model$Mean_LOWvsHC)
    xs1 <- as.numeric(MA_model$Sd_LOWvsHC)
    
    xm2 <- as.numeric(MA_model$Mean_HIGHvsHC)
    xs2 <- as.numeric(MA_model$Sd_HIGHvsHC)
    
    
    InformedPrior <- c(
      prior(normal(xm1, xs1), class=b, coef = LanguageD:D2Rlow),
      prior(normal(xm1, xs1), class=b, coef = LanguageC:D2Rlow),
      prior(normal(xm1, xs1), class=b, coef = LanguageG:D2Rlow),
      prior(normal(xm2, xs2), class=b, coef = LanguageD:D2Rhigh),
      prior(normal(xm2, xs2), class=b, coef = LanguageC:D2Rhigh),
      prior(normal(xm2, xs2), class=b, coef = LanguageG:D2Rhigh),
      prior(normal(0, .7), class = sd) ,
      prior(normal(0, .5), class = b, coef = LanguageD),
      prior(normal(0, .5), class = b, coef = LanguageC),
      prior(normal(0, .5), class = b, coef = LanguageG),
      prior(normal(0.3, 0.1), class = sigma)
    )
    
    stanvars <- stanvar(xm1, name = 'xm1') + stanvar(xs1, name = 'xs1') + stanvar(xm2, name = 'xm2') + stanvar(xs2, name = 'xs2')
    
    InformedModelLanguage <-
      brmsFunMed(
        Name = paste0(Name, "_InformedModel_", level),
        formula = MedicationVoice_Language_f,
        data = data,
        prior = InformedPrior,
        stanvars = stanvars
      )
    
    print("Priors, summary and plots of the informed model")
    print(summary(InformedModelLanguage))
    print(prior_summary(InformedModelLanguage))
    PlotByMedication(InformedModelLanguage, "InformedModel")
    
    print("Model comparison with the skeptic model")
    print(loo_compare(SkepticModelLanguage, InformedModelLanguage))
    print(loo_model_weights(SkepticModelLanguage, InformedModelLanguage))
    
    
    
    ## First we report the effect of diagnosis
    x1DK <- hypothesis(InformedModelLanguage,"LanguageD:D2Rlow > 0")
    x1CH <- hypothesis(InformedModelLanguage,"LanguageC:D2Rlow > 0")
    x1CH <- hypothesis(InformedModelLanguage,"LanguageG:D2Rlow > 0")

    if (x1DK$hypothesis$Estimate < 0){
      x1DK <- hypothesis(InformedModelLanguage,"LanguageD:D2Rlow < 0")
    }
    if (x1CH$hypothesis$Estimate < 0){
      x1CH <- hypothesis(InformedModelLanguage,"LanguageC:D2Rlow < 0")
    }
    if (x1GE$hypothesis$Estimate < 0){
      x1GE <- hypothesis(InformedModelLanguage,"LanguageG:D2Rlow < 0")
    }

    
    ER01DK = hypothesis(InformedModelLanguage,"LanguageD:D2Rlow = 0")$hypothesis$Evid.Ratio
    ER01CH = hypothesis(InformedModelLanguage,"LanguageC:D2Rlow = 0")$hypothesis$Evid.Ratio
    ER01GE = hypothesis(InformedModelLanguage,"LanguageG:D2Rlow = 0")$hypothesis$Evid.Ratio

    x2DK <- hypothesis(InformedModelLanguage,"LanguageD:D2Rhigh > 0")
    x2CH <- hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh > 0")
    x2GE <- hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh > 0")

    if (x2DK$hypothesis$Estimate < 0){
      x2DK <- hypothesis(InformedModelLanguage,"LanguageD:D2Rhigh < 0")
    }
    if (x2CH$hypothesis$Estimate < 0){
      x2CH <- hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh < 0")
    }
    if (x2GE$hypothesis$Estimate < 0){
      x2GE <- hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh < 0")
    }

    
    ER02DK = hypothesis(InformedModelLanguage,"LanguageD:D2Rhigh = 0")$hypothesis$Evid.Ratio
    ER02CH = hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh = 0")$hypothesis$Evid.Ratio
    ER02GE = hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh = 0")$hypothesis$Evid.Ratio
    
    
    InformedDK1_string <- ResultsByString(x1DK, ER01DK)
    InformedCH1_string <- ResultsByString(x1CH, ER01CH)
    InformedGE1_string <- ResultsByString(x1GE, ER01GE)
    
    InformedDK2_string <- ResultsByString(x2DK, ER02DK)
    InformedCH2_string <- ResultsByString(x2CH, ER02CH)
    InformedGE2_string <- ResultsByString(x2GE, ER02GE)
    
    
    # High > Low
    x1 <- hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh > LanguageD:D2Rlow")
    if (x1$hypothesis$Estimate < 0){
      x1 <- hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh < LanguageD:D2Rlow")
    }
    CO01 = hypothesis(SkepticModelLanguage,"LanguageD:D2Rhigh = LanguageD:D2Rlow")$hypothesis$Evid.Ratio
    
    
    x2 <- hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh > LanguageC:D2Rlow")
    if (x2$hypothesis$Estimate < 0){
      x2 <- hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh < LanguageC:D2Rlow")
    }
    CO02 = hypothesis(InformedModelLanguage,"LanguageC:D2Rhigh = LanguageC:D2Rlow")$hypothesis$Evid.Ratio
    
    
    x3 <- hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh > LanguageG:D2Rlow")
    if (x3$hypothesis$Estimate < 0){
      x3 <- hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh < LanguageG:D2Rlow")
    }
    CO03 = hypothesis(InformedModelLanguage,"LanguageG:D2Rhigh = LanguageG:D2Rlow")$hypothesis$Evid.Ratio
    
    
    InformedHighLow_DK_Contrast_String <- ResultsByString(x1, CO01)
    InformedHighLow_CH_Contrast_String <- ResultsByString(x2, CO02)
    InformedHighLow_GE_Contrast_String <- ResultsByString(x3, CO03) 
    
    
    
    HypTable <- data.frame(
      Labels = c(
        "",
        Name,
        "MA_Priors_High vs HC",
        "MA_Priors_Low vs HC",
        "MA_Priors_High vs Low",
        "Skeptical DK Low",
        "Skeptical CH Low",
        "Skeptical GE Low",
        "Skeptical DK High",
        "Skeptical CH High",
        "Skeptical GE High",
        "Skeptical DK High-Low", 
        "Skeptical CH High-Low", 
        "Skeptical GE High-Low",       
        "Informed DK Low",
        "Informed CH Low",
        "Informed GE Low",
        "Informed DK High",
        "Informed CH High",
        "Informed GE High",
        "Informedal DK High-Low", 
        "Informedal CH High-Low", 
        "Informedal GE High-Low" 
      ),
      #
      Diagnosis = c (
        "Group (SCZ - CT)",
        "",
        MA_string1,
        MA_string2,
        MA_string3, 
        SkepticDK1_string,
        SkepticCH1_string,
        SkepticGE1_string,
        SkepticDK2_string,
        SkepticCH2_string,
        SkepticGE2_string,
        SkepticHighLow_DK_Contrast_String, 
        SkepticHighLow_CH_Contrast_String, 
        SkepticHighLow_GE_Contrast_String,   
        InformedDK1_string,
        InformedCH1_string,
        InformedGE1_string,
        InformedDK2_string,
        InformedCH2_string,
        InformedGE2_string,
        InformedHighLow_DK_Contrast_String, 
        InformedHighLow_CH_Contrast_String, 
        InformedHighLow_GE_Contrast_String
      )
    )
    
   
    
    
    post <- posterior_samples(SkepticModelLanguage) %>%
      select(
        SkepticPrior = prior_b,
        SkepticDK1 = "b_LanguageD:D2Rlow",
        SkepticCH1 = "b_LanguageC:D2Rlow",
        SkepticGE1 = "b_LanguageG:D2Rlow",
        SkepticDK2 = "b_LanguageD:D2Rhigh",
        SkepticCH2 = "b_LanguageC:D2Rhigh",
        SkepticGE2 = "b_LanguageG:D2Rhigh"
      )
    
    post1 <- posterior_samples(InformedModelLanguage) %>%
      select(
        InformedPrior1 = "prior_b_LanguageD:D2Rlow",
        InformedPrior2 = "prior_b_LanguageD:D2Rhigh",
        InformedPrior3 = "prior_b_LanguageD:D2Rhigh",
        InformedDK1 = "b_LanguageD:D2Rlow",
        InformedCH1 = "b_LanguageC:D2Rlow",
        InformedGE1 = "b_LanguageG:D2Rlow",
        InformedDK2 = "b_LanguageD:D2Rhigh",
        InformedCH2 = "b_LanguageC:D2Rhigh",
        InformedGE2 = "b_LanguageG:D2Rhigh",
      )
    
    post2 <- cbind(post, post1) %>%
      gather(parameter, value, SkepticPrior:InformedGE2, factor_key = TRUE)
    
    
    PriorPlot <- post2 %>%
      subset(parameter %in% c("InformedPrior1", "InformedPrior2", "InformedPrior3","SkepticPrior")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    DanishPlot <- post2 %>%
      subset(parameter %in% c("InformedDK1", "SkepticDK1", "InformedDK2", "SkepticDK2")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    ChinesePlot <- post2 %>%
      subset(parameter %in% c("InformedCH1", "SkepticCH1", "InformedCH2", "SkepticCH2")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    GermanPlot <- post2 %>%
      subset(parameter %in% c("InformedGE1", "SkepticGE1", "InformedGE2", "SkepticGE2")) %>%
      ggplot(aes(value, fill=parameter)) +
      geom_density(alpha=0.3) +
      geom_vline(xintercept = 0, linetype = "dashed") +
      xlim(-2,2) +
      ylim(0, 5) +
      theme_classic()
    
    #library(patchwork)
    x <- PriorPlot / DanishPlot / ChinesePlot/GermanPlot 
    print(x)
    
    
    
    
    CompPlot <- ggplot(post2, aes(value, parameter)) +
      geom_density_ridges() +
      geom_vline(xintercept = 0, linetype = "dashed") +
      theme_classic()
    print(CompPlot)
    
  }
  
  print("Estimates in a table")
  formattable(HypTable)
  return(HypTable)
  
  
}





get_pareto_k <- function(l) {
  l$diagnostics$pareto_k %>% 
    as_tibble() %>%
    mutate(i = 1:n()) %>% 
    rename(pareto_k = value)
}






```



# Meta-analyses function

```{r}


DataPreprocessES <-
  function(d,
           Name = "mean pitch",
           FeatureSz,
           FeatureCtrl,
           FeatureSDSz,
           FeatureSDCtrl) {
    
    #d <- d_meta
    
    #d$FeatureSz <- d[, "SP_PER_SZ_M"]
    #d$FeatureCtrl <- d[, "SP_PER_HC_M"]
    #d$FeatureSDSz <- d[, "SP_PER_SZ_SD"]
    #d$FeatureSDCtrl <- d[, "SP_PER_HC_SD"]
    #d$GenderMaleASD <- as.numeric(d$MALE_SZ)
    #d$GenderMaleTD <- as.numeric(d$MALE_HC)
    
    # Create ad hoc variables for the relevant acoustic features
    
    d$FeatureSz <- d[, FeatureSz]
    d$FeatureCtrl <- d[, FeatureCtrl]
    d$FeatureSDSz <- d[, FeatureSDSz]
    d$FeatureSDCtrl <- d[, FeatureSDCtrl]
    d$GenderMaleASD <- as.numeric(d$MALE_SZ)
    d$GenderMaleTD <- as.numeric(d$MALE_HC)
    
    # Drop irrelevant variables and rename
    
    d = select(
      d,
      ID = ArticleID,
      Year = Year_publication,
      ASD_N = SAMPLE_SIZE_SZ,
      TD_N = SAMPLE_SIZE_HC,
      ASDAgeM = AGE_M_SZ,
      ASDAgeSD = AGE_SD_SZ,
      TDAgeM = AGE_M_HC,
      TDAgeSD = AGE_SD_HC,
      GenderMaleASD,
      GenderMaleTD,
      FeatureSz,
      FeatureCtrl,
      FeatureSDSz,
      FeatureSDCtrl,
      Population = StudyID,
      DiagnosisDetails = DIAGNOSIS,
      Task = TYPE_OF_TASK,
      Authors = Article
    )
    
    # Calculate standardized effect sizes
    
    d = escalc(
      'SMD',
      n1i = d$ASD_N,
      n2i = d$TD_N,
      m1i = d$FeatureSz,
      m2i = d$FeatureCtrl,
      sd1i = d$FeatureSDSz,
      sd2i = d$FeatureSDCtrl,
      data = d
    )
    
    d$StandardError = summary(d)$sei
    d = d %>% dplyr::rename(EffectSize = yi, Variance = vi)
    
    return(d)
  }


MetaAnalysisES <-
  function(d,
           Name = "mean pitch",
           FeatureSz,
           FeatureCtrl,
           FeatureSDSz,
           FeatureSDCtrl) {
    d <-
      DataPreprocessES(d, Name, FeatureSz, FeatureCtrl, FeatureSDSz, FeatureSDCtrl)
    d <- d %>% subset(!is.na(EffectSize))
    
    # create new column ("new_auhtors") in the matrix to order the studies by task (to use later for creating the Bayesian forest plot)
    
    new.column = as.vector(ave(d$Task, d$Task, FUN = seq_along))
    d = cbind(as.data.frame(d), new.column)
    d$new2 <- with(d, paste0(Task, "_", new.column))
    d$Task <- factor(d$Task)
    d <- d[with(d, order(d$Task, d$new2)),]
    d$IDOS <- seq.int(nrow(d))
    d$IDOS <- sprintf("%02d", d$IDOS)
    d$new_authors <- with(d, paste0(d$IDOS, "_", Authors))
    
    
    # and now data modelling
    
    if (nrow(d) > 1) {
      # Random Effects Model
      # N.B. tau squared in rma.mv is called sigma squared.
      MetaforM <-
        rma.mv(
          EffectSize,
          Variance,
          random = ~ 1 | new_authors,
          method = "ML",
          data = d,
          slab = ID
        )
      
      
      assign(paste0(Name, "_Prior"), MetaforM, envir = .GlobalEnv)
      
      
      formula<-bf(EffectSize | se(StandardError) ~ 1 + (1|new_authors))
      data = d

      
      #formula = formula_m
      # Name= Name
      # prior= prior
      # priorSpec=prior
      
      
      m <- brm(formula, 
               data = data, iter = 8000, chains=2, cores = 2,
               save_mevars = T,
               control= list(adapt_delta = 0.999,max_treedepth=20))
      
      assign(paste0(Name,"_BayesianPrior"), m, envir=.GlobalEnv)
      
    }
  }





MA_report <- function(model){
  ma <- data.frame(
    Mean = round(model$b, 2),
    Sd = round(model$se, 2),
    CI_l = round(model$ci.lb, 2),
    CI_u = round(model$ci.ub, 2))
  return(ma)
}


MA_Bayesreport <- function(model){
  ma <- data.frame(
    Mean = round(fixef(model)[1], 3),
    Sd = round(fixef(model)[2], 3),
    CI_l = round(fixef(model)[3], 3),
    CI_u = round(fixef(model)[4], 3))
  return(ma)
}


MA_Med_report <- function(model){
  #model =  MA_model
  ma <- data.frame(
    Mean_HIGHvsHC = as.character(round(model$Mean_HIGHvsHC, 2)),
    Sd_HIGHvsHC = as.character(round(model$Sd_HIGHvsHC, 2)),
    Mean_LOWvsHC = as.character(round(model$Mean_LOWvsHC, 2)),
    Sd_LOWvsHC = as.character(round(model$Sd_LOWvsHC, 2)),
    Mean_HIGHvsLOW = as.character(round(model$Mean_HIGHvsLOW, 2)),
    Sd_HIGHvsLOW = as.character(round(model$Sd_HIGHvsLOW, 2)))
  return(ma)
}


# EffSize <- round(fixef(m)[1], 3)
# EffCI1 <- round(fixef(m)[3], 3)
# EffCI2 <- round(fixef(m)[4], 3)


DataPreprocessMed <-
  function(d) {
    
   
    # Create ad hoc variables for the relevant acoustic features
    
    #d$FeatureHIGH_D2R <- d[, FeatureSz]
    #d$FeatureLOW_D2R <- d[, FeatureSz]
    #d$FeatureHC <- d[, FeatureCtrl]
    
    #d$FeatureSDSz <- d[, FeatureSDSz]
    #d$FeatureSDCtrl <- d[, FeatureSDCtrl]
    
    # Drop irrelevant variables and rename
    
    # Calculate standardized effect sizes
    
    d = escalc(
      'SMD',
      n1i = d$N_High,
      n2i = d$N_HC,
      m1i = d$HIGH_D2R_Mean,
      m2i = d$HC_Mean,
      sd1i = d$HIGH_D2R_Sd,
      sd2i = d$HC_Sd,
      data = d
    )
    
    d$StandardError = summary(d)$sei
    d = d %>% dplyr::rename(EffectSize_HIGHvsHC = yi, Variance__HIGHvsHC = vi, StandardError_HIGHvsHC =  StandardError)
    
    
    d = escalc(
      'SMD',
      n1i = d$N_Low,
      n2i = d$N_HC,
      m1i = d$LOW_D2R_Mean,
      m2i = d$HC_Mean,
      sd1i = d$LOW_D2R_Sd,
      sd2i = d$HC_Sd,
      data = d
    )
    
    d$StandardError = summary(d)$sei
    d = d %>% dplyr::rename(EffectSize_LOWvsHC = yi, Variance__LOWvsHC = vi, StandardError_LOWvsHC =  StandardError)
    
    
    d = escalc(
      'SMD',
      n1i = d$N_High,
      n2i = d$N_Low,
      m1i = d$HIGH_D2R_Mean,
      m2i = d$LOW_D2R_Mean,
      sd1i = d$HIGH_D2R_Sd,
      sd2i = d$LOW_D2R_Sd,
      data = d
    )
    
    d$StandardError = summary(d)$sei
    d = d %>% dplyr::rename(EffectSize_HIGHvsLOW = yi, Variance__HIGHvsLOW = vi, StandardError_HIGHvsLOW =  StandardError)
    
    
    return(d)
  }


MetaAnalysisMed <-
  function(d,
           Name = "mean pitch",
           NameContrast1 = "HC_vs_HIGH_D2R",
           NameContrast2 = "HC_vs_HIGH_D2R",
           NameContrast3 = "HC_vs_HIGH_D2R",
           FeatureHIGH_D2R= "HIGH_D2R_Mean",
           FeatureLOW_D2R= "LOW_D2R_Mean",
           FeatureHC= "LOW_D2R_Mean",
           FeatureSDHIGH_D2= "HIGH_D2R_Sd",
           FeatureSDLOW_D2= "LOW_D2R_Sd",
           FeatureSDHC="LOW_D2R_Sd") {
    
    d <-DataPreprocessMed(d)
    

    
    
    ma <- data.frame(
      Mean_HIGHvsHC = round(d$EffectSize_HIGHvsHC, 2),
      Sd_HIGHvsHC = round(d$StandardError_HIGHvsHC, 2),
      Mean_LOWvsHC = round(d$EffectSize_LOWvsHC, 2),
      Sd_LOWvsHC = round(d$StandardError_LOWvsHC, 2),
      Mean_HIGHvsLOW = round(d$EffectSize_HIGHvsLOW, 2),
      Sd_HIGHvsLOW = round(d$StandardError_HIGHvsLOW, 2))
  
    #return(ma)
    
    assign(paste0("MA_", Name), ma, envir = .GlobalEnv)
    
  }
    
  

MetaAnalysisCorrelation <- function(d,Name="alogia and pitch variability",FeatureCorrelation){
  
  # Create ad hoc variable for the relevant acoustic features
  
  
  # d = d_metaCor
  # Name="negative symptoms and mean pitch"
  # FeatureCorrelation="NEG_F0_MEAN"
  
  
  d$FeatureCorrelation <- d[,FeatureCorrelation]
  
  
  # Drop irrelevant variables and rename
  
  d = select(
    d,
    ID = ArticleID,
    Year = Year_publication,
    SAMPLE_SIZE_SZ,
    FEMALE_SZ,
    Population=StudyID,
    DiagnosisDetails=DIAGNOSIS,
    Task=TYPE_OF_TASK,
    Authors=Article,
    FeatureCorrelation
  )
  
  #Let's calculate standardized effect sizes, variance and standard errors
  
  
  d = escalc('COR', ri = as.numeric(FeatureCorrelation), ni = as.numeric(SAMPLE_SIZE_SZ), data = d)
  d$StandardError=summary(d)$sei
  d = d %>% dplyr::rename(EffectSize=yi,Variance=vi)
  
  d <- d %>%  subset(!is.na(EffectSize))
  
  
  # create new column ("new_auhtors") in the matrix to order study by task (to use later in the Bayesian forest plot)
  
  new.column = as.vector(ave(d$Task, d$Task, FUN=seq_along))
  d=cbind(as.data.frame(d), new.column)
  d$new2 <- with(d, paste0(Task,"_", new.column))
  d$Task <- factor(d$Task)
  d <- d[
    with(d, order(d$Task, d$new2)),
    ]
  d$IDOS <- seq.int(nrow(d))
  d$IDOS <- sprintf("%02d", d$IDOS)
  d$new_authors <- with(d, paste0(d$IDOS,"_", Authors))
  
  
  # and now data modelling
  
  if (nrow(d)==0){
    MetaPrior=data.frame(Name,Mean=NA,SE=NA,SD=NA)
    print("Not enough data points") 
  } else if (nrow(d)==1){
    
    MetaPrior=data.frame(
      Name,
      Mean=d$EffectSize,
      SE=d$StandardError,
      SD=sqrt(d$Variance))
  } else if (nrow(d)>1){
    
    # Random Effects Model
    
    MetaforM <-  rma.mv(EffectSize, Variance, random = ~ 1 | ID, method = "ML", data = d, slab=Authors)
    # N.B. tau squared in rma.mv is called sigma squared.
    #resCI <- predict(MetaforM, digits=3)
    #resCI2 <- confint(MetaforM)
    assign(paste0(Name,"_Prior"), MetaforM, envir=.GlobalEnv)

  }
  
  
  # Bayesian reproduction of the Random Effects Models
  
  

  
  
  # prior = c(
  #   prior(normal(0,0.3),class=Intercept),
  #   prior(normal(0,0.3),class=sd)
  # )
  
  formula<-bf(EffectSize | se(StandardError) ~ 1 + (1|new_authors))
  data = d
  
  #formula = formula_m
  # Name= Name
  # prior= prior
  # priorSpec=prior
  

  m <- brm(formula, 
           data = data, iter = 8000, chains=2, cores = 2,
           save_mevars = T,
           control= list(adapt_delta = 0.999,max_treedepth=20))
   

  
  
  assign(paste0(Name,"_BayesianPrior"), m, envir=.GlobalEnv)
  
  # EffSize <- round(fixef(m)[1], 3)
  # EffCI1 <- round(fixef(m)[3], 3)
  # EffCI2 <- round(fixef(m)[4], 3)
  
  #BrmM <- brmFitAndSave(formula_m, Name, d , prior=T, priorSpec=prior)
  
  

  
  #forest_bayesian <- brmstools::forest(BrmM, grouping = "new_authors", digits=3, scale = 0.7, sort = "FALSE", show_data = T)
  #print(forest_bayesian)
  #ggsave(paste0(Name,"B.tiff",collapse=""), plot = forest_bayesian,dpi ="retina",  width =30, height = 16, units = "cm")

  
}


```

